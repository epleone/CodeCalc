# 使用文档

## 运算符优先级
运算符的优先级顺序，从低到高：
0. 赋值运算符：
=, +=, -=, *=, /=, &=, |=, ^=, <<=, >>=, >>>=
>@, >#, >#w, >#d, >#h, >#m, >#s
@+ @-

1. 位运算和加减：
| (位或)
^ (位异或)
& (位与)
@ (日期)

2. 加减：
+, - (加减)

3. 位移：
<<, >>, >>> (位移)

4. 乘除模整除：
*, /, %, // (乘 除 模 整除)

5. 正负号
unary+ (一元正号)
unary- (一元负号)

6. 前缀运算符：
~ (按位取反)

7. 幂运算：
**

8.后缀运算符：
.bin, .hex, .deg 等属性函数

## 数值表示

### 进制表示
- `0b` 或 `0B` : 二进制数值前缀，如 `0b1010` 表示十进制的 10
- `0o` 或 `0O` : 八进制数值前缀，如 `0o12` 表示十进制的 10
- `0x` 或 `0X` : 十六进制数值前缀，如 `0xA` 表示十进制的 10

## 运算符说明

### 基本算术运算符
- `+` : 加法运算，支持数字和字符串连接
- `-` : 减法运算
- `*` : 乘法运算
- `/` : 除法运算（除数不能为0）
- `//` : 整除运算
- `%` : 取模运算
- `**` : 幂运算

### 一元运算符
- `#` : 前缀自增（x → x+1）
- `-` : 一元负号
- `°` 或 `.deg` : 角度转弧度

### 位运算符
- `&` 或 `and` : 按位与
- `|` 或 `or` : 按位或
- `^` : 按位异或
- `~` 或 `not` : 按位取反
- `<<` : 左移
- `>>` : 右移
- `>>>` : 无符号右移

### 赋值运算符
- `=` : 基本赋值
- `+=` : 加法赋值
- `-=` : 减法赋值
- `*=` : 乘法赋值
- `/=` : 除法赋值
- `&=` : 按位与赋值
- `|=` : 按位或赋值
- `^=` : 按位异或赋值
- `<<=` : 左移赋值
- `>>=` : 右移赋值
- `>>>=` : 无符号右移赋值


## 内置函数

### 类型转换函数
- `str(x)` : 将值转换为字符串
- `num(x)` : 将值转换为数字

### 数学函数
- `max(...args)` : 求最大值
- `min(...args)` : 求最小值
- `lg(x)` : 以10为底的对数
- `lb(x)` : 以2为底的对数
- `ln(x)` : 自然对数
- `log(x,y)` : 以x为底的y的对数
- `exp(x)` : e的指数
- `sqrt(x)` : 平方根
- `pow(x,y)` : 幂函数
- `abs(x)` : 绝对值

### 三角函数
- `sin(x)` : 正弦函数
- `cos(x)` : 余弦函数
- `tan(x)` : 正切函数
- `asin(x)` : 反正弦函数
- `acos(x)` : 反余弦函数
- `atan(x)` : 反正切函数

### 双曲函数
- `sinh(x)` : 双曲正弦
- `cosh(x)` : 双曲余弦
- `tanh(x)` : 双曲正切

### 角度转换函数
- `deg(x)` : 度数转换为弧度
- `rad(x)` : 弧度转换为度数

### 字符串函数
- `upper(x)` : 转换为大写
- `lower(x)` : 转换为小写
- `length(x)` : 获取字符串长度

### 进制转换函数
- `bin(x)` : 十进制转二进制
- `oct(x)` : 十进制转八进制
- `hex(x)` : 十进制转十六进制

### Base64编码/解码
- `base64(x)` : Base64编码
- `unbase64(x)` : Base64解码

## 常量
- `π`, `PI`, `pi` : 圆周率 (Math.PI)
- `e`, `E` : 自然对数的底 (Math.E)


## 日期与时间间隔 

这部分分为两个部分，
- 日期，      相关符号是`@`
- 时间间隔，  相关符号是`#`

它们的运算关系如下：

- `@日期` ： 得到时间戳

- `@日期 - @日期 = #时间间隔  （单位ms）` 

- `@日期 @+ #时间间隔 = @日期`
- `@日期 @- #时间间隔 = @日期`
- `@日期 +/- #时间间隔 = 时间戳 （单位ms）` 

`时间戳`是指距离 `1970-01-01 00:00:00` 的毫秒数， 其实也是一种`时间间隔`

针对时间戳， 有特别的可视化函数：
- `> @` : 格式化显示日期，将时间戳转日期字符串
- `> #` : 格式化显示时间差，转换为天时分秒格式

``` js
@now @+ #1d 
// 等价于
@now + #1d > @ 
// 显示明天的日期 
// 输出: 2025-01-13 00:00:00

#1.5d > #
// 显示1.5天对应的时间
// 输出: 1天12小时
```

### 日期 `@`

- `@` : 将日期字符串转时间戳，支持多种日期格式

- `@YYYY-MM-DD HH:mm:ss` : 完整日期时间
- `@YYYY-MM-DD HH:mm` : 日期和时分
- `@YYYY-MM-DD` : 仅日期
- `@MM-DD HH:mm:ss` : 月日时分秒（使用当前年份）
- `@MM-DD HH:mm` : 月日时分（使用当前年份）
- `@YYYY-MM` : 年月
- `@MM-DD` : 月日（使用当前年份）
- `@YYYY` : 仅年份

- `@now` : 当前时间
- `@today` : 今天的零点时间

- `@+` : 日期加法，支持时间戳相加或日期加上年月日
- `@-` : 日期减法，支持时间戳相减或日期减去年月日

### 时间间隔 `#`
- 周：`#weeks` 或 `#w`,             用法： `#10w`,`#(10)w`, `#(max(1,2))w`
- 天：`#days` 或 `#d`,              用法： `#1d`,`#(10)d`, `#(max(1,2))d`
- 小时：`#hours` 或 `#h`,           用法： `#1h`,`#(10)h`,  `#(max(1,2))h`
- 分钟：`#minutes` 或 `#mins`,      用法： `#1mins`,`#(10)mins`,  `#(max(1,2))mins`
- 秒：`#seconds` 或 `#s`,           用法： `#1s`, `#(10)s`,  `#(max(1,2))s`
- 毫秒：`#milliseconds` 或 `#ms`,   用法： `#1ms`, `#(10)ms`,  `#(max(1,2))ms`

- `#HH:mm:ss` : 小时：分钟：秒，时间间隔,  用法： `#10:10:10`,  10小时10分钟10秒
- `#HH:mm` : 小时：分钟，时间间隔,          用法： `#10:10`,    10小时10分钟

### 时间间隔格式化输出

- `> @` : 格式化显示日期，将时间戳转日期字符串
- `> #` : 格式化显示时间差，转换为天时分秒格式
- `> #w` 或 `>#week` : 格式化显示时间差，转换为周数
- `> #d` 或 `>#day` : 格式化显示时间差，转换为天数
- `> #h` 或 `>#hour` : 格式化显示时间差，转换为小时数
- `> #m` 或 `>#minute` : 格式化显示时间差，转换为分钟数
- `> #s` 或 `>#second` : 格式化显示时间差，转换为秒数


### 年月日语法糖
支持以下形式（年和月至少要有一个）：
- `#1y2m3d` : 1年2月3天
- `#1y2m` : 1年2月
- `#2m3d` : 2月3天
- `#1y3d` : 1年3天

只能当 `@+` 或者 `@-` 的右侧参数使用， 单独使用没有意义。
用于日期的加减运算。

``` js
@now @+ #1y2m3d
// 输出: 2026-03-15 00:00:00

@now @- #1m3d
// 输出: 2025-1-01 00:00:00
```

## 注意事项
1. 某些函数可以作为属性使用（如 .hex, .bin, .upper 等）
2. 三角函数的参数默认使用弧度制
3. Base64编码/解码仅支持字符串输入
4. 时间戳精确到毫秒
5. 日期计算时注意时区影响