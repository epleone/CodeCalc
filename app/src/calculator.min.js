/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */
var e,t,n=9e15,r=1e9,i="0123456789abcdef",s="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",o="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",c={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-9e15,maxE:n,crypto:!1},a=!0,u="[DecimalError] ",f=u+"Invalid argument: ",p=u+"Precision limit exceeded",d=u+"crypto unavailable",l="[object Decimal]",h=Math.floor,g=Math.pow,m=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,w=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,v=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,y=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,x=1e7,N=s.length-1,b=o.length-1,E={toStringTag:l};function S(e){var t,n,r,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)(n=7-(r=e[t]+"").length)&&(s+=H(n)),s+=r;(n=7-(r=(o=e[t])+"").length)&&(s+=H(n))}else if(0===o)return"0";for(;o%10==0;)o/=10;return s+o}function $(e,t,n){if(e!==~~e||e<t||e>n)throw Error(f+e)}function M(e,t,n,r){var i,s,o,c;for(s=e[0];s>=10;s/=10)--t;return--t<0?(t+=7,i=0):(i=Math.ceil((t+1)/7),t%=7),s=g(10,7-t),c=e[i]%s|0,null==r?t<3?(0==t?c=c/100|0:1==t&&(c=c/10|0),o=n<4&&99999==c||n>3&&49999==c||5e4==c||0==c):o=(n<4&&c+1==s||n>3&&c+1==s/2)&&(e[i+1]/s/100|0)==g(10,t-2)-1||(c==s/2||0==c)&&!(e[i+1]/s/100|0):t<4?(0==t?c=c/1e3|0:1==t?c=c/100|0:2==t&&(c=c/10|0),o=(r||n<4)&&9999==c||!r&&n>3&&4999==c):o=((r||n<4)&&c+1==s||!r&&n>3&&c+1==s/2)&&(e[i+1]/s/1e3|0)==g(10,t-3)-1,o}function D(e,t,n){for(var r,s,o=[0],c=0,a=e.length;c<a;){for(s=o.length;s--;)o[s]*=t;for(o[0]+=i.indexOf(e.charAt(c++)),r=0;r<o.length;r++)o[r]>n-1&&(void 0===o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}E.absoluteValue=E.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),k(e)},E.ceil=function(){return k(new this.constructor(this),this.e+1,2)},E.clampedTo=E.clamp=function(e,t){var n=this,r=n.constructor;if(e=new r(e),t=new r(t),!e.s||!t.s)return new r(NaN);if(e.gt(t))throw Error(f+t);return n.cmp(e)<0?e:n.cmp(t)>0?t:new r(n)},E.comparedTo=E.cmp=function(e){var t,n,r,i,s=this,o=s.d,c=(e=new s.constructor(e)).d,a=s.s,u=e.s;if(!o||!c)return a&&u?a!==u?a:o===c?0:!o^a<0?1:-1:NaN;if(!o[0]||!c[0])return o[0]?a:c[0]?-u:0;if(a!==u)return a;if(s.e!==e.e)return s.e>e.e^a<0?1:-1;for(t=0,n=(r=o.length)<(i=c.length)?r:i;t<n;++t)if(o[t]!==c[t])return o[t]>c[t]^a<0?1:-1;return r===i?0:r>i^a<0?1:-1},E.cosine=E.cos=function(){var e,n,r=this,i=r.constructor;return r.d?r.d[0]?(e=i.precision,n=i.rounding,i.precision=e+Math.max(r.e,r.sd())+7,i.rounding=1,r=function(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?i=(1/L(4,n=Math.ceil(r/3))).toString():(n=16,i="2.3283064365386962890625e-10");e.precision+=n,t=U(e,1,t.times(i),new e(1));for(var s=n;s--;){var o=t.times(t);t=o.times(o).minus(o).times(8).plus(1)}return e.precision-=n,t}(i,W(i,r)),i.precision=e,i.rounding=n,k(2==t||3==t?r.neg():r,e,n,!0)):new i(1):new i(NaN)},E.cubeRoot=E.cbrt=function(){var e,t,n,r,i,s,o,c,u,f,p=this,d=p.constructor;if(!p.isFinite()||p.isZero())return new d(p);for(a=!1,(s=p.s*g(p.s*p,1/3))&&Math.abs(s)!=1/0?r=new d(s.toString()):(n=S(p.d),(s=((e=p.e)-n.length+1)%3)&&(n+=1==s||-2==s?"0":"00"),s=g(n,1/3),e=h((e+1)/3)-(e%3==(e<0?-1:2)),(r=new d(n=s==1/0?"5e"+e:(n=s.toExponential()).slice(0,n.indexOf("e")+1)+e)).s=p.s),o=(e=d.precision)+3;;)if(f=(u=(c=r).times(c).times(c)).plus(p),r=A(f.plus(p).times(c),f.plus(u),o+2,1),S(c.d).slice(0,o)===(n=S(r.d)).slice(0,o)){if("9999"!=(n=n.slice(o-3,o+1))&&(i||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(k(r,e+1,1),t=!r.times(r).times(r).eq(p));break}if(!i&&(k(c,e+1,0),c.times(c).times(c).eq(p))){r=c;break}o+=4,i=1}return a=!0,k(r,e,d.rounding,t)},E.decimalPlaces=E.dp=function(){var e,t=this.d,n=NaN;if(t){if(n=7*((e=t.length-1)-h(this.e/7)),e=t[e])for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n},E.dividedBy=E.div=function(e){return A(this,new this.constructor(e))},E.dividedToIntegerBy=E.divToInt=function(e){var t=this.constructor;return k(A(this,new t(e),0,1,1),t.precision,t.rounding)},E.equals=E.eq=function(e){return 0===this.cmp(e)},E.floor=function(){return k(new this.constructor(this),this.e+1,3)},E.greaterThan=E.gt=function(e){return this.cmp(e)>0},E.greaterThanOrEqualTo=E.gte=function(e){var t=this.cmp(e);return 1==t||0===t},E.hyperbolicCosine=E.cosh=function(){var e,t,n,r,i,s=this,o=s.constructor,c=new o(1);if(!s.isFinite())return new o(s.s?1/0:NaN);if(s.isZero())return c;n=o.precision,r=o.rounding,o.precision=n+Math.max(s.e,s.sd())+4,o.rounding=1,(i=s.d.length)<32?t=(1/L(4,e=Math.ceil(i/3))).toString():(e=16,t="2.3283064365386962890625e-10"),s=U(o,1,s.times(t),new o(1),!0);for(var a,u=e,f=new o(8);u--;)a=s.times(s),s=c.minus(a.times(f.minus(a.times(f))));return k(s,o.precision=n,o.rounding=r,!0)},E.hyperbolicSine=E.sinh=function(){var e,t,n,r,i=this,s=i.constructor;if(!i.isFinite()||i.isZero())return new s(i);if(t=s.precision,n=s.rounding,s.precision=t+Math.max(i.e,i.sd())+4,s.rounding=1,(r=i.d.length)<3)i=U(s,2,i,i,!0);else{e=(e=1.4*Math.sqrt(r))>16?16:0|e,i=U(s,2,i=i.times(1/L(5,e)),i,!0);for(var o,c=new s(5),a=new s(16),u=new s(20);e--;)o=i.times(i),i=i.times(c.plus(o.times(a.times(o).plus(u))))}return s.precision=t,s.rounding=n,k(i,t,n,!0)},E.hyperbolicTangent=E.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,A(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)},E.inverseCosine=E.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),i=n.precision,s=n.rounding;return-1!==r?0===r?t.isNeg()?F(n,i,s):new n(0):new n(NaN):t.isZero()?F(n,i+4,s).times(.5):(n.precision=i+6,n.rounding=1,t=t.asin(),e=F(n,i+4,s).times(.5),n.precision=i,n.rounding=s,e.minus(t))},E.inverseHyperbolicCosine=E.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,a=!1,n=n.times(n).minus(1).sqrt().plus(n),a=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)},E.inverseHyperbolicSine=E.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,a=!1,n=n.times(n).plus(1).sqrt().plus(n),a=!0,r.precision=e,r.rounding=t,n.ln())},E.inverseHyperbolicTangent=E.atanh=function(){var e,t,n,r,i=this,s=i.constructor;return i.isFinite()?i.e>=0?new s(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=s.precision,t=s.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?k(new s(i),e,t,!0):(s.precision=n=r-i.e,i=A(i.plus(1),new s(1).minus(i),n+e,1),s.precision=e+4,s.rounding=1,i=i.ln(),s.precision=e,s.rounding=t,i.times(.5))):new s(NaN)},E.inverseSine=E.asin=function(){var e,t,n,r,i=this,s=i.constructor;return i.isZero()?new s(i):(t=i.abs().cmp(1),n=s.precision,r=s.rounding,-1!==t?0===t?((e=F(s,n+4,r).times(.5)).s=i.s,e):new s(NaN):(s.precision=n+6,s.rounding=1,i=i.div(new s(1).minus(i.times(i)).sqrt().plus(1)).atan(),s.precision=n,s.rounding=r,i.times(2)))},E.inverseTangent=E.atan=function(){var e,t,n,r,i,s,o,c,u,f=this,p=f.constructor,d=p.precision,l=p.rounding;if(f.isFinite()){if(f.isZero())return new p(f);if(f.abs().eq(1)&&d+4<=b)return(o=F(p,d+4,l).times(.25)).s=f.s,o}else{if(!f.s)return new p(NaN);if(d+4<=b)return(o=F(p,d+4,l).times(.5)).s=f.s,o}for(p.precision=c=d+10,p.rounding=1,e=n=Math.min(28,c/7+2|0);e;--e)f=f.div(f.times(f).plus(1).sqrt().plus(1));for(a=!1,t=Math.ceil(c/7),r=1,u=f.times(f),o=new p(f),i=f;-1!==e;)if(i=i.times(u),s=o.minus(i.div(r+=2)),i=i.times(u),void 0!==(o=s.plus(i.div(r+=2))).d[t])for(e=t;o.d[e]===s.d[e]&&e--;);return n&&(o=o.times(2<<n-1)),a=!0,k(o,p.precision=d,p.rounding=l,!0)},E.isFinite=function(){return!!this.d},E.isInteger=E.isInt=function(){return!!this.d&&h(this.e/7)>this.d.length-2},E.isNaN=function(){return!this.s},E.isNegative=E.isNeg=function(){return this.s<0},E.isPositive=E.isPos=function(){return this.s>0},E.isZero=function(){return!!this.d&&0===this.d[0]},E.lessThan=E.lt=function(e){return this.cmp(e)<0},E.lessThanOrEqualTo=E.lte=function(e){return this.cmp(e)<1},E.logarithm=E.log=function(e){var t,n,r,i,s,o,c,u,f=this,p=f.constructor,d=p.precision,l=p.rounding;if(null==e)e=new p(10),t=!0;else{if(n=(e=new p(e)).d,e.s<0||!n||!n[0]||e.eq(1))return new p(NaN);t=e.eq(10)}if(n=f.d,f.s<0||!n||!n[0]||f.eq(1))return new p(n&&!n[0]?-1/0:1!=f.s?NaN:n?0:1/0);if(t)if(n.length>1)s=!0;else{for(i=n[0];i%10==0;)i/=10;s=1!==i}if(a=!1,o=I(f,c=d+5),r=t?O(p,c+10):I(e,c),M((u=A(o,r,c,1)).d,i=d,l))do{if(o=I(f,c+=10),r=t?O(p,c+10):I(e,c),u=A(o,r,c,1),!s){+S(u.d).slice(i+1,i+15)+1==1e14&&(u=k(u,d+1,0));break}}while(M(u.d,i+=10,l));return a=!0,k(u,d,l)},E.minus=E.sub=function(e){var t,n,r,i,s,o,c,u,f,p,d,l,g=this,m=g.constructor;if(e=new m(e),!g.d||!e.d)return g.s&&e.s?g.d?e.s=-e.s:e=new m(e.d||g.s!==e.s?g:NaN):e=new m(NaN),e;if(g.s!=e.s)return e.s=-e.s,g.plus(e);if(f=g.d,l=e.d,c=m.precision,u=m.rounding,!f[0]||!l[0]){if(l[0])e.s=-e.s;else{if(!f[0])return new m(3===u?-0:0);e=new m(g)}return a?k(e,c,u):e}if(n=h(e.e/7),p=h(g.e/7),f=f.slice(),s=p-n){for((d=s<0)?(t=f,s=-s,o=l.length):(t=l,n=p,o=f.length),s>(r=Math.max(Math.ceil(c/7),o)+2)&&(s=r,t.length=1),t.reverse(),r=s;r--;)t.push(0);t.reverse()}else{for((d=(r=f.length)<(o=l.length))&&(o=r),r=0;r<o;r++)if(f[r]!=l[r]){d=f[r]<l[r];break}s=0}for(d&&(t=f,f=l,l=t,e.s=-e.s),o=f.length,r=l.length-o;r>0;--r)f[o++]=0;for(r=l.length;r>s;){if(f[--r]<l[r]){for(i=r;i&&0===f[--i];)f[i]=x-1;--f[i],f[r]+=x}f[r]-=l[r]}for(;0===f[--o];)f.pop();for(;0===f[0];f.shift())--n;return f[0]?(e.d=f,e.e=T(f,n),a?k(e,c,u):e):new m(3===u?-0:0)},E.modulo=E.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?k(new r(n),r.precision,r.rounding):(a=!1,9==r.modulo?(t=A(n,e.abs(),0,3,1)).s*=e.s:t=A(n,e,0,r.modulo,1),t=t.times(e),a=!0,n.minus(t))},E.naturalExponential=E.exp=function(){return R(this)},E.naturalLogarithm=E.ln=function(){return I(this)},E.negated=E.neg=function(){var e=new this.constructor(this);return e.s=-e.s,k(e)},E.plus=E.add=function(e){var t,n,r,i,s,o,c,u,f,p,d=this,l=d.constructor;if(e=new l(e),!d.d||!e.d)return d.s&&e.s?d.d||(e=new l(e.d||d.s===e.s?d:NaN)):e=new l(NaN),e;if(d.s!=e.s)return e.s=-e.s,d.minus(e);if(f=d.d,p=e.d,c=l.precision,u=l.rounding,!f[0]||!p[0])return p[0]||(e=new l(d)),a?k(e,c,u):e;if(s=h(d.e/7),r=h(e.e/7),f=f.slice(),i=s-r){for(i<0?(n=f,i=-i,o=p.length):(n=p,r=s,o=f.length),i>(o=(s=Math.ceil(c/7))>o?s+1:o+1)&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for((o=f.length)-(i=p.length)<0&&(i=o,n=p,p=f,f=n),t=0;i;)t=(f[--i]=f[i]+p[i]+t)/x|0,f[i]%=x;for(t&&(f.unshift(t),++r),o=f.length;0==f[--o];)f.pop();return e.d=f,e.e=T(f,r),a?k(e,c,u):e},E.precision=E.sd=function(e){var t,n=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(f+e);return n.d?(t=P(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t},E.round=function(){var e=this,t=e.constructor;return k(new t(e),e.e+1,t.rounding)},E.sine=E.sin=function(){var e,n,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(e=i.precision,n=i.rounding,i.precision=e+Math.max(r.e,r.sd())+7,i.rounding=1,r=function(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:U(e,2,t,t);n=(n=1.4*Math.sqrt(r))>16?16:0|n,t=t.times(1/L(5,n)),t=U(e,2,t,t);for(var i,s=new e(5),o=new e(16),c=new e(20);n--;)i=t.times(t),t=t.times(s.plus(i.times(o.times(i).minus(c))));return t}(i,W(i,r)),i.precision=e,i.rounding=n,k(t>2?r.neg():r,e,n,!0)):new i(NaN)},E.squareRoot=E.sqrt=function(){var e,t,n,r,i,s,o=this,c=o.d,u=o.e,f=o.s,p=o.constructor;if(1!==f||!c||!c[0])return new p(!f||f<0&&(!c||c[0])?NaN:c?o:1/0);for(a=!1,0==(f=Math.sqrt(+o))||f==1/0?(((t=S(c)).length+u)%2==0&&(t+="0"),f=Math.sqrt(t),u=h((u+1)/2)-(u<0||u%2),r=new p(t=f==1/0?"5e"+u:(t=f.toExponential()).slice(0,t.indexOf("e")+1)+u)):r=new p(f.toString()),n=(u=p.precision)+3;;)if(r=(s=r).plus(A(o,s,n+2,1)).times(.5),S(s.d).slice(0,n)===(t=S(r.d)).slice(0,n)){if("9999"!=(t=t.slice(n-3,n+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(k(r,u+1,1),e=!r.times(r).eq(o));break}if(!i&&(k(s,u+1,0),s.times(s).eq(o))){r=s;break}n+=4,i=1}return a=!0,k(r,u,p.rounding,e)},E.tangent=E.tan=function(){var e,n,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(e=i.precision,n=i.rounding,i.precision=e+10,i.rounding=1,(r=r.sin()).s=1,r=A(r,new i(1).minus(r.times(r)).sqrt(),e+10,0),i.precision=e,i.rounding=n,k(2==t||4==t?r.neg():r,e,n,!0)):new i(NaN)},E.times=E.mul=function(e){var t,n,r,i,s,o,c,u,f,p=this,d=p.constructor,l=p.d,g=(e=new d(e)).d;if(e.s*=p.s,!(l&&l[0]&&g&&g[0]))return new d(!e.s||l&&!l[0]&&!g||g&&!g[0]&&!l?NaN:l&&g?0*e.s:e.s/0);for(n=h(p.e/7)+h(e.e/7),(u=l.length)<(f=g.length)&&(s=l,l=g,g=s,o=u,u=f,f=o),s=[],r=o=u+f;r--;)s.push(0);for(r=f;--r>=0;){for(t=0,i=u+r;i>r;)c=s[i]+g[r]*l[i-r-1]+t,s[i--]=c%x|0,t=c/x|0;s[i]=(s[i]+t)%x|0}for(;!s[--o];)s.pop();return t?++n:s.shift(),e.d=s,e.e=T(s,n),a?k(e,d.precision,d.rounding):e},E.toBinary=function(e,t){return V(this,2,e,t)},E.toDecimalPlaces=E.toDP=function(e,t){var n=this,i=n.constructor;return n=new i(n),void 0===e?n:($(e,0,r),void 0===t?t=i.rounding:$(t,0,8),k(n,e+n.e+1,t))},E.toExponential=function(e,t){var n,i=this,s=i.constructor;return void 0===e?n=Y(i,!0):($(e,0,r),void 0===t?t=s.rounding:$(t,0,8),n=Y(i=k(new s(i),e+1,t),!0,e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},E.toFixed=function(e,t){var n,i,s=this,o=s.constructor;return void 0===e?n=Y(s):($(e,0,r),void 0===t?t=o.rounding:$(t,0,8),n=Y(i=k(new o(s),e+s.e+1,t),!1,e+i.e+1)),s.isNeg()&&!s.isZero()?"-"+n:n},E.toFraction=function(e){var t,n,r,i,s,o,c,u,p,d,l,h,m=this,w=m.d,v=m.constructor;if(!w)return new v(m);if(p=n=new v(1),r=u=new v(0),o=(s=(t=new v(r)).e=P(w)-m.e-1)%7,t.d[0]=g(10,o<0?7+o:o),null==e)e=s>0?t:p;else{if(!(c=new v(e)).isInt()||c.lt(p))throw Error(f+c);e=c.gt(t)?s>0?t:p:c}for(a=!1,c=new v(S(w)),d=v.precision,v.precision=s=7*w.length*2;l=A(c,t,0,1,1),1!=(i=n.plus(l.times(r))).cmp(e);)n=r,r=i,i=p,p=u.plus(l.times(i)),u=i,i=t,t=c.minus(l.times(i)),c=i;return i=A(e.minus(n),r,0,1,1),u=u.plus(i.times(p)),n=n.plus(i.times(r)),u.s=p.s=m.s,h=A(p,r,s,1).minus(m).abs().cmp(A(u,n,s,1).minus(m).abs())<1?[p,r]:[u,n],v.precision=d,a=!0,h},E.toHexadecimal=E.toHex=function(e,t){return V(this,16,e,t)},E.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),null==e){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),void 0===t?t=r.rounding:$(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(a=!1,n=A(n,e,0,t,1).times(e),a=!0,k(n)):(e.s=n.s,n=e),n},E.toNumber=function(){return+this},E.toOctal=function(e,t){return V(this,8,e,t)},E.toPower=E.pow=function(e){var t,n,r,i,s,o,c=this,u=c.constructor,f=+(e=new u(e));if(!(c.d&&e.d&&c.d[0]&&e.d[0]))return new u(g(+c,f));if((c=new u(c)).eq(1))return c;if(r=u.precision,s=u.rounding,e.eq(1))return k(c,r,s);if((t=h(e.e/7))>=e.d.length-1&&(n=f<0?-f:f)<=9007199254740991)return i=C(u,c,n,r),e.s<0?new u(1).div(i):k(i,r,s);if((o=c.s)<0){if(t<e.d.length-1)return new u(NaN);if(1&e.d[t]||(o=1),0==c.e&&1==c.d[0]&&1==c.d.length)return c.s=o,c}return(t=0!=(n=g(+c,f))&&isFinite(n)?new u(n+"").e:h(f*(Math.log("0."+S(c.d))/Math.LN10+c.e+1)))>u.maxE+1||t<u.minE-1?new u(t>0?o/0:0):(a=!1,u.rounding=c.s=1,n=Math.min(12,(t+"").length),(i=R(e.times(I(c,r+n)),r)).d&&M((i=k(i,r+5,1)).d,r,s)&&(t=r+10,+S((i=k(R(e.times(I(c,t+n)),t),t+5,1)).d).slice(r+1,r+15)+1==1e14&&(i=k(i,r+1,0))),i.s=o,a=!0,u.rounding=s,k(i,r,s))},E.toPrecision=function(e,t){var n,i=this,s=i.constructor;return void 0===e?n=Y(i,i.e<=s.toExpNeg||i.e>=s.toExpPos):($(e,1,r),void 0===t?t=s.rounding:$(t,0,8),n=Y(i=k(new s(i),e,t),e<=i.e||i.e<=s.toExpNeg,e)),i.isNeg()&&!i.isZero()?"-"+n:n},E.toSignificantDigits=E.toSD=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):($(e,1,r),void 0===t?t=n.rounding:$(t,0,8)),k(new n(this),e,t)},E.toString=function(){var e=this,t=e.constructor,n=Y(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n},E.truncated=E.trunc=function(){return k(new this.constructor(this),this.e+1,1)},E.valueOf=E.toJSON=function(){var e=this,t=e.constructor,n=Y(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};var A=function(){function t(e,t,n){var r,i=0,s=e.length;for(e=e.slice();s--;)r=e[s]*t+i,e[s]=r%n|0,i=r/n|0;return i&&e.unshift(i),e}function n(e,t,n,r){var i,s;if(n!=r)s=n>r?1:-1;else for(i=s=0;i<n;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(i,s,o,c,a,u){var f,p,d,l,g,m,w,v,y,N,b,E,S,$,M,D,A,Y,T,O,F=i.constructor,P=i.s==s.s?1:-1,H=i.d,C=s.d;if(!(H&&H[0]&&C&&C[0]))return new F(i.s&&s.s&&(H?!C||H[0]!=C[0]:C)?H&&0==H[0]||!C?0*P:P/0:NaN);for(u?(g=1,p=i.e-s.e):(u=x,g=7,p=h(i.e/g)-h(s.e/g)),T=C.length,A=H.length,N=(y=new F(P)).d=[],d=0;C[d]==(H[d]||0);d++);if(C[d]>(H[d]||0)&&p--,null==o?($=o=F.precision,c=F.rounding):$=a?o+(i.e-s.e)+1:o,$<0)N.push(1),m=!0;else{if($=$/g+2|0,d=0,1==T){for(l=0,C=C[0],$++;(d<A||l)&&$--;d++)M=l*u+(H[d]||0),N[d]=M/C|0,l=M%C|0;m=l||d<A}else{for((l=u/(C[0]+1)|0)>1&&(C=t(C,l,u),H=t(H,l,u),T=C.length,A=H.length),D=T,E=(b=H.slice(0,T)).length;E<T;)b[E++]=0;(O=C.slice()).unshift(0),Y=C[0],C[1]>=u/2&&++Y;do{l=0,(f=n(C,b,T,E))<0?(S=b[0],T!=E&&(S=S*u+(b[1]||0)),(l=S/Y|0)>1?(l>=u&&(l=u-1),1==(f=n(w=t(C,l,u),b,v=w.length,E=b.length))&&(l--,r(w,T<v?O:C,v,u))):(0==l&&(f=l=1),w=C.slice()),(v=w.length)<E&&w.unshift(0),r(b,w,E,u),-1==f&&(f=n(C,b,T,E=b.length))<1&&(l++,r(b,T<E?O:C,E,u)),E=b.length):0===f&&(l++,b=[0]),N[d++]=l,f&&b[0]?b[E++]=H[D]||0:(b=[H[D]],E=1)}while((D++<A||void 0!==b[0])&&$--);m=void 0!==b[0]}N[0]||N.shift()}if(1==g)y.e=p,e=m;else{for(d=1,l=N[0];l>=10;l/=10)d++;y.e=d+p*g-1,k(y,a?o+y.e+1:o,c,m)}return y}}();function k(e,t,n,r){var i,s,o,c,u,f,p,d,l,h=e.constructor;e:if(null!=t){if(!(d=e.d))return e;for(i=1,c=d[0];c>=10;c/=10)i++;if((s=t-i)<0)s+=7,o=t,u=(p=d[l=0])/g(10,i-o-1)%10|0;else if((l=Math.ceil((s+1)/7))>=(c=d.length)){if(!r)break e;for(;c++<=l;)d.push(0);p=u=0,i=1,o=(s%=7)-7+1}else{for(p=c=d[l],i=1;c>=10;c/=10)i++;u=(o=(s%=7)-7+i)<0?0:p/g(10,i-o-1)%10|0}if(r=r||t<0||void 0!==d[l+1]||(o<0?p:p%g(10,i-o-1)),f=n<4?(u||r)&&(0==n||n==(e.s<0?3:2)):u>5||5==u&&(4==n||r||6==n&&(s>0?o>0?p/g(10,i-o):0:d[l-1])%10&1||n==(e.s<0?8:7)),t<1||!d[0])return d.length=0,f?(t-=e.e+1,d[0]=g(10,(7-t%7)%7),e.e=-t||0):d[0]=e.e=0,e;if(0==s?(d.length=l,c=1,l--):(d.length=l+1,c=g(10,7-s),d[l]=o>0?(p/g(10,i-o)%g(10,o)|0)*c:0),f)for(;;){if(0==l){for(s=1,o=d[0];o>=10;o/=10)s++;for(o=d[0]+=c,c=1;o>=10;o/=10)c++;s!=c&&(e.e++,d[0]==x&&(d[0]=1));break}if(d[l]+=c,d[l]!=x)break;d[l--]=0,c=1}for(s=d.length;0===d[--s];)d.pop()}return a&&(e.e>h.maxE?(e.d=null,e.e=NaN):e.e<h.minE&&(e.e=0,e.d=[0])),e}function Y(e,t,n){if(!e.isFinite())return j(e);var r,i=e.e,s=S(e.d),o=s.length;return t?(n&&(r=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+H(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(e.e<0?"e":"e+")+e.e):i<0?(s="0."+H(-i-1)+s,n&&(r=n-o)>0&&(s+=H(r))):i>=o?(s+=H(i+1-o),n&&(r=n-i-1)>0&&(s=s+"."+H(r))):((r=i+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(s+="."),s+=H(r))),s}function T(e,t){var n=e[0];for(t*=7;n>=10;n/=10)t++;return t}function O(e,t,n){if(t>N)throw a=!0,n&&(e.precision=n),Error(p);return k(new e(s),t,1,!0)}function F(e,t,n){if(t>b)throw Error(p);return k(new e(o),t,n,!0)}function P(e){var t=e.length-1,n=7*t+1;if(t=e[t]){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function H(e){for(var t="";e--;)t+="0";return t}function C(e,t,n,r){var i,s=new e(1),o=Math.ceil(r/7+4);for(a=!1;;){if(n%2&&K((s=s.times(t)).d,o)&&(i=!0),0===(n=h(n/2))){n=s.d.length-1,i&&0===s.d[n]&&++s.d[n];break}K((t=t.times(t)).d,o)}return a=!0,s}function q(e){return 1&e.d[e.d.length-1]}function _(e,t,n){for(var r,i=new e(t[0]),s=0;++s<t.length;){if(!(r=new e(t[s])).s){i=r;break}i[n](r)&&(i=r)}return i}function R(e,t){var n,r,i,s,o,c,u,f=0,p=0,d=0,l=e.constructor,h=l.rounding,m=l.precision;if(!e.d||!e.d[0]||e.e>17)return new l(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(a=!1,u=m):u=t,c=new l(.03125);e.e>-2;)e=e.times(c),d+=5;for(u+=r=Math.log(g(2,d))/Math.LN10*2+5|0,n=s=o=new l(1),l.precision=u;;){if(s=k(s.times(e),u,1),n=n.times(++p),S((c=o.plus(A(s,n,u,1))).d).slice(0,u)===S(o.d).slice(0,u)){for(i=d;i--;)o=k(o.times(o),u,1);if(null!=t)return l.precision=m,o;if(!(f<3&&M(o.d,u-r,h,f)))return k(o,l.precision=m,h,a=!0);l.precision=u+=10,n=s=c=new l(1),p=0,f++}o=c}}function I(e,t){var n,r,i,s,o,c,u,f,p,d,l,h=1,g=e,m=g.d,w=g.constructor,v=w.rounding,y=w.precision;if(g.s<0||!m||!m[0]||!g.e&&1==m[0]&&1==m.length)return new w(m&&!m[0]?-1/0:1!=g.s?NaN:m?0:g);if(null==t?(a=!1,p=y):p=t,w.precision=p+=10,r=(n=S(m)).charAt(0),!(Math.abs(s=g.e)<15e14))return f=O(w,p+2,y).times(s+""),g=I(new w(r+"."+n.slice(1)),p-10).plus(f),w.precision=y,null==t?k(g,y,v,a=!0):g;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=S((g=g.times(e)).d)).charAt(0),h++;for(s=g.e,r>1?(g=new w("0."+n),s++):g=new w(r+"."+n.slice(1)),d=g,u=o=g=A(g.minus(1),g.plus(1),p,1),l=k(g.times(g),p,1),i=3;;){if(o=k(o.times(l),p,1),S((f=u.plus(A(o,new w(i),p,1))).d).slice(0,p)===S(u.d).slice(0,p)){if(u=u.times(2),0!==s&&(u=u.plus(O(w,p+2,y).times(s+""))),u=A(u,new w(h),p,1),null!=t)return w.precision=y,u;if(!M(u.d,p-10,v,c))return k(u,w.precision=y,v,a=!0);w.precision=p+=10,f=o=g=A(d.minus(1),d.plus(1),p,1),l=k(g.times(g),p,1),i=c=1}u=f,i+=2}}function j(e){return String(e.s*e.s/0)}function Z(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);r++);for(i=t.length;48===t.charCodeAt(i-1);--i);if(t=t.slice(r,i)){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%7,n<0&&(r+=7),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=7;r<i;)e.d.push(+t.slice(r,r+=7));r=7-(t=t.slice(r)).length}else r-=i;for(;r--;)t+="0";e.d.push(+t),a&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function B(e,t){var n,r,i,s,o,c,u,p,d;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),y.test(t))return Z(e,t)}else if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(w.test(t))n=16,t=t.toLowerCase();else if(m.test(t))n=2;else{if(!v.test(t))throw Error(f+t);n=8}for((s=t.search(/p/i))>0?(u=+t.slice(s+1),t=t.substring(2,s)):t=t.slice(2),o=(s=t.indexOf("."))>=0,r=e.constructor,o&&(s=(c=(t=t.replace(".","")).length)-s,i=C(r,new r(n),s,2*s)),s=d=(p=D(t,n,x)).length-1;0===p[s];--s)p.pop();return s<0?new r(0*e.s):(e.e=T(p,d),e.d=p,a=!1,o&&(e=A(e,i,4*c)),u&&(e=e.times(Math.abs(u)<54?g(2,u):He.pow(2,u))),a=!0,e)}function U(e,t,n,r,i){var s,o,c,u,f=e.precision,p=Math.ceil(f/7);for(a=!1,u=n.times(n),c=new e(r);;){if(o=A(c.times(u),new e(t++*t++),f,1),c=i?r.plus(o):r.minus(o),r=A(o.times(u),new e(t++*t++),f,1),void 0!==(o=c.plus(r)).d[p]){for(s=p;o.d[s]===c.d[s]&&s--;);if(-1==s)break}s=c,c=r,r=o,o=s}return a=!0,o.d.length=p+1,o}function L(e,t){for(var n=e;--t;)n*=e;return n}function W(e,n){var r,i=n.s<0,s=F(e,e.precision,1),o=s.times(.5);if((n=n.abs()).lte(o))return t=i?4:1,n;if((r=n.divToInt(s)).isZero())t=i?3:2;else{if((n=n.minus(r.times(s))).lte(o))return t=q(r)?i?2:3:i?4:1,n;t=q(r)?i?1:4:i?3:2}return n.minus(s).abs()}function V(t,n,s,o){var c,a,u,f,p,d,l,h,g,m=t.constructor,w=void 0!==s;if(w?($(s,1,r),void 0===o?o=m.rounding:$(o,0,8)):(s=m.precision,o=m.rounding),t.isFinite()){for(w?(c=2,16==n?s=4*s-3:8==n&&(s=3*s-2)):c=n,(u=(l=Y(t)).indexOf("."))>=0&&(l=l.replace(".",""),(g=new m(1)).e=l.length-u,g.d=D(Y(g),10,c),g.e=g.d.length),a=p=(h=D(l,10,c)).length;0==h[--p];)h.pop();if(h[0]){if(u<0?a--:((t=new m(t)).d=h,t.e=a,h=(t=A(t,g,s,o,0,c)).d,a=t.e,d=e),u=h[s],f=c/2,d=d||void 0!==h[s+1],d=o<4?(void 0!==u||d)&&(0===o||o===(t.s<0?3:2)):u>f||u===f&&(4===o||d||6===o&&1&h[s-1]||o===(t.s<0?8:7)),h.length=s,d)for(;++h[--s]>c-1;)h[s]=0,s||(++a,h.unshift(1));for(p=h.length;!h[p-1];--p);for(u=0,l="";u<p;u++)l+=i.charAt(h[u]);if(w){if(p>1)if(16==n||8==n){for(u=16==n?4:3,--p;p%u;p++)l+="0";for(p=(h=D(l,c,n)).length;!h[p-1];--p);for(u=1,l="1.";u<p;u++)l+=i.charAt(h[u])}else l=l.charAt(0)+"."+l.slice(1);l=l+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)l="0"+l;l="0."+l}else if(++a>p)for(a-=p;a--;)l+="0";else a<p&&(l=l.slice(0,a)+"."+l.slice(a))}else l=w?"0p+0":"0";l=(16==n?"0x":2==n?"0b":8==n?"0o":"")+l}else l=j(t);return t.s<0?"-"+l:l}function K(e,t){if(e.length>t)return e.length=t,!0}function z(e){return new this(e).abs()}function X(e){return new this(e).acos()}function J(e){return new this(e).acosh()}function G(e,t){return new this(e).plus(t)}function Q(e){return new this(e).asin()}function ee(e){return new this(e).asinh()}function te(e){return new this(e).atan()}function ne(e){return new this(e).atanh()}function re(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,s=r+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(n=t.s<0?F(this,r,i):new this(0)).s=e.s:!e.d||t.isZero()?(n=F(this,s,1).times(.5)).s=e.s:t.s<0?(this.precision=s,this.rounding=1,n=this.atan(A(e,t,s,1)),t=F(this,s,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(A(e,t,s,1)):(n=F(this,s,1).times(t.s>0?.25:.75)).s=e.s:n=new this(NaN),n}function ie(e){return new this(e).cbrt()}function se(e){return k(e=new this(e),e.e+1,2)}function oe(e,t,n){return new this(e).clamp(t,n)}function ce(e){if(!e||"object"!=typeof e)throw Error(u+"Object expected");var t,i,s,o=!0===e.defaults,a=["precision",1,r,"rounding",0,8,"toExpNeg",-9e15,0,"toExpPos",0,n,"maxE",0,n,"minE",-9e15,0,"modulo",0,9];for(t=0;t<a.length;t+=3)if(i=a[t],o&&(this[i]=c[i]),void 0!==(s=e[i])){if(!(h(s)===s&&s>=a[t+1]&&s<=a[t+2]))throw Error(f+i+": "+s);this[i]=s}if(i="crypto",o&&(this[i]=c[i]),void 0!==(s=e[i])){if(!0!==s&&!1!==s&&0!==s&&1!==s)throw Error(f+i+": "+s);if(s){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(d);this[i]=!0}else this[i]=!1}return this}function ae(e){return new this(e).cos()}function ue(e){return new this(e).cosh()}function fe(e,t){return new this(e).div(t)}function pe(e){return new this(e).exp()}function de(e){return k(e=new this(e),e.e+1,3)}function le(){var e,t,n=new this(0);for(a=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return a=!0,new this(1/0);n=t}return a=!0,n.sqrt()}function he(e){return e instanceof He||e&&e.toStringTag===l||!1}function ge(e){return new this(e).ln()}function me(e,t){return new this(e).log(t)}function we(e){return new this(e).log(2)}function ve(e){return new this(e).log(10)}function ye(){return _(this,arguments,"lt")}function xe(){return _(this,arguments,"gt")}function Ne(e,t){return new this(e).mod(t)}function be(e,t){return new this(e).mul(t)}function Ee(e,t){return new this(e).pow(t)}function Se(e){var t,n,i,s,o=0,c=new this(1),a=[];if(void 0===e?e=this.precision:$(e,1,r),i=Math.ceil(e/7),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(i));o<i;)(s=t[o])>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=s%1e7;else{if(!crypto.randomBytes)throw Error(d);for(t=crypto.randomBytes(i*=4);o<i;)(s=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((127&t[o+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,o):(a.push(s%1e7),o+=4);o=i/4}else for(;o<i;)a[o++]=1e7*Math.random()|0;for(e%=7,(i=a[--o])&&e&&(s=g(10,7-e),a[o]=(i/s|0)*s);0===a[o];o--)a.pop();if(o<0)n=0,a=[0];else{for(n=-1;0===a[0];n-=7)a.shift();for(i=1,s=a[0];s>=10;s/=10)i++;i<7&&(n-=7-i)}return c.e=n,c.d=a,c}function $e(e){return k(e=new this(e),e.e+1,this.rounding)}function Me(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function De(e){return new this(e).sin()}function Ae(e){return new this(e).sinh()}function ke(e){return new this(e).sqrt()}function Ye(e,t){return new this(e).sub(t)}function Te(){var e=0,t=arguments,n=new this(t[e]);for(a=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return a=!0,k(n,this.precision,this.rounding)}function Oe(e){return new this(e).tan()}function Fe(e){return new this(e).tanh()}function Pe(e){return k(e=new this(e),e.e+1,1)}E[Symbol.for("nodejs.util.inspect.custom")]=E.toString,E[Symbol.toStringTag]="Decimal";var He=E.constructor=function e(t){var n,r,i;function s(e){var t,n,r,i=this;if(!(i instanceof s))return new s(e);if(i.constructor=s,he(e))return i.s=e.s,void(a?!e.d||e.e>s.maxE?(i.e=NaN,i.d=null):e.e<s.minE?(i.e=0,i.d=[0]):(i.e=e.e,i.d=e.d.slice()):(i.e=e.e,i.d=e.d?e.d.slice():e.d));if("number"===(r=typeof e)){if(0===e)return i.s=1/e<0?-1:1,i.e=0,void(i.d=[0]);if(e<0?(e=-e,i.s=-1):i.s=1,e===~~e&&e<1e7){for(t=0,n=e;n>=10;n/=10)t++;return void(a?t>s.maxE?(i.e=NaN,i.d=null):t<s.minE?(i.e=0,i.d=[0]):(i.e=t,i.d=[e]):(i.e=t,i.d=[e]))}return 0*e!=0?(e||(i.s=NaN),i.e=NaN,void(i.d=null)):Z(i,e.toString())}if("string"!==r)throw Error(f+e);return 45===(n=e.charCodeAt(0))?(e=e.slice(1),i.s=-1):(43===n&&(e=e.slice(1)),i.s=1),y.test(e)?Z(i,e):B(i,e)}if(s.prototype=E,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.EUCLID=9,s.config=s.set=ce,s.clone=e,s.isDecimal=he,s.abs=z,s.acos=X,s.acosh=J,s.add=G,s.asin=Q,s.asinh=ee,s.atan=te,s.atanh=ne,s.atan2=re,s.cbrt=ie,s.ceil=se,s.clamp=oe,s.cos=ae,s.cosh=ue,s.div=fe,s.exp=pe,s.floor=de,s.hypot=le,s.ln=ge,s.log=me,s.log10=ve,s.log2=we,s.max=ye,s.min=xe,s.mod=Ne,s.mul=be,s.pow=Ee,s.random=Se,s.round=$e,s.sign=Me,s.sin=De,s.sinh=Ae,s.sqrt=ke,s.sub=Ye,s.sum=Te,s.tan=Oe,s.tanh=Fe,s.trunc=Pe,void 0===t&&(t={}),t&&!0!==t.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<i.length;)t.hasOwnProperty(r=i[n++])||(t[r]=this[r]);return s.config(t),s}(c);s=new He(s),o=new He(o);class Ce{constructor(e,t,n){this.year=e,this.month=t,this.timestamp=n}getYMString(){let e="";return 0!==this.year&&(e+=this.year+"年"),0!==this.month&&(e+=this.month+"月"),""!=e&&(e+="+"),e}toString(){return this.getYMString()+this.timestamp+"ms"}}const qe={pi:He.acos(-1),e:He.exp(1)};function _e(e){return e instanceof He}function Re(e){return e instanceof Date&&!isNaN(e)}function Ie(e){return e instanceof Ce}const je={formatToDisplayString:e=>Ie(e)?{value:e.toString(),info:"时间间隔："+je.formatDateStamp(e)}:Re(e)?{value:e.getTime(),info:"时间戳对应日期："+je.formatDate(e)}:e.toString(),add(e,t){if(_e(e)&&_e(t))return e.plus(t);if("string"==typeof e||"string"==typeof t)return e.toString()+t.toString();if(Ie(e)&&Ie(t))return new Ce(e.year+t.year,e.month+t.month,e.timestamp+t.timestamp);if(Re(e)&&Ie(t)){const n=new Date(e);return n.setFullYear(n.getFullYear()+t.year),n.setMonth(n.getMonth()+t.month),n.setMilliseconds(n.getMilliseconds()+t.timestamp),n}if(Re(t)&&Ie(e)){const n=new Date(t);return n.setFullYear(n.getFullYear()+e.year),n.setMonth(n.getMonth()+e.month),n.setMilliseconds(n.getMilliseconds()+e.timestamp),n}if(Re(e)&&Re(t))throw new Error("两个日期类型不能相加");if(typeof e!=typeof t)throw new Error(`参数类型不一致: ${typeof e} 和 ${typeof t}`);throw new Error("不支持的加法")},subtract(e,t){if(_e(e)&&_e(t))return e.minus(t);if(Ie(e)){if(Ie(t))return new Ce(e.year-t.year,e.month-t.month,e.timestamp-t.timestamp);throw Re(t)?new Error("时间戳不能减去日期 "):new Error("不支持的时间戳减法")}if(Re(e)){if(Ie(t)){const n=new Date(e);return n.setFullYear(n.getFullYear()-t.year),n.setMonth(n.getMonth()-t.month),n.setMilliseconds(n.getMilliseconds()-t.timestamp),n}if(Re(t)){const n=e.getTime()-t.getTime();return new Ce(0,0,n)}throw new Error("不支持的日期减法")}if(typeof e!=typeof t)throw new Error(`参数类型不一致: ${typeof e} 和 ${typeof t}`);throw new Error("不支持的减法")},multiply(e,t){if(_e(e)&&_e(t))return e.times(t);throw new Error("不支持的乘法")},divide(e,t){if(_e(e)&&_e(t))return e.div(t);throw new Error("不支持的除法")},floorDivide(e,t){if(_e(e)&&_e(t))return e.div(t).floor();throw new Error("不支持的整除")},mod(e,t){if(_e(e)&&_e(t))return e.mod(t);throw new Error("不支持的模运算")},pow(e,t){if(_e(e)&&_e(t))return e.pow(t);throw new Error("不支持的幂运算")},toNumber(e){try{return new He(e)}catch(t){throw new Error(`无法将 ${e} 转换为数字类型`)}},toFixed:(e,t)=>(_e(e)?e:new He(e)).toFixed(t).toString(),radianToPi(e){const t=(_e(e)?e:new He(e)).div(qe.pi);if(t.isInteger())return t.equals(1)?"π":t.equals(-1)?"-π":`${t}*π`;const n=[2,3,4,6,8,12];for(const e of n){const n=t.toNumber()*e;if(Math.abs(Math.round(n)-n)<1e-8){const t=Math.round(n);return 1===Math.abs(t)?t>0?`π/${e}`:`-π/${e}`:`${t}*π/${e}`}}return`${t.toFixed(6)}*π`},radianToDeg(e){let t=(_e(e)?e:new He(e)).times(180).div(qe.pi);return t=t.mod(360),t.lt(0)&&(t=t.plus(360)),t},dateToTimestamp(e){const t=new Date(e);if(isNaN(t.getTime()))throw new Error(`无法将${e}转成日期`);return t.getTime()},formatDate(e){if(Ie(e))throw new Error('无法将时间间隔转成日期, 请使用"> #"');const t=new Date(e);if(isNaN(t.getTime()))throw new Error(`无法将${e}转成日期`);const n=t.getFullYear(),r=t.getMonth()+1,i=t.getDate(),s=t.getHours(),o=t.getMinutes(),c=t.getSeconds();return 0===s&&0===o&&0===c?`${n}-${r.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")}`:`${n}-${r.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")} ${s.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`},formatDateStamp(e){if(!Ie(e))throw new Error('"> #"只能可视化时间间隔类型');const t=e.timestamp,n=Math.abs(t),r=Math.floor(n/1e3%60),i=Math.floor(n/6e4%60),s=Math.floor(n/36e5%24),o=`${t<0?"-":""}${Math.floor(n/864e5)}天 ${s}小时 ${i}分钟 ${r}秒`;return e.getYMString()+o},formatDateStamp2Week(e){if(!Ie(e))throw new Error('"> #w"只能可视化时间间隔类型');const t=(e.timestamp/6048e5).toFixed(2)+"周";return e.getYMString()+t},formatDateStamp2Day(e){if(!Ie(e))throw new Error('"> #d"只能可视化时间间隔类型');const t=(e.timestamp/864e5).toFixed(2)+"天";return e.getYMString()+t},formatDateStamp2Hour(e){if(!Ie(e))throw new Error('"> #h"只能可视化时间间隔类型');const t=(e.timestamp/36e5).toFixed(2)+"小时";return e.getYMString()+t},formatDateStamp2Minute(e){if(!Ie(e))throw new Error('"> #m"只能可视化时间间隔类型');const t=(e.timestamp/6e4).toFixed(2)+"分钟";return e.getYMString()+t},formatDateStamp2Second(e){if(!Ie(e))throw new Error('"> #s"只能可视化时间间隔类型');const t=(e.timestamp/1e3).toFixed(2)+"秒";return e.getYMString()+t}},Ze={"π":qe.pi,PI:qe.pi,pi:qe.pi,e:qe.e,E:qe.e},Be={"(":{description:"左括号"},")":{description:"右括号"}},Ue={",":{description:"参数分隔符"}},Le={"+":{precedence:2,args:2,func:je.add,acceptAny:!0,position:"infix",description:"加法"},"-":{precedence:2,args:2,func:je.subtract,acceptAny:!0,position:"infix",description:"减法"},"*":{precedence:4,args:2,func:je.multiply,position:"infix",description:"乘法"},"/":{precedence:4,args:2,func:je.divide,position:"infix",description:"除法"},"//":{precedence:4,args:2,func:je.floorDivide,position:"infix",description:"整除"},"%":{precedence:4,args:2,func:je.mod,position:"infix",description:"取模"},"**":{precedence:7,args:2,func:je.pow,position:"infix",description:"幂运算"},"°":{alias:".rad",description:"角度转弧度"},"unary-":{precedence:5,args:1,func:e=>e.neg(),position:"prefix",description:"负号"},"unary+":{precedence:5,args:1,func:e=>e,position:"prefix",description:"正号"},"unary%":{precedence:5,args:1,func:e=>e.times(.01),position:"postfix",preventSelfReference:!0,description:"百分号"},"‰":{precedence:5,args:1,func:e=>e.times(.001),position:"postfix",preventSelfReference:!0,description:"千分号"},"&":{precedence:1,args:2,func:(e,t)=>e&t,position:"infix",description:"按位与"},and:{alias:"&",description:"按位与"},"|":{precedence:1,args:2,func:(e,t)=>e|t,position:"infix",description:"按位或"},or:{alias:"|",description:"按位或"},"^":{precedence:1,args:2,func:(e,t)=>e^t,position:"infix",description:"按位异或"},"~":{precedence:6,args:1,func:e=>~e,position:"prefix",description:"按位取反"},not:{alias:"~",description:"按位取反"},"<<":{precedence:3,args:2,func:(e,t)=>"bigint"==typeof e||"bigint"==typeof t?BigInt(e)<<BigInt(t):e<<t,position:"infix",description:"左移"},">>":{precedence:3,args:2,func:(e,t)=>"bigint"==typeof e||"bigint"==typeof t?BigInt(e)>>BigInt(t):e>>t,position:"infix",description:"右移"},">>>":{precedence:3,args:2,func:(e,t)=>"bigint"==typeof e||"bigint"==typeof t?BigInt(e)>>>BigInt(t):e>>>t,position:"infix",description:"无符号右移"},"=":{precedence:0,args:2,func:(e,t)=>t,position:"infix",acceptAny:!0,isCompoundAssignment:!0,description:"赋值"},"+=":{precedence:0,args:2,func:(e,t)=>je.toNumber(e)+je.toNumber(t),position:"infix",description:"加法赋值",isCompoundAssignment:!0},"-=":{precedence:0,args:2,func:(e,t)=>je.toNumber(e)-je.toNumber(t),position:"infix",description:"减法赋值",isCompoundAssignment:!0},"*=":{precedence:0,args:2,func:(e,t)=>je.toNumber(e)*je.toNumber(t),position:"infix",description:"乘法赋值",isCompoundAssignment:!0},"/=":{precedence:0,args:2,func:(e,t)=>{const n=je.toNumber(t);if(0===n)throw new Error("除数不能为零");return je.toNumber(e)/n},position:"infix",description:"除法赋值",isCompoundAssignment:!0},"&=":{precedence:0,args:2,func:(e,t)=>e&t,position:"infix",description:"按位与赋值",isCompoundAssignment:!0},"|=":{precedence:0,args:2,func:(e,t)=>e|t,position:"infix",description:"按位或赋值",isCompoundAssignment:!0},"^=":{precedence:0,args:2,func:(e,t)=>e^t,position:"infix",description:"按位异或赋值",isCompoundAssignment:!0},"<<=":{precedence:0,args:2,func:(e,t)=>e<<t,position:"infix",description:"左移赋值",isCompoundAssignment:!0},">>=":{precedence:0,args:2,func:(e,t)=>e>>t,position:"infix",description:"右移赋值",isCompoundAssignment:!0},">>>=":{precedence:0,args:2,func:(e,t)=>e>>>t,position:"infix",description:"无符号右移赋值",isCompoundAssignment:!0},"@":{precedence:1,args:1,func:je.dateToTimestamp,position:"prefix",acceptAny:!0,description:"日期转时间戳"},">@":{precedence:0,args:1,func:je.formatDate,position:"postfix",acceptAny:!0,description:"时间戳可视化成日期"},">#":{precedence:0,args:1,func:je.formatDateStamp,position:"postfix",acceptAny:!0,description:"时间差可视化"},">#w":{precedence:0,args:1,func:je.formatDateStamp2Week,position:"postfix",acceptAny:!0,description:"时间差转成周数"},">#W":{alias:">#w",description:"时间差转成周数"},">#d":{precedence:0,args:1,func:je.formatDateStamp2Day,position:"postfix",acceptAny:!0,description:"时间差转成天数"},">#D":{alias:">#d",description:"时间差转成天数"},">#h":{precedence:0,args:1,func:je.formatDateStamp2Hour,position:"postfix",acceptAny:!0,description:"时间差转成小时数"},">#H":{alias:">#h",description:"时间差转成小时数"},">#m":{precedence:0,args:1,func:je.formatDateStamp2Minute,position:"postfix",acceptAny:!0,description:"时间差转成分钟数"},">#M":{alias:">#m",description:"时间差转成分钟数"},">#s":{precedence:0,args:1,func:je.formatDateStamp2Second,position:"postfix",acceptAny:!0,description:"时间差转成秒数"},">#S":{alias:">#s",description:"时间差转成秒数"}},We={str:{func:e=>e.toString(),args:1,acceptAny:!0,description:"转换为字符串"},num:{func:e=>e,args:1,description:"转换为数字"},max:{func:Math.max,args:-1,description:"求最大值"},min:{func:Math.min,args:-1,description:"求最小值"},lg:{func:e=>He.log10(e),args:1,description:"以10为底的对数"},lb:{func:e=>He.log2(e),args:1,description:"以2为底的对数"},log:{func:(e,t)=>He.log(t,e),args:2,description:"以x为底的y对数"},ln:{func:e=>He.ln(e),args:1,description:"自然对数"},exp:{func:e=>He.exp(e),args:1,description:"e的指数"},sin:{func:e=>He.sin(e),args:1,description:"正弦函数"},cos:{func:e=>He.cos(e),args:1,description:"余弦函数"},tan:{func:e=>He.tan(e),args:1,description:"正切函数"},asin:{func:e=>He.asin(e),args:1,repr:e=>"弧度: "+je.radianToPi(e)+" | 角度: "+je.radianToDeg(e).toFixed(3)+"°",description:"反正弦函数"},acos:{func:e=>He.acos(e),args:1,repr:e=>"弧度: "+je.radianToPi(e)+" | 角度: "+je.radianToDeg(e).toFixed(3)+"°",description:"反余弦函数"},atan:{func:e=>He.atan(e),args:1,repr:e=>"弧度: "+je.radianToPi(e)+" | 角度: "+je.radianToDeg(e).toFixed(3)+"°",description:"反正切函数"},sinh:{func:e=>He.sinh(e),args:1,description:"双曲正弦"},cosh:{func:e=>He.cosh(e),args:1,description:"双曲余弦"},tanh:{func:e=>He.tanh(e),args:1,description:"双曲正切"},sqrt:{func:e=>e.sqrt(),args:1,description:"平方根"},pow:{func:(e,t)=>e.pow(t),args:2,description:"幂函数"},abs:{args:1,func:e=>e.abs(),asProperty:!0,description:"绝对值"},rad:{args:1,func:e=>e.times(qe.pi).div(180),asProperty:!0,preventSelfReference:!0,repr:e=>"弧度: "+je.radianToPi(e)+" | 角度: "+je.radianToDeg(e).toFixed(3)+"°",description:"度数转换为弧度"},deg:{args:1,func:je.radianToDeg,asProperty:!0,preventSelfReference:!0,repr:e=>"角度: "+je.toFixed(e,3)+"°",description:"弧度转换为度数"},upper:{args:1,func:e=>e.toUpperCase(),acceptAny:!0,asProperty:!0,description:"转换为大写"},lower:{args:1,func:e=>e.toLowerCase(),acceptAny:!0,asProperty:!0,description:"转换为小写"},length:{args:1,func:e=>e.length,acceptAny:!0,asProperty:!0,description:"字符串长度"},bin:{args:1,func:e=>"0b"+BigInt(e).toString(2),asProperty:!0,description:"十进制转二进制"},oct:{args:1,func:e=>"0o"+BigInt(e).toString(8),asProperty:!0,description:"十进制转八进制"},hex:{args:1,func:e=>"0x"+BigInt(e).toString(16),asProperty:!0,description:"十进制转十六进制"},base64:{args:1,func:e=>{try{return"string"!=typeof e&&(e=String(e)),btoa(e)}catch(e){throw new Error("Base64编码失败: "+e.message)}},description:"Base64编码",acceptAny:!0,asProperty:!0},unbase64:{args:1,func:e=>{try{return"string"!=typeof e&&(e=String(e)),atob(e)}catch(e){throw new Error("Base64解码失败: "+e.message)}},description:"Base64解码",acceptAny:!0,asProperty:!0},timestamp:{args:8,func:(e=0,t=0,n=0,r=0,i=0,s=0,o=0,c=0)=>{const a=Number(e),u=Number(t);if(!Number.isInteger(a)||!Number.isInteger(u))throw new Error(`年:${a} 月:${u} 必须是整数`);return new Ce(a,u,1e3*(60*(60*(24*(7*n+r)+i)+s)+o)+c)},description:"时间间隔转换为时间戳"}},Ve=new Map;function Ke(e,t){const n=new Date;let r;switch(t){case"now":r=n;break;case"today":r=new Date(n.getFullYear(),n.getMonth(),n.getDate());break;case"YYYY-MM-DD HH:mm:ss":r=new Date(e);break;case"YYYY-MM-DD HH:mm":r=new Date(e+":00");break;case"YYYY-MM-DD":r=new Date(e+"T00:00:00");break;case"MM-DD HH:mm:ss":e=e.replace(/^(\d{1,2})-(\d{1,2})/,((e,t,n)=>`${t.padStart(2,"0")}-${n.padStart(2,"0")}`)),r=new Date(n.getFullYear()+"-"+e);break;case"MM-DD HH:mm":e=e.replace(/^(\d{1,2})-(\d{1,2})/,((e,t,n)=>`${t.padStart(2,"0")}-${n.padStart(2,"0")}`)),r=new Date(n.getFullYear()+"-"+e+":00");break;case"YYYY-MM":r=new Date(e+"-01T00:00:00");break;case"MM-DD":e=e.replace(/(\d{1,2})-(\d{1,2})/,((e,t,n)=>`${t.padStart(2,"0")}-${n.padStart(2,"0")}`)),r=new Date(n.getFullYear()+"-"+e+"T00:00:00");break;case"YYYY":r=new Date(e+"-01-01T00:00:00");break;case"HH:mm:ss":{const[t,n,i]=e.split(":").map(Number);return r=new Date(0),r.setUTCHours(t,n,i),new Ce(0,0,r.getTime())}case"HH:mm":{const[t,n]=e.split(":").map(Number);return r=new Date(0),r.setUTCHours(t,n,0),new Ce(0,0,r.getTime())}default:return null}return isNaN(r.getTime())?null:r}const ze=function(){const e=100,t=new Map,n=[],r=[];function i(e){n.includes(e)||n.push(e)}function s(e){r.includes(e)||r.push(e)}function o(){n.length=0,r.length=0}function c(n,r,s,o){const c=function(e){const t={"（":"(","）":")","，":",","”":'"',"’":"'","【":"[","】":"]","《":"<","》":">","＋":"+","－":"-","＝":"=","÷":"/","。":".","［":"[","］":"]","｛":"{","｝":"}","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9","０":"0"},n=new RegExp(Object.keys(t).join("|"),"g");return e.replace(n,(e=>t[e]||e))}(n);c!==n&&i(`格式化: "${c}"`),n=c,Ve.clear(),n=(n=function(e){let t=0,n=e.replace(/str\s*\(((?:[^)(]|\([^)(]*\))*)\)/g,((e,n)=>{const r="_cc_str_i"+t++;return Ve.set(r,n.trim()),r}));if(n=n.replace(/(['"`])((?:\\.|[^\\])*?)\1/g,((e,n,r)=>{const i="_cc_str_i"+t++,s=r.replace(/\\(['"\\`])/g,"$1");return Ve.set(i,s),i})),/['"`][^'"`]*$/.test(n))throw new Error("未闭合的字符串字面量");return n}(n=function(e){function t(e){const t=["years?","y","months?","m","weeks?","w","days?","d","hours?","h","minutes?","mm","seconds?","s","milliseconds?","ms"].join("|"),n=new RegExp(`([+-]?\\d+\\.?\\d*)(${t})`,"gi");return e.replace(n,"($1)$2")}function n(e){if(""===e.trim())return e;const t={years:["y","year","years"],months:["m","month","months"],weeks:["w","week","weeks"],days:["d","day","days"],hours:["h","hour","hours"],minutes:["mm","minute","minutes"],seconds:["s","second","seconds"],milliseconds:["ms","millisecond","milliseconds"]},n="START",r="EXPECT_OPEN",i="IN_BRACKETS",s="EXPECT_UNIT",o="END";let c=n,a=0,u="",f=0,p={years:"0",months:"0",weeks:"0",days:"0",hours:"0",minutes:"0",seconds:"0",milliseconds:"0"},d=Object.keys(t),l=0;const h={y:["years","year","y"],m:["milliseconds","millisecond","minutes","months","minute","month","mins","min","mm","ms","m"],w:["weeks","week","w"],d:["days","day","d"],h:["hours","hour","h"],s:["seconds","second","s"]};for(;a<e.length&&c!==o;){const g=e[a];switch(c){case n:if("("===g)c=i,f=1,u="";else if(g.trim())throw h[g]?new Error(`时间单位:${e.slice(a,a+5)+"..."} 没有值`):new Error("时间值必须在括号内");break;case r:"("===g?(c=i,f=1,u=""):g.trim()&&"+"!==g&&"-"!==g&&(0===l&&(l=a),c=o);break;case i:if("("===g)f++,u+=g;else if(")"===g)if(f--,0===f){if(!u.trim())throw new Error("括号内不能为空");c=s}else u+=g;else u+=g;break;case s:let m=a,w={length:0,unitKey:"",value:u,endPos:a};const v=e[a].toLowerCase();if(h[v]){const n=h[v];for(const r of n)if(e.slice(a,a+r.length).toLowerCase()===r){let e;for(const[n,i]of Object.entries(t))if(i.includes(r)){if("0"!==p[n])throw new Error(`时间单位:${n} 重复赋值`);e=n;break}if(e){w={length:r.length,unitKey:e,value:u,endPos:a+r.length-1},a+=r.length-1;break}}}w.length>0?(p[w.unitKey]=w.value,a=w.endPos,l=a+1,d.indexOf(w.unitKey),c=r):(a=m,c=r)}a++}let g=`timestamp(${[p.years||"0",p.months||"0",p.weeks||"0",p.days||"0",p.hours||"0",p.minutes||"0",p.seconds||"0",p.milliseconds||"0"].join(", ")})`;if(l<e.length){const t=e.substring(l).trim();t&&(g+=" "+t)}return g}const r=(e=e.replace(/>\s*#/g,">timestamp")).split("#");let i=r[0];for(let e=1;e<r.length;e++)i+=n(t(r[e]));return i=i.replace(/>timestamp/g,">#"),i}(n=function(e){let t=0;const n=[{regex:/(@)\s*(\d{4})-(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2}):(\d{1,2})/,format:"YYYY-MM-DD HH:mm:ss",extract:e=>`${e[2]}-${e[3].padStart(2,"0")}-${e[4].padStart(2,"0")} ${e[5]}:${e[6]}:${e[7]}`},{regex:/(@)\s*(\d{4})-(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2})/,format:"YYYY-MM-DD HH:mm",extract:e=>`${e[2]}-${e[3].padStart(2,"0")}-${e[4].padStart(2,"0")} ${e[5]}:${e[6]}`},{regex:/(@)\s*(\d{4})-(\d{1,2})-(\d{1,2})/,format:"YYYY-MM-DD",extract:e=>`${e[2]}-${e[3].padStart(2,"0")}-${e[4].padStart(2,"0")}`},{regex:/(@)\s*(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2}):(\d{1,2})/,format:"MM-DD HH:mm:ss",extract:e=>`${e[2].padStart(2,"0")}-${e[3].padStart(2,"0")} ${e[4]}:${e[5]}:${e[6]}`},{regex:/(@)\s*(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2})/,format:"MM-DD HH:mm",extract:e=>`${e[2].padStart(2,"0")}-${e[3].padStart(2,"0")} ${e[4]}:${e[5]}`},{regex:/(@)\s*(\d{4})-(\d{1,2})/,format:"YYYY-MM",extract:e=>`${e[2]}-${e[3].padStart(2,"0")}`},{regex:/(#)\s*(\d{1,2}):(\d{1,2}):(\d{1,2})/,format:"HH:mm:ss",extract:e=>`${e[2].padStart(2,"0")}:${e[3].padStart(2,"0")}:${e[4].padStart(2,"0")}`},{regex:/(#)\s*(\d{1,2}):(\d{1,2})/,format:"HH:mm",extract:e=>`${e[2].padStart(2,"0")}:${e[3].padStart(2,"0")}`},{regex:/(@)\s*(\d{1,2})-(\d{1,2})/,format:"MM-DD",extract:e=>`${e[2].padStart(2,"0")}-${e[3].padStart(2,"0")}`},{regex:/(@)\s*(\d{4})/,format:"YYYY",extract:e=>e[2]},{regex:/(@)\s*(now)/,format:"now",extract:e=>e[2]},{regex:/(@)\s*(today)/,format:"today",extract:e=>e[2]}];let r;do{r=e;for(const{regex:r,format:i,extract:s}of n){const n=r.exec(e);if(n){const r=Ke(s(n),i);if(r){const i="_cc_date_i"+t++;Ve.set(i,r),e=e.substring(0,n.index)+i+e.substring(n.index+n[0].length);break}}}}while(e!==r);return e}(n)))).replace(/\s/g,"");for(const[e,n]of Ve)t.set(e,n);!function(e,t=1e3){const n=e.replace(/'[^']*'|"[^"]*"/g,""),r=[];let i=0;for(let e=0;e<n.length;e++)if("("===n[e]){if(r.push(e),i=Math.max(i,r.length),i>t)throw new Error("括号嵌套深度过大")}else if(")"===n[e]){if(0===r.length)throw new Error(`多余的右括号，位置: ${e}`);const t=r.pop();if(e-t>1e3)throw new Error(`括号内容过长，开始位置: ${t}`)}if(r.length>0){const e=r.join(", ");throw new Error(`缺少右括号，对应左括号位置: ${e}`)}const s=[{pattern:/\)[\w\d]/,message:"右括号后直接跟标识符"},{pattern:/\)\(/,message:"右括号后直接跟左括号"},{pattern:/,\s*\)/,message:"逗号后直接跟右括号"},{pattern:/\(\s*,/,message:"左括号后直接跟逗号"},{pattern:/\(\s*\)(?!\s*[.,)\]}])/,message:"独立的空括号对"}];for(const{pattern:e,message:t}of s)if(e.test(n))throw new Error(`括号使用错误: ${t}`)}(n,e);for(const[e,t]of Object.entries(We))t.asProperty&&(r.add("."+e),Le["."+e]={precedence:8,args:1,func:t.func,position:"postfix",...t.acceptAny&&{acceptAny:!0},...t.repr&&{repr:t.repr},...t.preventSelfReference&&{preventSelfReference:t.preventSelfReference}});return{expr:n,operators:new Set([...r].sort(((e,t)=>t.length-e.length)))}}function a(e,n,r,s){function o(){if(0===a.length)return!0;const[e,t]=a[a.length-1];return"%"!==t&&"‰"!==t&&!("string"===e||"constant"===e||"delimiter"===e&&")"===t||"function"===e||"identifier"===e||"operator"===e&&t.startsWith("."))}function c(){let t="";for(;u<e.length;){const n=e[u],i=t+n;if("0"===t&&("x"===n||"b"===n||"o"===n)){t+=n,u++;continue}if(/^\d+\.?\d*$/.test(t)&&("e"===n||"E"===n)){for(t+=n,u++,u<e.length&&("+"===e[u]||"-"===e[u])&&(t+=e[u],u++);u<e.length&&/\d/.test(e[u]);)t+=e[u],u++;continue}if(f.has(n)||p.has(n))break;const o=d.some((t=>e.startsWith(t,u))),c=[...r,...s].some((e=>e.startsWith(i)));if(o&&!c)break;t+=n,u++}return t}const a=[];let u=0;const f=new Set(Object.keys(Be)),p=new Set(Object.keys(Ue)),d=[...n].sort(((e,t)=>t.length-e.length));for(;u<e.length;){const t=e[u],n=e.slice(u);let i=!1;for(const e of d)if(n.startsWith(e)){("="===e||Le[e].isCompoundAssignment)&&a.length>0&&"string"===a[a.length-1][0]&&(a[a.length-1][0]="identifier"),"+"===e?o()?a.push(["operator","unary+"]):a.push(["operator","+"]):"-"===e?o()?a.push(["operator","unary-"]):a.push(["operator","-"]):"%"===e?a.push(["operator","%"]):p.has(e)?a.push(["separator",e]):f.has(e)?a.push(["delimiter",e]):Le[e]&&Le[e].alias?a.push(["operator",Le[e].alias]):a.push(["operator",e]),u+=e.length,i=!0;break}if(!i)if(p.has(t))a.push(["separator",t]),u++;else if(f.has(t))a.push(["delimiter",t]),u++;else{const e=c();e&&(r.has(e)?We[e]&&We[e].alias?a.push(["function",We[e].alias]):a.push(["function",e]):s.has(e)?a.push(["constant",e]):a.push(["string",e]))}}const l=function(e){if(!e.some((e=>("identifier"===e[0]||"string"===e[0])&&"x"===e[1]))&&!t.has("x"))for(let n=0;n<e.length;n++)if("string"===e[n][0]){if(e[n][1].startsWith("0x"))continue;if(t.has(e[n][1]))continue;const r=e[n][1].split("x");if(r.length>1){const t=[];for(let e=0;e<r.length;e++)r[e]&&(s.has(r[e])?t.push(["constant",r[e]]):t.push(["string",r[e]])),e<r.length-1&&(t.push(["operator","*"]),i("使用x作为乘法符号"));e.splice(n,1,...t),n+=t.length-1}}return e}(a);return l}function u(t,n,r){let i=0,s=0;const o=t.filter((e=>{const[t]=e;return"delimiter"!==t&&"separator"!==t})).length;let c=0;function a(){if(s>e)throw new Error("表达式嵌套深度过大，可能存在无限递归")}function u(e,t,n){return c++,{value:e,args:t,type:n}}function f(){if(i>=t.length)throw new Error("意外的表达式结束");const[e,n]=t[i];switch(i++,e){case"function":return function(e){p("(");const n=[];for(;i<t.length&&("delimiter"!==t[i][0]||")"!==t[i][1]);)n.push(d(0)),"separator"===t[i][0]&&i++;return p(")"),u(e,n,"function")}(n);case"constant":case"identifier":case"string":return u(n,[],e);case"delimiter":if("("===n){const e=d(0);return p(")"),e}throw new Error(`意外的定界符: ${n}`);default:throw new Error(`意外的token类型: ${e}`)}}function p(e){if(i>=t.length||"delimiter"!==t[i][0]||t[i][1]!==e)throw new Error(`期望定界符 "${e}"`);i++}function d(e=0){s++,a();let n=function(){if(s++,a(),i>=t.length)throw new Error("意外的表达式结束");const[e,n]=t[i];if("operator"===e&&Le[n]&&"prefix"===Le[n].position){i++;const e=d(Le[n].precedence);return s--,u(n,[e],"operator")}return s--,f()}(e);for(;i<t.length;){const[r,s]=t[i];if("operator"===r&&"%"===s){const e=t[i+1],r=e&&("string"===e[0]||"constant"===e[0]||"function"===e[0]||"delimiter"===e[0]&&"("===e[1]);if(i++,r){n=u("%",[n,d(Le["%"].precedence+1)],"operator")}else n=u("unary%",[n],"operator");continue}if("operator"===r&&Le[s]&&"postfix"===Le[s].position){if(Le[s].precedence<e)break;i++,n=u(s,[n],"operator");continue}if("operator"!==r||!Le[s]||Le[s].precedence<e||"infix"!==Le[s].position)break;i++;const o=Le[s];n=u(s,[n,d(o.isCompoundAssignment?o.precedence:o.precedence+1)],"operator")}return s--,n}const l=d();if(c<o)throw new Error(`解析错误：AST节点不全(${c} < ${o})`);return function t(n,r=0){if(r>e)throw new Error("自引用检查嵌套深度过大，可能存在无限递归");if("function"===n.type){const e=n.value;if(We[e]&&We[e].preventSelfReference&&n.args.some((t=>"function"===t.type&&t.value===e)))throw new Error(`函数 ${e} 不能直接作用在自己身上`)}else if("operator"===n.type){const e=n.value;if(Le[e]&&Le[e].preventSelfReference&&n.args.some((t=>"operator"===t.type&&t.value===e)))throw new Error(`运算符 ${e} 不能直接作用在自己身上`)}n.args?.forEach((e=>t(e,r+1)))}(l),l}function f(e,t,n,r){return t?e:e.map((e=>je.toNumber(e)))}function p(n,r,o,c,a=0){if(a>e)throw new Error("表达式求值嵌套深度过大，可能存在无限递归");if(!n)return 0;if("string"===n.type)return t.has(n.value)?t.get(n.value):je.toNumber(n.value);if("identifier"===n.type)return t.has(n.value)?t.get(n.value):n.value;if("constant"===n.type)return Ze[n.value];const u=n.args.map((e=>p(e,r,o,c,a+1)));if("operator"===n.type){const e=Le[n.value];if(void 0!==e.args&&u.length!==e.args)throw new Error(`运算符 "${n.value}" 需要 ${e.args} 个参数，但得到了 ${u.length} 个`);if(e.isCompoundAssignment){const[u,f]=n.args;if("identifier"!==u.type&&"string"!==u.type)throw new Error("赋值运算符左侧必须是变量名");!function(e,t,n,r){if(!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(e)){if(/\s/.test(e))throw new Error(`变量名 "${e}" 不能包含空格`);throw new Error(`变量名 "${e}" 格式不正确，只能包含字母、数字和下划线，且不以数字开头`)}if(e.startsWith("_cc_"))throw new Error('变量名不能以 "_cc_" 开头，这是系统保留的前缀');if(t.hasOwnProperty(e))throw new Error(`变量名 "${e}" 与运算符冲突`);if(n.hasOwnProperty(e))throw new Error(`变量名 "${e}" 与函数名冲突`);if(r.hasOwnProperty(e))throw new Error(`变量名 "${e}" 与常量冲突`);if(["if","else","true","false","null","undefined"].includes(e))throw new Error(`变量名 "${e}" 是保留字`)}(u.value,r,o,c);const d=p(f,r,o,c,a+1);if("="===n.value)return t.set(u.value,d),s(`添加变量 ${u.value}: ${d}`),"x"===u.value&&i("将无法使用x做为乘法符号"),d;{if(!t.has(u.value))throw new Error(`变量 "${u.value}" 未定义`);const n=t.get(u.value),r=e.func(n,d);return t.set(u.value,r),r}}const d=f(u,e.acceptAny,n.args,n.value);return e.func(...d)}if("function"===n.type){const e=We[n.value];if(void 0!==e.args)if(-1===e.args){if(0===u.length)throw new Error(`函数 "${n.value}" 至少需要1个参数`)}else if(u.length!==e.args)throw new Error(`函数 "${n.value}" 需要 ${e.args} 个参数，但得到了 ${u.length} 个`);const t=f(u,e.acceptAny,n.args,n.value);return e.func(...t)}throw new Error(`未处理的节点类型: ${n.type}`)}return{calculate(e){o();const t=new Set(Object.keys(Le)),f=new Set(Object.keys(We)),d=new Set(Object.keys(Ze)),{expr:l,operators:h}=c(e,t),g=u(a(l,h,f,d)),m=function(e,t){if("object"==typeof(e=je.formatToDisplayString(e))&&null!==e&&(e.info&&s(e.info),e.warning&&i(e.warning),e=e.value),!t)return{value:e,info:r.length>0?r:null,warning:n.length>0?n:null};try{let i,o=t;if("operator"===o.type&&"="===o.value&&(o=o.args[1]),"function"===o.type&&We[o.value]?i=We[o.value].repr:"operator"===o.type&&Le[o.value]&&(i=Le[o.value].repr),"function"==typeof i)try{console.log("result: ",e);const t=i(e);console.log("formattedResult: ",t),void 0!==t&&s(t)}catch(e){throw new Error(`${e.message}`)}return{value:e,info:r.length>0?r:null,warning:n.length>0?n:null}}catch(t){return i(`格式化输出时发生错误: ${t.message}`),{value:e,info:r.length>0?r:null,warning:n.length>0?n:null}}}(p(g,t,f,d),g);return m},getASTNode(e){const t=new Set(Object.keys(Le)),n=new Set(Object.keys(We)),r=new Set(Object.keys(Ze)),{expr:i,operators:s}=c(e,t);return u(a(i,s,n,r))},getCfg:()=>({operators:new Set(Object.keys(Le)),functions:new Set(Object.keys(We)),constants:new Set(Object.keys(Ze))}),tokenize:(e,t,n,r)=>a(e,t,n,r),preprocess:(e,t,n,r)=>c(e,t),getAllVariables:()=>Object.fromEntries(t),clearAllCache(){t.clear(),o()}}}();export{Ze as CONSTANTS,ze as Calculator,We as FUNCTIONS,Le as OPERATORS};
