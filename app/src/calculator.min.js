/*!
 *  decimal.js v10.5.0
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */
var t,e,r=9e15,n=1e9,s="0123456789abcdef",o="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",i="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",a={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-9e15,maxE:r,crypto:!1},u=!0,h="[DecimalError] ",c=h+"Invalid argument: ",l=h+"Precision limit exceeded",f=h+"crypto unavailable",g="[object Decimal]",m=Math.floor,p=Math.pow,w=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,d=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,y=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,b=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,x=1e7,M=o.length-1,v=i.length-1,E={toStringTag:g};function S(t){var e,r,n,s=t.length-1,o="",i=t[0];if(s>0){for(o+=i,e=1;e<s;e++)(r=7-(n=t[e]+"").length)&&(o+=q(r)),o+=n;(r=7-(n=(i=t[e])+"").length)&&(o+=q(r))}else if(0===i)return"0";for(;i%10==0;)i/=10;return o+i}function N(t,e,r){if(t!==~~t||t<e||t>r)throw Error(c+t)}function T(t,e,r,n){var s,o,i,a;for(o=t[0];o>=10;o/=10)--e;return--e<0?(e+=7,s=0):(s=Math.ceil((e+1)/7),e%=7),o=p(10,7-e),a=t[s]%o|0,null==n?e<3?(0==e?a=a/100|0:1==e&&(a=a/10|0),i=r<4&&99999==a||r>3&&49999==a||5e4==a||0==a):i=(r<4&&a+1==o||r>3&&a+1==o/2)&&(t[s+1]/o/100|0)==p(10,e-2)-1||(a==o/2||0==a)&&!(t[s+1]/o/100|0):e<4?(0==e?a=a/1e3|0:1==e?a=a/100|0:2==e&&(a=a/10|0),i=(n||r<4)&&9999==a||!n&&r>3&&4999==a):i=((n||r<4)&&a+1==o||!n&&r>3&&a+1==o/2)&&(t[s+1]/o/1e3|0)==p(10,e-3)-1,i}function $(t,e,r){for(var n,o,i=[0],a=0,u=t.length;a<u;){for(o=i.length;o--;)i[o]*=e;for(i[0]+=s.indexOf(t.charAt(a++)),n=0;n<i.length;n++)i[n]>r-1&&(void 0===i[n+1]&&(i[n+1]=0),i[n+1]+=i[n]/r|0,i[n]%=r)}return i.reverse()}E.absoluteValue=E.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),R(t)},E.ceil=function(){return R(new this.constructor(this),this.e+1,2)},E.clampedTo=E.clamp=function(t,e){var r=this,n=r.constructor;if(t=new n(t),e=new n(e),!t.s||!e.s)return new n(NaN);if(t.gt(e))throw Error(c+e);return r.cmp(t)<0?t:r.cmp(e)>0?e:new n(r)},E.comparedTo=E.cmp=function(t){var e,r,n,s,o=this,i=o.d,a=(t=new o.constructor(t)).d,u=o.s,h=t.s;if(!i||!a)return u&&h?u!==h?u:i===a?0:!i^u<0?1:-1:NaN;if(!i[0]||!a[0])return i[0]?u:a[0]?-h:0;if(u!==h)return u;if(o.e!==t.e)return o.e>t.e^u<0?1:-1;for(e=0,r=(n=i.length)<(s=a.length)?n:s;e<r;++e)if(i[e]!==a[e])return i[e]>a[e]^u<0?1:-1;return n===s?0:n>s^u<0?1:-1},E.cosine=E.cos=function(){var t,r,n=this,s=n.constructor;return n.d?n.d[0]?(t=s.precision,r=s.rounding,s.precision=t+Math.max(n.e,n.sd())+7,s.rounding=1,n=function(t,e){var r,n,s;if(e.isZero())return e;n=e.d.length,n<32?s=(1/U(4,r=Math.ceil(n/3))).toString():(r=16,s="2.3283064365386962890625e-10");t.precision+=r,e=L(t,1,e.times(s),new t(1));for(var o=r;o--;){var i=e.times(e);e=i.times(i).minus(i).times(8).plus(1)}return t.precision-=r,e}(s,Z(s,n)),s.precision=t,s.rounding=r,R(2==e||3==e?n.neg():n,t,r,!0)):new s(1):new s(NaN)},E.cubeRoot=E.cbrt=function(){var t,e,r,n,s,o,i,a,h,c,l=this,f=l.constructor;if(!l.isFinite()||l.isZero())return new f(l);for(u=!1,(o=l.s*p(l.s*l,1/3))&&Math.abs(o)!=1/0?n=new f(o.toString()):(r=S(l.d),(o=((t=l.e)-r.length+1)%3)&&(r+=1==o||-2==o?"0":"00"),o=p(r,1/3),t=m((t+1)/3)-(t%3==(t<0?-1:2)),(n=new f(r=o==1/0?"5e"+t:(r=o.toExponential()).slice(0,r.indexOf("e")+1)+t)).s=l.s),i=(t=f.precision)+3;;)if(c=(h=(a=n).times(a).times(a)).plus(l),n=D(c.plus(l).times(a),c.plus(h),i+2,1),S(a.d).slice(0,i)===(r=S(n.d)).slice(0,i)){if("9999"!=(r=r.slice(i-3,i+1))&&(s||"4999"!=r)){+r&&(+r.slice(1)||"5"!=r.charAt(0))||(R(n,t+1,1),e=!n.times(n).times(n).eq(l));break}if(!s&&(R(a,t+1,0),a.times(a).times(a).eq(l))){n=a;break}i+=4,s=1}return u=!0,R(n,t,f.rounding,e)},E.decimalPlaces=E.dp=function(){var t,e=this.d,r=NaN;if(e){if(r=7*((t=e.length-1)-m(this.e/7)),t=e[t])for(;t%10==0;t/=10)r--;r<0&&(r=0)}return r},E.dividedBy=E.div=function(t){return D(this,new this.constructor(t))},E.dividedToIntegerBy=E.divToInt=function(t){var e=this.constructor;return R(D(this,new e(t),0,1,1),e.precision,e.rounding)},E.equals=E.eq=function(t){return 0===this.cmp(t)},E.floor=function(){return R(new this.constructor(this),this.e+1,3)},E.greaterThan=E.gt=function(t){return this.cmp(t)>0},E.greaterThanOrEqualTo=E.gte=function(t){var e=this.cmp(t);return 1==e||0===e},E.hyperbolicCosine=E.cosh=function(){var t,e,r,n,s,o=this,i=o.constructor,a=new i(1);if(!o.isFinite())return new i(o.s?1/0:NaN);if(o.isZero())return a;r=i.precision,n=i.rounding,i.precision=r+Math.max(o.e,o.sd())+4,i.rounding=1,(s=o.d.length)<32?e=(1/U(4,t=Math.ceil(s/3))).toString():(t=16,e="2.3283064365386962890625e-10"),o=L(i,1,o.times(e),new i(1),!0);for(var u,h=t,c=new i(8);h--;)u=o.times(o),o=a.minus(u.times(c.minus(u.times(c))));return R(o,i.precision=r,i.rounding=n,!0)},E.hyperbolicSine=E.sinh=function(){var t,e,r,n,s=this,o=s.constructor;if(!s.isFinite()||s.isZero())return new o(s);if(e=o.precision,r=o.rounding,o.precision=e+Math.max(s.e,s.sd())+4,o.rounding=1,(n=s.d.length)<3)s=L(o,2,s,s,!0);else{t=(t=1.4*Math.sqrt(n))>16?16:0|t,s=L(o,2,s=s.times(1/U(5,t)),s,!0);for(var i,a=new o(5),u=new o(16),h=new o(20);t--;)i=s.times(s),s=s.times(a.plus(i.times(u.times(i).plus(h))))}return o.precision=e,o.rounding=r,R(s,e,r,!0)},E.hyperbolicTangent=E.tanh=function(){var t,e,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+7,n.rounding=1,D(r.sinh(),r.cosh(),n.precision=t,n.rounding=e)):new n(r.s)},E.inverseCosine=E.acos=function(){var t=this,e=t.constructor,r=t.abs().cmp(1),n=e.precision,s=e.rounding;return-1!==r?0===r?t.isNeg()?F(e,n,s):new e(0):new e(NaN):t.isZero()?F(e,n+4,s).times(.5):(e.precision=n+6,e.rounding=1,t=new e(1).minus(t).div(t.plus(1)).sqrt().atan(),e.precision=n,e.rounding=s,t.times(2))},E.inverseHyperbolicCosine=E.acosh=function(){var t,e,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(t=n.precision,e=n.rounding,n.precision=t+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,u=!1,r=r.times(r).minus(1).sqrt().plus(r),u=!0,n.precision=t,n.rounding=e,r.ln()):new n(r)},E.inverseHyperbolicSine=E.asinh=function(){var t,e,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,u=!1,r=r.times(r).plus(1).sqrt().plus(r),u=!0,n.precision=t,n.rounding=e,r.ln())},E.inverseHyperbolicTangent=E.atanh=function(){var t,e,r,n,s=this,o=s.constructor;return s.isFinite()?s.e>=0?new o(s.abs().eq(1)?s.s/0:s.isZero()?s:NaN):(t=o.precision,e=o.rounding,n=s.sd(),Math.max(n,t)<2*-s.e-1?R(new o(s),t,e,!0):(o.precision=r=n-s.e,s=D(s.plus(1),new o(1).minus(s),r+t,1),o.precision=t+4,o.rounding=1,s=s.ln(),o.precision=t,o.rounding=e,s.times(.5))):new o(NaN)},E.inverseSine=E.asin=function(){var t,e,r,n,s=this,o=s.constructor;return s.isZero()?new o(s):(e=s.abs().cmp(1),r=o.precision,n=o.rounding,-1!==e?0===e?((t=F(o,r+4,n).times(.5)).s=s.s,t):new o(NaN):(o.precision=r+6,o.rounding=1,s=s.div(new o(1).minus(s.times(s)).sqrt().plus(1)).atan(),o.precision=r,o.rounding=n,s.times(2)))},E.inverseTangent=E.atan=function(){var t,e,r,n,s,o,i,a,h,c=this,l=c.constructor,f=l.precision,g=l.rounding;if(c.isFinite()){if(c.isZero())return new l(c);if(c.abs().eq(1)&&f+4<=v)return(i=F(l,f+4,g).times(.25)).s=c.s,i}else{if(!c.s)return new l(NaN);if(f+4<=v)return(i=F(l,f+4,g).times(.5)).s=c.s,i}for(l.precision=a=f+10,l.rounding=1,t=r=Math.min(28,a/7+2|0);t;--t)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(u=!1,e=Math.ceil(a/7),n=1,h=c.times(c),i=new l(c),s=c;-1!==t;)if(s=s.times(h),o=i.minus(s.div(n+=2)),s=s.times(h),void 0!==(i=o.plus(s.div(n+=2))).d[e])for(t=e;i.d[t]===o.d[t]&&t--;);return r&&(i=i.times(2<<r-1)),u=!0,R(i,l.precision=f,l.rounding=g,!0)},E.isFinite=function(){return!!this.d},E.isInteger=E.isInt=function(){return!!this.d&&m(this.e/7)>this.d.length-2},E.isNaN=function(){return!this.s},E.isNegative=E.isNeg=function(){return this.s<0},E.isPositive=E.isPos=function(){return this.s>0},E.isZero=function(){return!!this.d&&0===this.d[0]},E.lessThan=E.lt=function(t){return this.cmp(t)<0},E.lessThanOrEqualTo=E.lte=function(t){return this.cmp(t)<1},E.logarithm=E.log=function(t){var e,r,n,s,o,i,a,h,c=this,l=c.constructor,f=l.precision,g=l.rounding;if(null==t)t=new l(10),e=!0;else{if(r=(t=new l(t)).d,t.s<0||!r||!r[0]||t.eq(1))return new l(NaN);e=t.eq(10)}if(r=c.d,c.s<0||!r||!r[0]||c.eq(1))return new l(r&&!r[0]?-1/0:1!=c.s?NaN:r?0:1/0);if(e)if(r.length>1)o=!0;else{for(s=r[0];s%10==0;)s/=10;o=1!==s}if(u=!1,i=j(c,a=f+5),n=e?I(l,a+10):j(t,a),T((h=D(i,n,a,1)).d,s=f,g))do{if(i=j(c,a+=10),n=e?I(l,a+10):j(t,a),h=D(i,n,a,1),!o){+S(h.d).slice(s+1,s+15)+1==1e14&&(h=R(h,f+1,0));break}}while(T(h.d,s+=10,g));return u=!0,R(h,f,g)},E.minus=E.sub=function(t){var e,r,n,s,o,i,a,h,c,l,f,g,p=this,w=p.constructor;if(t=new w(t),!p.d||!t.d)return p.s&&t.s?p.d?t.s=-t.s:t=new w(t.d||p.s!==t.s?p:NaN):t=new w(NaN),t;if(p.s!=t.s)return t.s=-t.s,p.plus(t);if(c=p.d,g=t.d,a=w.precision,h=w.rounding,!c[0]||!g[0]){if(g[0])t.s=-t.s;else{if(!c[0])return new w(3===h?-0:0);t=new w(p)}return u?R(t,a,h):t}if(r=m(t.e/7),l=m(p.e/7),c=c.slice(),o=l-r){for((f=o<0)?(e=c,o=-o,i=g.length):(e=g,r=l,i=c.length),o>(n=Math.max(Math.ceil(a/7),i)+2)&&(o=n,e.length=1),e.reverse(),n=o;n--;)e.push(0);e.reverse()}else{for((f=(n=c.length)<(i=g.length))&&(i=n),n=0;n<i;n++)if(c[n]!=g[n]){f=c[n]<g[n];break}o=0}for(f&&(e=c,c=g,g=e,t.s=-t.s),i=c.length,n=g.length-i;n>0;--n)c[i++]=0;for(n=g.length;n>o;){if(c[--n]<g[n]){for(s=n;s&&0===c[--s];)c[s]=x-1;--c[s],c[n]+=x}c[n]-=g[n]}for(;0===c[--i];)c.pop();for(;0===c[0];c.shift())--r;return c[0]?(t.d=c,t.e=k(c,r),u?R(t,a,h):t):new w(3===h?-0:0)},E.modulo=E.mod=function(t){var e,r=this,n=r.constructor;return t=new n(t),!r.d||!t.s||t.d&&!t.d[0]?new n(NaN):!t.d||r.d&&!r.d[0]?R(new n(r),n.precision,n.rounding):(u=!1,9==n.modulo?(e=D(r,t.abs(),0,3,1)).s*=t.s:e=D(r,t,0,n.modulo,1),e=e.times(t),u=!0,r.minus(e))},E.naturalExponential=E.exp=function(){return V(this)},E.naturalLogarithm=E.ln=function(){return j(this)},E.negated=E.neg=function(){var t=new this.constructor(this);return t.s=-t.s,R(t)},E.plus=E.add=function(t){var e,r,n,s,o,i,a,h,c,l,f=this,g=f.constructor;if(t=new g(t),!f.d||!t.d)return f.s&&t.s?f.d||(t=new g(t.d||f.s===t.s?f:NaN)):t=new g(NaN),t;if(f.s!=t.s)return t.s=-t.s,f.minus(t);if(c=f.d,l=t.d,a=g.precision,h=g.rounding,!c[0]||!l[0])return l[0]||(t=new g(f)),u?R(t,a,h):t;if(o=m(f.e/7),n=m(t.e/7),c=c.slice(),s=o-n){for(s<0?(r=c,s=-s,i=l.length):(r=l,n=o,i=c.length),s>(i=(o=Math.ceil(a/7))>i?o+1:i+1)&&(s=i,r.length=1),r.reverse();s--;)r.push(0);r.reverse()}for((i=c.length)-(s=l.length)<0&&(s=i,r=l,l=c,c=r),e=0;s;)e=(c[--s]=c[s]+l[s]+e)/x|0,c[s]%=x;for(e&&(c.unshift(e),++n),i=c.length;0==c[--i];)c.pop();return t.d=c,t.e=k(c,n),u?R(t,a,h):t},E.precision=E.sd=function(t){var e,r=this;if(void 0!==t&&t!==!!t&&1!==t&&0!==t)throw Error(c+t);return r.d?(e=C(r.d),t&&r.e+1>e&&(e=r.e+1)):e=NaN,e},E.round=function(){var t=this,e=t.constructor;return R(new e(t),t.e+1,e.rounding)},E.sine=E.sin=function(){var t,r,n=this,s=n.constructor;return n.isFinite()?n.isZero()?new s(n):(t=s.precision,r=s.rounding,s.precision=t+Math.max(n.e,n.sd())+7,s.rounding=1,n=function(t,e){var r,n=e.d.length;if(n<3)return e.isZero()?e:L(t,2,e,e);r=(r=1.4*Math.sqrt(n))>16?16:0|r,e=e.times(1/U(5,r)),e=L(t,2,e,e);for(var s,o=new t(5),i=new t(16),a=new t(20);r--;)s=e.times(e),e=e.times(o.plus(s.times(i.times(s).minus(a))));return e}(s,Z(s,n)),s.precision=t,s.rounding=r,R(e>2?n.neg():n,t,r,!0)):new s(NaN)},E.squareRoot=E.sqrt=function(){var t,e,r,n,s,o,i=this,a=i.d,h=i.e,c=i.s,l=i.constructor;if(1!==c||!a||!a[0])return new l(!c||c<0&&(!a||a[0])?NaN:a?i:1/0);for(u=!1,0==(c=Math.sqrt(+i))||c==1/0?(((e=S(a)).length+h)%2==0&&(e+="0"),c=Math.sqrt(e),h=m((h+1)/2)-(h<0||h%2),n=new l(e=c==1/0?"5e"+h:(e=c.toExponential()).slice(0,e.indexOf("e")+1)+h)):n=new l(c.toString()),r=(h=l.precision)+3;;)if(n=(o=n).plus(D(i,o,r+2,1)).times(.5),S(o.d).slice(0,r)===(e=S(n.d)).slice(0,r)){if("9999"!=(e=e.slice(r-3,r+1))&&(s||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(R(n,h+1,1),t=!n.times(n).eq(i));break}if(!s&&(R(o,h+1,0),o.times(o).eq(i))){n=o;break}r+=4,s=1}return u=!0,R(n,h,l.rounding,t)},E.tangent=E.tan=function(){var t,r,n=this,s=n.constructor;return n.isFinite()?n.isZero()?new s(n):(t=s.precision,r=s.rounding,s.precision=t+10,s.rounding=1,(n=n.sin()).s=1,n=D(n,new s(1).minus(n.times(n)).sqrt(),t+10,0),s.precision=t,s.rounding=r,R(2==e||4==e?n.neg():n,t,r,!0)):new s(NaN)},E.times=E.mul=function(t){var e,r,n,s,o,i,a,h,c,l=this,f=l.constructor,g=l.d,p=(t=new f(t)).d;if(t.s*=l.s,!(g&&g[0]&&p&&p[0]))return new f(!t.s||g&&!g[0]&&!p||p&&!p[0]&&!g?NaN:g&&p?0*t.s:t.s/0);for(r=m(l.e/7)+m(t.e/7),(h=g.length)<(c=p.length)&&(o=g,g=p,p=o,i=h,h=c,c=i),o=[],n=i=h+c;n--;)o.push(0);for(n=c;--n>=0;){for(e=0,s=h+n;s>n;)a=o[s]+p[n]*g[s-n-1]+e,o[s--]=a%x|0,e=a/x|0;o[s]=(o[s]+e)%x|0}for(;!o[--i];)o.pop();return e?++r:o.shift(),t.d=o,t.e=k(o,r),u?R(t,f.precision,f.rounding):t},E.toBinary=function(t,e){return B(this,2,t,e)},E.toDecimalPlaces=E.toDP=function(t,e){var r=this,s=r.constructor;return r=new s(r),void 0===t?r:(N(t,0,n),void 0===e?e=s.rounding:N(e,0,8),R(r,t+r.e+1,e))},E.toExponential=function(t,e){var r,s=this,o=s.constructor;return void 0===t?r=A(s,!0):(N(t,0,n),void 0===e?e=o.rounding:N(e,0,8),r=A(s=R(new o(s),t+1,e),!0,t+1)),s.isNeg()&&!s.isZero()?"-"+r:r},E.toFixed=function(t,e){var r,s,o=this,i=o.constructor;return void 0===t?r=A(o):(N(t,0,n),void 0===e?e=i.rounding:N(e,0,8),r=A(s=R(new i(o),t+o.e+1,e),!1,t+s.e+1)),o.isNeg()&&!o.isZero()?"-"+r:r},E.toFraction=function(t){var e,r,n,s,o,i,a,h,l,f,g,m,w=this,d=w.d,y=w.constructor;if(!d)return new y(w);if(l=r=new y(1),n=h=new y(0),i=(o=(e=new y(n)).e=C(d)-w.e-1)%7,e.d[0]=p(10,i<0?7+i:i),null==t)t=o>0?e:l;else{if(!(a=new y(t)).isInt()||a.lt(l))throw Error(c+a);t=a.gt(e)?o>0?e:l:a}for(u=!1,a=new y(S(d)),f=y.precision,y.precision=o=7*d.length*2;g=D(a,e,0,1,1),1!=(s=r.plus(g.times(n))).cmp(t);)r=n,n=s,s=l,l=h.plus(g.times(s)),h=s,s=e,e=a.minus(g.times(s)),a=s;return s=D(t.minus(r),n,0,1,1),h=h.plus(s.times(l)),r=r.plus(s.times(n)),h.s=l.s=w.s,m=D(l,n,o,1).minus(w).abs().cmp(D(h,r,o,1).minus(w).abs())<1?[l,n]:[h,r],y.precision=f,u=!0,m},E.toHexadecimal=E.toHex=function(t,e){return B(this,16,t,e)},E.toNearest=function(t,e){var r=this,n=r.constructor;if(r=new n(r),null==t){if(!r.d)return r;t=new n(1),e=n.rounding}else{if(t=new n(t),void 0===e?e=n.rounding:N(e,0,8),!r.d)return t.s?r:t;if(!t.d)return t.s&&(t.s=r.s),t}return t.d[0]?(u=!1,r=D(r,t,0,e,1).times(t),u=!0,R(r)):(t.s=r.s,r=t),r},E.toNumber=function(){return+this},E.toOctal=function(t,e){return B(this,8,t,e)},E.toPower=E.pow=function(t){var e,r,n,s,o,i,a=this,h=a.constructor,c=+(t=new h(t));if(!(a.d&&t.d&&a.d[0]&&t.d[0]))return new h(p(+a,c));if((a=new h(a)).eq(1))return a;if(n=h.precision,o=h.rounding,t.eq(1))return R(a,n,o);if((e=m(t.e/7))>=t.d.length-1&&(r=c<0?-c:c)<=9007199254740991)return s=P(h,a,r,n),t.s<0?new h(1).div(s):R(s,n,o);if((i=a.s)<0){if(e<t.d.length-1)return new h(NaN);if(1&t.d[e]||(i=1),0==a.e&&1==a.d[0]&&1==a.d.length)return a.s=i,a}return(e=0!=(r=p(+a,c))&&isFinite(r)?new h(r+"").e:m(c*(Math.log("0."+S(a.d))/Math.LN10+a.e+1)))>h.maxE+1||e<h.minE-1?new h(e>0?i/0:0):(u=!1,h.rounding=a.s=1,r=Math.min(12,(e+"").length),(s=V(t.times(j(a,n+r)),n)).d&&T((s=R(s,n+5,1)).d,n,o)&&(e=n+10,+S((s=R(V(t.times(j(a,e+r)),e),e+5,1)).d).slice(n+1,n+15)+1==1e14&&(s=R(s,n+1,0))),s.s=i,u=!0,h.rounding=o,R(s,n,o))},E.toPrecision=function(t,e){var r,s=this,o=s.constructor;return void 0===t?r=A(s,s.e<=o.toExpNeg||s.e>=o.toExpPos):(N(t,1,n),void 0===e?e=o.rounding:N(e,0,8),r=A(s=R(new o(s),t,e),t<=s.e||s.e<=o.toExpNeg,t)),s.isNeg()&&!s.isZero()?"-"+r:r},E.toSignificantDigits=E.toSD=function(t,e){var r=this.constructor;return void 0===t?(t=r.precision,e=r.rounding):(N(t,1,n),void 0===e?e=r.rounding:N(e,0,8)),R(new r(this),t,e)},E.toString=function(){var t=this,e=t.constructor,r=A(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+r:r},E.truncated=E.trunc=function(){return R(new this.constructor(this),this.e+1,1)},E.valueOf=E.toJSON=function(){var t=this,e=t.constructor,r=A(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+r:r};var D=function(){function e(t,e,r){var n,s=0,o=t.length;for(t=t.slice();o--;)n=t[o]*e+s,t[o]=n%r|0,s=n/r|0;return s&&t.unshift(s),t}function r(t,e,r,n){var s,o;if(r!=n)o=r>n?1:-1;else for(s=o=0;s<r;s++)if(t[s]!=e[s]){o=t[s]>e[s]?1:-1;break}return o}function n(t,e,r,n){for(var s=0;r--;)t[r]-=s,s=t[r]<e[r]?1:0,t[r]=s*n+t[r]-e[r];for(;!t[0]&&t.length>1;)t.shift()}return function(s,o,i,a,u,h){var c,l,f,g,p,w,d,y,b,M,v,E,S,N,T,$,D,A,k,I,F=s.constructor,C=s.s==o.s?1:-1,q=s.d,P=o.d;if(!(q&&q[0]&&P&&P[0]))return new F(s.s&&o.s&&(q?!P||q[0]!=P[0]:P)?q&&0==q[0]||!P?0*C:C/0:NaN);for(h?(p=1,l=s.e-o.e):(h=x,p=7,l=m(s.e/p)-m(o.e/p)),k=P.length,D=q.length,M=(b=new F(C)).d=[],f=0;P[f]==(q[f]||0);f++);if(P[f]>(q[f]||0)&&l--,null==i?(N=i=F.precision,a=F.rounding):N=u?i+(s.e-o.e)+1:i,N<0)M.push(1),w=!0;else{if(N=N/p+2|0,f=0,1==k){for(g=0,P=P[0],N++;(f<D||g)&&N--;f++)T=g*h+(q[f]||0),M[f]=T/P|0,g=T%P|0;w=g||f<D}else{for((g=h/(P[0]+1)|0)>1&&(P=e(P,g,h),q=e(q,g,h),k=P.length,D=q.length),$=k,E=(v=q.slice(0,k)).length;E<k;)v[E++]=0;(I=P.slice()).unshift(0),A=P[0],P[1]>=h/2&&++A;do{g=0,(c=r(P,v,k,E))<0?(S=v[0],k!=E&&(S=S*h+(v[1]||0)),(g=S/A|0)>1?(g>=h&&(g=h-1),1==(c=r(d=e(P,g,h),v,y=d.length,E=v.length))&&(g--,n(d,k<y?I:P,y,h))):(0==g&&(c=g=1),d=P.slice()),(y=d.length)<E&&d.unshift(0),n(v,d,E,h),-1==c&&(c=r(P,v,k,E=v.length))<1&&(g++,n(v,k<E?I:P,E,h)),E=v.length):0===c&&(g++,v=[0]),M[f++]=g,c&&v[0]?v[E++]=q[$]||0:(v=[q[$]],E=1)}while(($++<D||void 0!==v[0])&&N--);w=void 0!==v[0]}M[0]||M.shift()}if(1==p)b.e=l,t=w;else{for(f=1,g=M[0];g>=10;g/=10)f++;b.e=f+l*p-1,R(b,u?i+b.e+1:i,a,w)}return b}}();function R(t,e,r,n){var s,o,i,a,h,c,l,f,g,m=t.constructor;t:if(null!=e){if(!(f=t.d))return t;for(s=1,a=f[0];a>=10;a/=10)s++;if((o=e-s)<0)o+=7,i=e,h=(l=f[g=0])/p(10,s-i-1)%10|0;else if((g=Math.ceil((o+1)/7))>=(a=f.length)){if(!n)break t;for(;a++<=g;)f.push(0);l=h=0,s=1,i=(o%=7)-7+1}else{for(l=a=f[g],s=1;a>=10;a/=10)s++;h=(i=(o%=7)-7+s)<0?0:l/p(10,s-i-1)%10|0}if(n=n||e<0||void 0!==f[g+1]||(i<0?l:l%p(10,s-i-1)),c=r<4?(h||n)&&(0==r||r==(t.s<0?3:2)):h>5||5==h&&(4==r||n||6==r&&(o>0?i>0?l/p(10,s-i):0:f[g-1])%10&1||r==(t.s<0?8:7)),e<1||!f[0])return f.length=0,c?(e-=t.e+1,f[0]=p(10,(7-e%7)%7),t.e=-e||0):f[0]=t.e=0,t;if(0==o?(f.length=g,a=1,g--):(f.length=g+1,a=p(10,7-o),f[g]=i>0?(l/p(10,s-i)%p(10,i)|0)*a:0),c)for(;;){if(0==g){for(o=1,i=f[0];i>=10;i/=10)o++;for(i=f[0]+=a,a=1;i>=10;i/=10)a++;o!=a&&(t.e++,f[0]==x&&(f[0]=1));break}if(f[g]+=a,f[g]!=x)break;f[g--]=0,a=1}for(o=f.length;0===f[--o];)f.pop()}return u&&(t.e>m.maxE?(t.d=null,t.e=NaN):t.e<m.minE&&(t.e=0,t.d=[0])),t}function A(t,e,r){if(!t.isFinite())return Y(t);var n,s=t.e,o=S(t.d),i=o.length;return e?(r&&(n=r-i)>0?o=o.charAt(0)+"."+o.slice(1)+q(n):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(t.e<0?"e":"e+")+t.e):s<0?(o="0."+q(-s-1)+o,r&&(n=r-i)>0&&(o+=q(n))):s>=i?(o+=q(s+1-i),r&&(n=r-s-1)>0&&(o=o+"."+q(n))):((n=s+1)<i&&(o=o.slice(0,n)+"."+o.slice(n)),r&&(n=r-i)>0&&(s+1===i&&(o+="."),o+=q(n))),o}function k(t,e){var r=t[0];for(e*=7;r>=10;r/=10)e++;return e}function I(t,e,r){if(e>M)throw u=!0,r&&(t.precision=r),Error(l);return R(new t(o),e,1,!0)}function F(t,e,r){if(e>v)throw Error(l);return R(new t(i),e,r,!0)}function C(t){var e=t.length-1,r=7*e+1;if(e=t[e]){for(;e%10==0;e/=10)r--;for(e=t[0];e>=10;e/=10)r++}return r}function q(t){for(var e="";t--;)e+="0";return e}function P(t,e,r,n){var s,o=new t(1),i=Math.ceil(n/7+4);for(u=!1;;){if(r%2&&W((o=o.times(e)).d,i)&&(s=!0),0===(r=m(r/2))){r=o.d.length-1,s&&0===o.d[r]&&++o.d[r];break}W((e=e.times(e)).d,i)}return u=!0,o}function O(t){return 1&t.d[t.d.length-1]}function _(t,e,r){for(var n,s,o=new t(e[0]),i=0;++i<e.length;){if(!(s=new t(e[i])).s){o=s;break}((n=o.cmp(s))===r||0===n&&o.s===r)&&(o=s)}return o}function V(t,e){var r,n,s,o,i,a,h,c=0,l=0,f=0,g=t.constructor,m=g.rounding,w=g.precision;if(!t.d||!t.d[0]||t.e>17)return new g(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(null==e?(u=!1,h=w):h=e,a=new g(.03125);t.e>-2;)t=t.times(a),f+=5;for(h+=n=Math.log(p(2,f))/Math.LN10*2+5|0,r=o=i=new g(1),g.precision=h;;){if(o=R(o.times(t),h,1),r=r.times(++l),S((a=i.plus(D(o,r,h,1))).d).slice(0,h)===S(i.d).slice(0,h)){for(s=f;s--;)i=R(i.times(i),h,1);if(null!=e)return g.precision=w,i;if(!(c<3&&T(i.d,h-n,m,c)))return R(i,g.precision=w,m,u=!0);g.precision=h+=10,r=o=a=new g(1),l=0,c++}i=a}}function j(t,e){var r,n,s,o,i,a,h,c,l,f,g,m=1,p=t,w=p.d,d=p.constructor,y=d.rounding,b=d.precision;if(p.s<0||!w||!w[0]||!p.e&&1==w[0]&&1==w.length)return new d(w&&!w[0]?-1/0:1!=p.s?NaN:w?0:p);if(null==e?(u=!1,l=b):l=e,d.precision=l+=10,n=(r=S(w)).charAt(0),!(Math.abs(o=p.e)<15e14))return c=I(d,l+2,b).times(o+""),p=j(new d(n+"."+r.slice(1)),l-10).plus(c),d.precision=b,null==e?R(p,b,y,u=!0):p;for(;n<7&&1!=n||1==n&&r.charAt(1)>3;)n=(r=S((p=p.times(t)).d)).charAt(0),m++;for(o=p.e,n>1?(p=new d("0."+r),o++):p=new d(n+"."+r.slice(1)),f=p,h=i=p=D(p.minus(1),p.plus(1),l,1),g=R(p.times(p),l,1),s=3;;){if(i=R(i.times(g),l,1),S((c=h.plus(D(i,new d(s),l,1))).d).slice(0,l)===S(h.d).slice(0,l)){if(h=h.times(2),0!==o&&(h=h.plus(I(d,l+2,b).times(o+""))),h=D(h,new d(m),l,1),null!=e)return d.precision=b,h;if(!T(h.d,l-10,y,a))return R(h,d.precision=b,y,u=!0);d.precision=l+=10,c=i=p=D(f.minus(1),f.plus(1),l,1),g=R(p.times(p),l,1),s=a=1}h=c,s+=2}}function Y(t){return String(t.s*t.s/0)}function z(t,e){var r,n,s;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;48===e.charCodeAt(n);n++);for(s=e.length;48===e.charCodeAt(s-1);--s);if(e=e.slice(n,s)){if(s-=n,t.e=r=r-n-1,t.d=[],n=(r+1)%7,r<0&&(n+=7),n<s){for(n&&t.d.push(+e.slice(0,n)),s-=7;n<s;)t.d.push(+e.slice(n,n+=7));n=7-(e=e.slice(n)).length}else n-=s;for(;n--;)e+="0";t.d.push(+e),u&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function H(t,e){var r,n,s,o,i,a,h,l,f;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),b.test(e))return z(t,e)}else if("Infinity"===e||"NaN"===e)return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(d.test(e))r=16,e=e.toLowerCase();else if(w.test(e))r=2;else{if(!y.test(e))throw Error(c+e);r=8}for((o=e.search(/p/i))>0?(h=+e.slice(o+1),e=e.substring(2,o)):e=e.slice(2),i=(o=e.indexOf("."))>=0,n=t.constructor,i&&(o=(a=(e=e.replace(".","")).length)-o,s=P(n,new n(r),o,2*o)),o=f=(l=$(e,r,x)).length-1;0===l[o];--o)l.pop();return o<0?new n(0*t.s):(t.e=k(l,f),t.d=l,u=!1,i&&(t=D(t,s,4*a)),h&&(t=t.times(Math.abs(h)<54?p(2,h):qt.pow(2,h))),u=!0,t)}function L(t,e,r,n,s){var o,i,a,h,c=t.precision,l=Math.ceil(c/7);for(u=!1,h=r.times(r),a=new t(n);;){if(i=D(a.times(h),new t(e++*e++),c,1),a=s?n.plus(i):n.minus(i),n=D(i.times(h),new t(e++*e++),c,1),void 0!==(i=a.plus(n)).d[l]){for(o=l;i.d[o]===a.d[o]&&o--;);if(-1==o)break}o=a,a=n,n=i,i=o}return u=!0,i.d.length=l+1,i}function U(t,e){for(var r=t;--e;)r*=t;return r}function Z(t,r){var n,s=r.s<0,o=F(t,t.precision,1),i=o.times(.5);if((r=r.abs()).lte(i))return e=s?4:1,r;if((n=r.divToInt(o)).isZero())e=s?3:2;else{if((r=r.minus(n.times(o))).lte(i))return e=O(n)?s?2:3:s?4:1,r;e=O(n)?s?1:4:s?3:2}return r.minus(o).abs()}function B(e,r,o,i){var a,u,h,c,l,f,g,m,p,w=e.constructor,d=void 0!==o;if(d?(N(o,1,n),void 0===i?i=w.rounding:N(i,0,8)):(o=w.precision,i=w.rounding),e.isFinite()){for(d?(a=2,16==r?o=4*o-3:8==r&&(o=3*o-2)):a=r,(h=(g=A(e)).indexOf("."))>=0&&(g=g.replace(".",""),(p=new w(1)).e=g.length-h,p.d=$(A(p),10,a),p.e=p.d.length),u=l=(m=$(g,10,a)).length;0==m[--l];)m.pop();if(m[0]){if(h<0?u--:((e=new w(e)).d=m,e.e=u,m=(e=D(e,p,o,i,0,a)).d,u=e.e,f=t),h=m[o],c=a/2,f=f||void 0!==m[o+1],f=i<4?(void 0!==h||f)&&(0===i||i===(e.s<0?3:2)):h>c||h===c&&(4===i||f||6===i&&1&m[o-1]||i===(e.s<0?8:7)),m.length=o,f)for(;++m[--o]>a-1;)m[o]=0,o||(++u,m.unshift(1));for(l=m.length;!m[l-1];--l);for(h=0,g="";h<l;h++)g+=s.charAt(m[h]);if(d){if(l>1)if(16==r||8==r){for(h=16==r?4:3,--l;l%h;l++)g+="0";for(l=(m=$(g,a,r)).length;!m[l-1];--l);for(h=1,g="1.";h<l;h++)g+=s.charAt(m[h])}else g=g.charAt(0)+"."+g.slice(1);g=g+(u<0?"p":"p+")+u}else if(u<0){for(;++u;)g="0"+g;g="0."+g}else if(++u>l)for(u-=l;u--;)g+="0";else u<l&&(g=g.slice(0,u)+"."+g.slice(u))}else g=d?"0p+0":"0";g=(16==r?"0x":2==r?"0b":8==r?"0o":"")+g}else g=Y(e);return e.s<0?"-"+g:g}function W(t,e){if(t.length>e)return t.length=e,!0}function Q(t){return new this(t).abs()}function K(t){return new this(t).acos()}function J(t){return new this(t).acosh()}function X(t,e){return new this(t).plus(e)}function G(t){return new this(t).asin()}function tt(t){return new this(t).asinh()}function et(t){return new this(t).atan()}function rt(t){return new this(t).atanh()}function nt(t,e){t=new this(t),e=new this(e);var r,n=this.precision,s=this.rounding,o=n+4;return t.s&&e.s?t.d||e.d?!e.d||t.isZero()?(r=e.s<0?F(this,n,s):new this(0)).s=t.s:!t.d||e.isZero()?(r=F(this,o,1).times(.5)).s=t.s:e.s<0?(this.precision=o,this.rounding=1,r=this.atan(D(t,e,o,1)),e=F(this,o,1),this.precision=n,this.rounding=s,r=t.s<0?r.minus(e):r.plus(e)):r=this.atan(D(t,e,o,1)):(r=F(this,o,1).times(e.s>0?.25:.75)).s=t.s:r=new this(NaN),r}function st(t){return new this(t).cbrt()}function ot(t){return R(t=new this(t),t.e+1,2)}function it(t,e,r){return new this(t).clamp(e,r)}function at(t){if(!t||"object"!=typeof t)throw Error(h+"Object expected");var e,s,o,i=!0===t.defaults,u=["precision",1,n,"rounding",0,8,"toExpNeg",-9e15,0,"toExpPos",0,r,"maxE",0,r,"minE",-9e15,0,"modulo",0,9];for(e=0;e<u.length;e+=3)if(s=u[e],i&&(this[s]=a[s]),void 0!==(o=t[s])){if(!(m(o)===o&&o>=u[e+1]&&o<=u[e+2]))throw Error(c+s+": "+o);this[s]=o}if(s="crypto",i&&(this[s]=a[s]),void 0!==(o=t[s])){if(!0!==o&&!1!==o&&0!==o&&1!==o)throw Error(c+s+": "+o);if(o){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(f);this[s]=!0}else this[s]=!1}return this}function ut(t){return new this(t).cos()}function ht(t){return new this(t).cosh()}function ct(t,e){return new this(t).div(e)}function lt(t){return new this(t).exp()}function ft(t){return R(t=new this(t),t.e+1,3)}function gt(){var t,e,r=new this(0);for(u=!1,t=0;t<arguments.length;)if((e=new this(arguments[t++])).d)r.d&&(r=r.plus(e.times(e)));else{if(e.s)return u=!0,new this(1/0);r=e}return u=!0,r.sqrt()}function mt(t){return t instanceof qt||t&&t.toStringTag===g||!1}function pt(t){return new this(t).ln()}function wt(t,e){return new this(t).log(e)}function dt(t){return new this(t).log(2)}function yt(t){return new this(t).log(10)}function bt(){return _(this,arguments,-1)}function xt(){return _(this,arguments,1)}function Mt(t,e){return new this(t).mod(e)}function vt(t,e){return new this(t).mul(e)}function Et(t,e){return new this(t).pow(e)}function St(t){var e,r,s,o,i=0,a=new this(1),u=[];if(void 0===t?t=this.precision:N(t,1,n),s=Math.ceil(t/7),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(s));i<s;)(o=e[i])>=429e7?e[i]=crypto.getRandomValues(new Uint32Array(1))[0]:u[i++]=o%1e7;else{if(!crypto.randomBytes)throw Error(f);for(e=crypto.randomBytes(s*=4);i<s;)(o=e[i]+(e[i+1]<<8)+(e[i+2]<<16)+((127&e[i+3])<<24))>=214e7?crypto.randomBytes(4).copy(e,i):(u.push(o%1e7),i+=4);i=s/4}else for(;i<s;)u[i++]=1e7*Math.random()|0;for(t%=7,(s=u[--i])&&t&&(o=p(10,7-t),u[i]=(s/o|0)*o);0===u[i];i--)u.pop();if(i<0)r=0,u=[0];else{for(r=-1;0===u[0];r-=7)u.shift();for(s=1,o=u[0];o>=10;o/=10)s++;s<7&&(r-=7-s)}return a.e=r,a.d=u,a}function Nt(t){return R(t=new this(t),t.e+1,this.rounding)}function Tt(t){return(t=new this(t)).d?t.d[0]?t.s:0*t.s:t.s||NaN}function $t(t){return new this(t).sin()}function Dt(t){return new this(t).sinh()}function Rt(t){return new this(t).sqrt()}function At(t,e){return new this(t).sub(e)}function kt(){var t=0,e=arguments,r=new this(e[t]);for(u=!1;r.s&&++t<e.length;)r=r.plus(e[t]);return u=!0,R(r,this.precision,this.rounding)}function It(t){return new this(t).tan()}function Ft(t){return new this(t).tanh()}function Ct(t){return R(t=new this(t),t.e+1,1)}E[Symbol.for("nodejs.util.inspect.custom")]=E.toString,E[Symbol.toStringTag]="Decimal";var qt=E.constructor=function t(e){var r,n,s;function o(t){var e,r,n,s=this;if(!(s instanceof o))return new o(t);if(s.constructor=o,mt(t))return s.s=t.s,void(u?!t.d||t.e>o.maxE?(s.e=NaN,s.d=null):t.e<o.minE?(s.e=0,s.d=[0]):(s.e=t.e,s.d=t.d.slice()):(s.e=t.e,s.d=t.d?t.d.slice():t.d));if("number"===(n=typeof t)){if(0===t)return s.s=1/t<0?-1:1,s.e=0,void(s.d=[0]);if(t<0?(t=-t,s.s=-1):s.s=1,t===~~t&&t<1e7){for(e=0,r=t;r>=10;r/=10)e++;return void(u?e>o.maxE?(s.e=NaN,s.d=null):e<o.minE?(s.e=0,s.d=[0]):(s.e=e,s.d=[t]):(s.e=e,s.d=[t]))}return 0*t!=0?(t||(s.s=NaN),s.e=NaN,void(s.d=null)):z(s,t.toString())}if("string"===n)return 45===(r=t.charCodeAt(0))?(t=t.slice(1),s.s=-1):(43===r&&(t=t.slice(1)),s.s=1),b.test(t)?z(s,t):H(s,t);if("bigint"===n)return t<0?(t=-t,s.s=-1):s.s=1,z(s,t.toString());throw Error(c+t)}if(o.prototype=E,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.EUCLID=9,o.config=o.set=at,o.clone=t,o.isDecimal=mt,o.abs=Q,o.acos=K,o.acosh=J,o.add=X,o.asin=G,o.asinh=tt,o.atan=et,o.atanh=rt,o.atan2=nt,o.cbrt=st,o.ceil=ot,o.clamp=it,o.cos=ut,o.cosh=ht,o.div=ct,o.exp=lt,o.floor=ft,o.hypot=gt,o.ln=pt,o.log=wt,o.log10=yt,o.log2=dt,o.max=bt,o.min=xt,o.mod=Mt,o.mul=vt,o.pow=Et,o.random=St,o.round=Nt,o.sign=Tt,o.sin=$t,o.sinh=Dt,o.sqrt=Rt,o.sub=At,o.sum=kt,o.tan=It,o.tanh=Ft,o.trunc=Ct,void 0===e&&(e={}),e&&!0!==e.defaults)for(s=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<s.length;)e.hasOwnProperty(n=s[r++])||(e[n]=this[n]);return o.config(e),o}(a);function Pt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ot(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var r=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})})),r}o=new qt(o),i=new qt(i);var _t={};const Vt=Object.prototype.toString;function jt(t){const e=Vt.call(t);return e.endsWith("Array]")&&!e.includes("Big")}var Yt=Ot(Object.freeze({__proto__:null,isAnyArray:jt}));var zt,Ht=Ot(Object.freeze({__proto__:null,default:function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!jt(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!jt(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!jt(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,s=e.toIndex,o=void 0===s?t.length:s;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var i=t[n],a=n+1;a<o;a++)t[a]<i&&(i=t[a]);return i}(t),s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!jt(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,s=e.toIndex,o=void 0===s?t.length:s;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var i=t[n],a=n+1;a<o;a++)t[a]>i&&(i=t[a]);return i}(t);if(n===s)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=r.min,i=void 0===o?r.autoMinMax?n:0:o,a=r.max,u=void 0===a?r.autoMinMax?s:1:a;if(i>=u)throw new RangeError("min option must be smaller than max option");for(var h=(u-i)/(s-n),c=0;c<t.length;c++)e[c]=(t[c]-n)*h+i;return e}}));function Lt(){if(zt)return _t;zt=1,Object.defineProperty(_t,"__esModule",{value:!0});var t=Yt,e=Ht;const r=" ".repeat(2),n=" ".repeat(4);function s(t,e={}){const{maxRows:s=15,maxColumns:i=10,maxNumSize:a=8,padMinus:u="auto"}=e;return`${t.constructor.name} {\n${r}[\n${n}${function(t,e,r,s,i){const{rows:a,columns:u}=t,h=Math.min(a,e),c=Math.min(u,r),l=[];if("auto"===i){i=!1;t:for(let e=0;e<h;e++)for(let r=0;r<c;r++)if(t.get(e,r)<0){i=!0;break t}}for(let e=0;e<h;e++){let r=[];for(let n=0;n<c;n++)r.push(o(t.get(e,n),s,i));l.push(`${r.join(" ")}`)}c!==u&&(l[l.length-1]+=` ... ${u-r} more columns`);h!==a&&l.push(`... ${a-e} more rows`);return l.join(`\n${n}`)}(t,s,i,a,u)}\n${r}]\n${r}rows: ${t.rows}\n${r}columns: ${t.columns}\n}`}function o(t,e,r){return(t>=0&&r?` ${i(t,e-1)}`:i(t,e)).padEnd(e)}function i(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let s=t.toExponential(e);return s.length>e&&(s=t.toExponential(Math.max(0,e-(s.length-e)))),s.slice(0)}function a(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function u(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function h(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function c(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function l(e,r){if(!t.isAnyArray(r))throw new TypeError("row indices must be an array");for(let t=0;t<r.length;t++)if(r[t]<0||r[t]>=e.rows)throw new RangeError("row indices are out of range")}function f(e,r){if(!t.isAnyArray(r))throw new TypeError("column indices must be an array");for(let t=0;t<r.length;t++)if(r[t]<0||r[t]>=e.columns)throw new RangeError("column indices are out of range")}function g(t,e,r,n,s){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(p("startRow",e),p("endRow",r),p("startColumn",n),p("endColumn",s),e>r||n>s||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||s<0||s>=t.columns)throw new RangeError("Submatrix indices are out of range")}function m(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function p(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function w(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class d{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new b(t,e);for(let s=0;s<t;s++)for(let t=0;t<e;t++)n.set(s,t,r[s*e+t]);return n}static rowVector(t){let e=new b(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new b(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new b(t,e)}static ones(t,e){return new b(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let s=new b(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)s.set(r,t,n());return s}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:s=1e3,random:o=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(s))throw new TypeError("max must be an integer");if(n>=s)throw new RangeError("min must be smaller than max");let i=s-n,a=new b(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(o()*i);a.set(r,t,e)}return a}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),s=this.zeros(t,e);for(let t=0;t<n;t++)s.set(t,t,r);return s}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let s=Math.min(n,e,r),o=this.zeros(e,r);for(let e=0;e<s;e++)o.set(e,e,t[e]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,s=new b(r,n);for(let o=0;o<r;o++)for(let r=0;r<n;r++)s.set(o,r,Math.min(t.get(o,r),e.get(o,r)));return s}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,s=new this(r,n);for(let o=0;o<r;o++)for(let r=0;r<n;r++)s.set(o,r,Math.max(t.get(o,r),e.get(o,r)));return s}static checkMatrix(t){return d.isMatrix(t)?t:new b(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,r=-1,n=!0,s=!1;for(;t<this.rows&&n;){for(e=0,s=!1;e<this.columns&&!1===s;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(s=!0,r=e):(n=!1,s=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,s=!1;for(;t<this.rows&&n;){for(e=0,s=!1;e<this.columns&&!1===s;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(s=!0,r=e):(n=!1,s=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let s=e;s<t.rows;s++)t.get(s,r)>t.get(n,r)&&(n=s);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let s=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/s);for(let n=e+1;n<t.rows;n++){let s=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let o=r+1;o<t.columns;o++)t.set(n,o,t.get(n,o)-t.get(e,o)*s)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let s=0,o=!1;for(;s<r&&!1===o;)1===t.get(n,s)?o=!0:s++;for(let r=0;r<n;r++){let o=t.get(r,s);for(let i=s;i<e;i++){let e=t.get(r,i)-o*t.get(n,i);t.set(r,i,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new b(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){a(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return b.rowVector(this.getRow(t))}setRow(t,e){a(this,t),e=h(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){a(this,t),a(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){u(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return b.columnVector(this.getColumn(t))}setColumn(t,e){u(this,t),e=c(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){u(this,t),u(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=h(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=h(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=h(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=h(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=c(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=c(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=c(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=c(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){a(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){u(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){w(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){w(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(a(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){a(this,t),w(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(a(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){a(this,t),w(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(u(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){u(this,t),w(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(u(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){u(this,t),w(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){d.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=b.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,s=new b(e,n),o=new Float64Array(r);for(let i=0;i<n;i++){for(let e=0;e<r;e++)o[e]=t.get(e,i);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*o[n];s.set(t,i,e)}}return s}mpow(t){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw new RangeError("Exponent must be a non-negative integer");let e=b.eye(this.rows),r=this;for(let n=t;n>1;n/=2)1&n&&(e=e.mmul(r)),r=r.mmul(r);return e}strassen2x2(t){t=b.checkMatrix(t);let e=new b(2,2);const r=this.get(0,0),n=t.get(0,0),s=this.get(0,1),o=t.get(0,1),i=this.get(1,0),a=t.get(1,0),u=this.get(1,1),h=t.get(1,1),c=(r+u)*(n+h),l=(i+u)*n,f=r*(o-h),g=u*(a-n),m=(r+s)*h,p=c+g-m+(s-u)*(a+h),w=f+m,d=l+g,y=c-l+f+(i-r)*(n+o);return e.set(0,0,p),e.set(0,1,w),e.set(1,0,d),e.set(1,1,y),e}strassen3x3(t){t=b.checkMatrix(t);let e=new b(3,3);const r=this.get(0,0),n=this.get(0,1),s=this.get(0,2),o=this.get(1,0),i=this.get(1,1),a=this.get(1,2),u=this.get(2,0),h=this.get(2,1),c=this.get(2,2),l=t.get(0,0),f=t.get(0,1),g=t.get(0,2),m=t.get(1,0),p=t.get(1,1),w=t.get(1,2),d=t.get(2,0),y=t.get(2,1),x=t.get(2,2),M=(r-o)*(-f+p),v=(-r+o+i)*(l-f+p),E=(o+i)*(-l+f),S=r*l,N=(-r+u+h)*(l-g+w),T=(-r+u)*(g-w),$=(u+h)*(-l+g),D=(-s+h+c)*(p+d-y),R=(s-c)*(p-y),A=s*d,k=(h+c)*(-d+y),I=(-s+i+a)*(w+d-x),F=(s-a)*(w-x),C=(i+a)*(-d+x),q=S+A+n*m,P=(r+n+s-o-i-h-c)*p+v+E+S+D+A+k,O=S+N+$+(r+n+s-i-a-u-h)*w+A+I+C,_=M+i*(-l+f+m-p-w-d+x)+v+S+A+I+F,V=M+v+E+S+a*y,j=A+I+F+C+o*g,Y=S+N+T+h*(-l+g+m-p-w-d+y)+D+R+A,z=D+R+A+k+u*f,H=S+N+T+$+c*x;return e.set(0,0,q),e.set(0,1,P),e.set(0,2,O),e.set(1,0,_),e.set(1,1,V),e.set(1,2,j),e.set(2,0,Y),e.set(2,1,z),e.set(2,2,H),e}mmulStrassen(t){t=b.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,s=t.rows,o=t.columns;function i(t,e,r){let n=t.rows,s=t.columns;if(n===e&&s===r)return t;{let n=d.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==s&&console.warn(`Multiplying ${r} x ${n} and ${s} x ${o} matrix: dimensions do not match.`);let a=Math.max(r,s),u=Math.max(n,o);return e=i(e,a,u),function t(e,r,n,s){if(n<=512||s<=512)return e.mmul(r);n%2==1&&s%2==1?(e=i(e,n+1,s+1),r=i(r,n+1,s+1)):n%2==1?(e=i(e,n+1,s),r=i(r,n+1,s)):s%2==1&&(e=i(e,n,s+1),r=i(r,n,s+1));let o=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),u=e.subMatrix(0,o-1,0,a-1),h=r.subMatrix(0,o-1,0,a-1),c=e.subMatrix(0,o-1,a,e.columns-1),l=r.subMatrix(0,o-1,a,r.columns-1),f=e.subMatrix(o,e.rows-1,0,a-1),g=r.subMatrix(o,r.rows-1,0,a-1),m=e.subMatrix(o,e.rows-1,a,e.columns-1),p=r.subMatrix(o,r.rows-1,a,r.columns-1),w=t(d.add(u,m),d.add(h,p),o,a),y=t(d.add(f,m),h,o,a),b=t(u,d.sub(l,p),o,a),x=t(m,d.sub(g,h),o,a),M=t(d.add(u,c),p,o,a),v=t(d.sub(f,u),d.add(h,l),o,a),E=t(d.sub(c,m),d.add(g,p),o,a),S=d.add(w,x);S.sub(M),S.add(E);let N=d.add(b,M),T=d.add(y,x),$=d.sub(w,y);$.add(b),$.add(v);let D=d.zeros(2*S.rows,2*S.columns);return D=D.setSubMatrix(S,0,0),D=D.setSubMatrix(N,S.rows,0),D=D.setSubMatrix(T,0,S.columns),D=D.setSubMatrix($,S.rows,S.columns),D.subMatrix(0,n-1,0,s-1)}(e,t=i(t,a,u),a,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:r=0,max:n=1}=t;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(r>=n)throw new RangeError("min must be smaller than max");let s=new b(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&e(o,{min:r,max:n,output:o}),s.setRow(t,o)}return s}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:r=0,max:n=1}=t;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(r>=n)throw new RangeError("min must be smaller than max");let s=new b(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&e(o,{min:r,max:n,output:o}),s.setColumn(t,o)}return s}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=b.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,s=t.columns,o=new b(e*n,r*s);for(let i=0;i<e;i++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let a=0;a<s;a++)o.set(n*i+r,s*e+a,this.get(i,e)*t.get(r,a));return o}kroneckerSum(t){if(t=b.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(b.eye(r,r)),s=b.eye(e,e).kroneckerProduct(t);return n.add(s)}transpose(){let t=new b(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=y){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=y){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){g(this,t,e,r,n);let s=new b(e-t+1,n-r+1);for(let o=t;o<=e;o++)for(let e=r;e<=n;e++)s.set(o-t,e-r,this.get(o,e));return s}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new b(t.length,r-e+1);for(let s=0;s<t.length;s++)for(let o=e;o<=r;o++){if(t[s]<0||t[s]>=this.rows)throw new RangeError(`Row index out of range: ${t[s]}`);n.set(s,o-e,this.get(t[s],o))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new b(r-e+1,t.length);for(let s=0;s<t.length;s++)for(let o=e;o<=r;o++){if(t[s]<0||t[s]>=this.columns)throw new RangeError(`Column index out of range: ${t[s]}`);n.set(o-e,s,this.get(o,t[s]))}return n}setSubMatrix(t,e,r){if((t=b.checkMatrix(t)).isEmpty())return this;g(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let s=0;s<t.columns;s++)this.set(e+n,r+s,t.get(n,s));return this}selection(t,e){l(this,t),f(this,e);let r=new b(t.length,e.length);for(let n=0;n<t.length;n++){let s=t[n];for(let t=0;t<e.length;t++){let o=e[t];r.set(n,t,this.get(s,o))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){return this.constructor.copy(this,new b(this.rows,this.columns))}static copy(t,e){for(const[r,n,s]of t.entries())e.set(r,n,s);return e}sum(t){switch(t){case"row":return function(t){let e=m(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=m(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=m(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=m(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(e,r={}){if("object"==typeof e&&(r=e,e=void 0),"object"!=typeof r)throw new TypeError("options must be an object");const{unbiased:n=!0,mean:s=this.mean(e)}=r;if("boolean"!=typeof n)throw new TypeError("unbiased must be a boolean");switch(e){case"row":if(!t.isAnyArray(s))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,s=t.columns,o=[];for(let i=0;i<n;i++){let n=0,a=0,u=0;for(let e=0;e<s;e++)u=t.get(i,e)-r[i],n+=u,a+=u*u;e?o.push((a-n*n/s)/(s-1)):o.push((a-n*n/s)/s)}return o}(this,n,s);case"column":if(!t.isAnyArray(s))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,s=t.columns,o=[];for(let i=0;i<s;i++){let s=0,a=0,u=0;for(let e=0;e<n;e++)u=t.get(e,i)-r[i],s+=u,a+=u*u;e?o.push((a-s*s/n)/(n-1)):o.push((a-s*s/n)/n)}return o}(this,n,s);case void 0:if("number"!=typeof s)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,s=t.columns,o=n*s;let i=0,a=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<s;n++)u=t.get(e,n)-r,i+=u,a+=u*u;return e?(a-i*i/o)/(o-1):(a-i*i/o)/o}(this,n,s);default:throw new Error(`invalid option: ${e}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(e,r={}){if("object"==typeof e&&(r=e,e=void 0),"object"!=typeof r)throw new TypeError("options must be an object");const{center:n=this.mean(e)}=r;switch(e){case"row":if(!t.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,n),this;case"column":if(!t.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,n),this;case void 0:if("number"!=typeof n)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,n),this;default:throw new Error(`invalid option: ${e}`)}}scale(e,r={}){if("object"==typeof e&&(r=e,e=void 0),"object"!=typeof r)throw new TypeError("options must be an object");let n=r.scale;switch(e){case"row":if(void 0===n)n=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=t.get(r,e)**2/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!t.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,n),this;case"column":if(void 0===n)n=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=t.get(e,r)**2/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!t.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,n),this;case void 0:if(void 0===n)n=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let s=0;s<t.rows;s++)r+=t.get(s,n)**2/e;return Math.sqrt(r)}(this);else if("number"!=typeof n)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,n),this;default:throw new Error(`invalid option: ${e}`)}}toString(t){return s(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function y(t,e){return t-e}d.prototype.klass="Matrix","undefined"!=typeof Symbol&&(d.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return s(this)}),d.random=d.rand,d.randomInt=d.randInt,d.diagonal=d.diag,d.prototype.diagonal=d.prototype.diag,d.identity=d.eye,d.prototype.negate=d.prototype.neg,d.prototype.tensorProduct=d.prototype.kroneckerProduct;class b extends d{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(e,r){if(super(),b.isMatrix(e))this.#t(e.rows,e.columns),b.copy(e,this);else if(Number.isInteger(e)&&e>=0)this.#t(e,r);else{if(!t.isAnyArray(e))throw new TypeError("First argument must be a positive number or an array");{const t=e;if("number"!=typeof(r=(e=t.length)?t[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<e;n++){if(t[n].length!==r)throw new RangeError("Inconsistent array dimensions");if(!t[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(t[n]))}this.rows=e,this.columns=r}}}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return a(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),a(this,t,!0),e=Float64Array.from(h(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){u(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),u(this,t,!0),e=c(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let s=0;for(;s<t;s++)n[s]=this.data[r][s];for(n[s++]=e[r];s<this.columns+1;s++)n[s]=this.data[r][s-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t);return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t.get(e,r));return this}}(d,b);class x extends d{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return b.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),b.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=b.copy(t,new b(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new b(t,t);else if(this.#e=new b(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new x(this.diagonalSize);for(const[e,r,n]of this.upperRightEntries())t.set(e,r,n);return t}toMatrix(){return new b(this)}get(t,e){return this.#e.get(t,e)}set(t,e,r){return this.#e.set(t,e,r),this.#e.set(e,t,r),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const r=e.slice();return r.splice(t,1),this.#e.addRow(t,r),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[r,n]of t.entries())n||e.push(r);e.reverse();for(const t of e)this.removeCross(t);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let r=0,n=0,s=0;s<e.length;s++)e[s]=this.get(n,r),++r>=t&&(r=++n);return e}static fromCompact(t){const e=t.length,r=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const n=new x(r);for(let s=0,o=0,i=0;i<e;i++)n.set(s,o,t[i]),++s>=r&&(s=++o);return n}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield[t,e,r],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield r,++e>=this.diagonalSize&&(e=++t)}}}x.prototype.klassType="SymmetricMatrix";class M extends x{static isDistanceMatrix(t){return x.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,r){return t===e&&(r=0),super.set(t,e,r)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new x(this)}clone(){const t=new M(this.diagonalSize);for(const[e,r,n]of this.upperRightEntries())e!==r&&t.set(e,r,n);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let r=1,n=0,s=0;s<e.length;s++)e[s]=this.get(n,r),++r>=t&&(r=1+ ++n);return e}static fromCompact(t){const e=t.length;if(0===e)return new this(0);const r=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const n=new this(r);for(let s=1,o=0,i=0;i<e;i++)n.set(s,o,t[i]),++s>=r&&(s=1+ ++o);return n}}M.prototype.klassSubType="DistanceMatrix";class v extends d{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}}class E extends v{constructor(t,e,r){l(t,e),f(t,r),super(t,e.length,r.length),this.rowIndices=e,this.columnIndices=r}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class S extends d{constructor(t,e={}){const{rows:r=1}=e;if(t.length%r!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){let n=this._calculateIndex(t,e);return this.data[n]=r,this}get(t,e){let r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}}class N extends d{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}class T{constructor(t){let e,r,n,s,o,i,a,u,h,c=(t=N.checkMatrix(t)).clone(),l=c.rows,f=c.columns,g=new Float64Array(l),m=1;for(e=0;e<l;e++)g[e]=e;for(u=new Float64Array(l),r=0;r<f;r++){for(e=0;e<l;e++)u[e]=c.get(e,r);for(e=0;e<l;e++){for(h=Math.min(e,r),o=0,n=0;n<h;n++)o+=c.get(e,n)*u[n];u[e]-=o,c.set(e,r,u[e])}for(s=r,e=r+1;e<l;e++)Math.abs(u[e])>Math.abs(u[s])&&(s=e);if(s!==r){for(n=0;n<f;n++)i=c.get(s,n),c.set(s,n,c.get(r,n)),c.set(r,n,i);a=g[s],g[s]=g[r],g[r]=a,m=-m}if(r<l&&0!==c.get(r,r))for(e=r+1;e<l;e++)c.set(e,r,c.get(e,r)/c.get(r,r))}this.LU=c,this.pivotVector=g,this.pivotSign=m}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=b.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r,n,s,o=t.columns,i=t.subMatrixRow(this.pivotVector,0,o-1),a=e.columns;for(s=0;s<a;s++)for(r=s+1;r<a;r++)for(n=0;n<o;n++)i.set(r,n,i.get(r,n)-i.get(s,n)*e.get(r,s));for(s=a-1;s>=0;s--){for(n=0;n<o;n++)i.set(s,n,i.get(s,n)/e.get(s,s));for(r=0;r<s;r++)for(n=0;n<o;n++)i.set(r,n,i.get(r,n)-i.get(s,n)*e.get(r,s))}return i}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let n=0;n<r;n++)e*=t.get(n,n);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new b(e,r);for(let s=0;s<e;s++)for(let e=0;e<r;e++)s>e?n.set(s,e,t.get(s,e)):s===e?n.set(s,e,1):n.set(s,e,0);return n}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new b(e,r);for(let s=0;s<e;s++)for(let e=0;e<r;e++)s<=e?n.set(s,e,t.get(s,e)):n.set(s,e,0);return n}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function $(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class D{constructor(t){let e,r,n,s,o=(t=N.checkMatrix(t)).clone(),i=t.rows,a=t.columns,u=new Float64Array(a);for(n=0;n<a;n++){let t=0;for(e=n;e<i;e++)t=$(t,o.get(e,n));if(0!==t){for(o.get(n,n)<0&&(t=-t),e=n;e<i;e++)o.set(e,n,o.get(e,n)/t);for(o.set(n,n,o.get(n,n)+1),r=n+1;r<a;r++){for(s=0,e=n;e<i;e++)s+=o.get(e,n)*o.get(e,r);for(s=-s/o.get(n,n),e=n;e<i;e++)o.set(e,r,o.get(e,r)+s*o.get(e,n))}}u[n]=-t}this.QR=o,this.Rdiag=u}solve(t){t=b.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let n,s,o,i,a=t.columns,u=t.clone(),h=e.columns;for(o=0;o<h;o++)for(s=0;s<a;s++){for(i=0,n=o;n<r;n++)i+=e.get(n,o)*u.get(n,s);for(i=-i/e.get(o,o),n=o;n<r;n++)u.set(n,s,u.get(n,s)+i*e.get(n,o))}for(o=h-1;o>=0;o--){for(s=0;s<a;s++)u.set(o,s,u.get(o,s)/this.Rdiag[o]);for(n=0;n<o;n++)for(s=0;s<a;s++)u.set(n,s,u.get(n,s)-u.get(o,s)*e.get(n,o))}return u.subMatrix(0,h-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,n=r.columns,s=new b(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)t<e?s.set(t,e,r.get(t,e)):t===e?s.set(t,e,this.Rdiag[t]):s.set(t,e,0);return s}get orthogonalMatrix(){let t,e,r,n,s=this.QR,o=s.rows,i=s.columns,a=new b(o,i);for(r=i-1;r>=0;r--){for(t=0;t<o;t++)a.set(t,r,0);for(a.set(r,r,1),e=r;e<i;e++)if(0!==s.get(r,r)){for(n=0,t=r;t<o;t++)n+=s.get(t,r)*a.get(t,e);for(n=-n/s.get(r,r),t=r;t<o;t++)a.set(t,e,a.get(t,e)+n*s.get(t,r))}}return a}}class R{constructor(t,e={}){if((t=N.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:s=!0,computeRightSingularVectors:o=!0,autoTranspose:i=!1}=e;let a,u=Boolean(s),h=Boolean(o),c=!1;if(r<n)if(i){a=t.transpose(),r=a.rows,n=a.columns,c=!0;let e=u;u=h,h=e}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();let l=Math.min(r,n),f=Math.min(r+1,n),g=new Float64Array(f),m=new b(r,l),p=new b(n,n),w=new Float64Array(n),d=new Float64Array(r),y=new Float64Array(f);for(let t=0;t<f;t++)y[t]=t;let x=Math.min(r-1,n),M=Math.max(0,Math.min(n-2,r)),v=Math.max(x,M);for(let t=0;t<v;t++){if(t<x){g[t]=0;for(let e=t;e<r;e++)g[t]=$(g[t],a.get(e,t));if(0!==g[t]){a.get(t,t)<0&&(g[t]=-g[t]);for(let e=t;e<r;e++)a.set(e,t,a.get(e,t)/g[t]);a.set(t,t,a.get(t,t)+1)}g[t]=-g[t]}for(let e=t+1;e<n;e++){if(t<x&&0!==g[t]){let n=0;for(let s=t;s<r;s++)n+=a.get(s,t)*a.get(s,e);n=-n/a.get(t,t);for(let s=t;s<r;s++)a.set(s,e,a.get(s,e)+n*a.get(s,t))}w[e]=a.get(t,e)}if(u&&t<x)for(let e=t;e<r;e++)m.set(e,t,a.get(e,t));if(t<M){w[t]=0;for(let e=t+1;e<n;e++)w[t]=$(w[t],w[e]);if(0!==w[t]){w[t+1]<0&&(w[t]=0-w[t]);for(let e=t+1;e<n;e++)w[e]/=w[t];w[t+1]+=1}if(w[t]=-w[t],t+1<r&&0!==w[t]){for(let e=t+1;e<r;e++)d[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)d[e]+=w[r]*a.get(e,r);for(let e=t+1;e<n;e++){let n=-w[e]/w[t+1];for(let s=t+1;s<r;s++)a.set(s,e,a.get(s,e)+n*d[s])}}if(h)for(let e=t+1;e<n;e++)p.set(e,t,w[e])}}let E=Math.min(n,r+1);if(x<n&&(g[x]=a.get(x,x)),r<E&&(g[E-1]=0),M+1<E&&(w[M]=a.get(M,E-1)),w[E-1]=0,u){for(let t=x;t<l;t++){for(let e=0;e<r;e++)m.set(e,t,0);m.set(t,t,1)}for(let t=x-1;t>=0;t--)if(0!==g[t]){for(let e=t+1;e<l;e++){let n=0;for(let s=t;s<r;s++)n+=m.get(s,t)*m.get(s,e);n=-n/m.get(t,t);for(let s=t;s<r;s++)m.set(s,e,m.get(s,e)+n*m.get(s,t))}for(let e=t;e<r;e++)m.set(e,t,-m.get(e,t));m.set(t,t,1+m.get(t,t));for(let e=0;e<t-1;e++)m.set(e,t,0)}else{for(let e=0;e<r;e++)m.set(e,t,0);m.set(t,t,1)}}if(h)for(let t=n-1;t>=0;t--){if(t<M&&0!==w[t])for(let e=t+1;e<n;e++){let r=0;for(let s=t+1;s<n;s++)r+=p.get(s,t)*p.get(s,e);r=-r/p.get(t+1,t);for(let s=t+1;s<n;s++)p.set(s,e,p.get(s,e)+r*p.get(s,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let S=E-1,T=Number.EPSILON;for(;E>0;){let t,e;for(t=E-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+T*Math.abs(g[t]+Math.abs(g[t+1]));if(Math.abs(w[t])<=e||Number.isNaN(w[t])){w[t]=0;break}}if(t===E-2)e=4;else{let r;for(r=E-1;r>=t&&r!==t;r--){let e=(r!==E?Math.abs(w[r]):0)+(r!==t+1?Math.abs(w[r-1]):0);if(Math.abs(g[r])<=T*e){g[r]=0;break}}r===t?e=3:r===E-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=w[E-2];w[E-2]=0;for(let r=E-2;r>=t;r--){let s=$(g[r],e),o=g[r]/s,i=e/s;if(g[r]=s,r!==t&&(e=-i*w[r-1],w[r-1]=o*w[r-1]),h)for(let t=0;t<n;t++)s=o*p.get(t,r)+i*p.get(t,E-1),p.set(t,E-1,-i*p.get(t,r)+o*p.get(t,E-1)),p.set(t,r,s)}break}case 2:{let e=w[t-1];w[t-1]=0;for(let n=t;n<E;n++){let s=$(g[n],e),o=g[n]/s,i=e/s;if(g[n]=s,e=-i*w[n],w[n]=o*w[n],u)for(let e=0;e<r;e++)s=o*m.get(e,n)+i*m.get(e,t-1),m.set(e,t-1,-i*m.get(e,n)+o*m.get(e,t-1)),m.set(e,n,s)}break}case 3:{const e=Math.max(Math.abs(g[E-1]),Math.abs(g[E-2]),Math.abs(w[E-2]),Math.abs(g[t]),Math.abs(w[t])),s=g[E-1]/e,o=g[E-2]/e,i=w[E-2]/e,a=g[t]/e,c=w[t]/e,l=((o+s)*(o-s)+i*i)/2,f=s*i*(s*i);let d=0;0===l&&0===f||(d=l<0?0-Math.sqrt(l*l+f):Math.sqrt(l*l+f),d=f/(l+d));let y=(a+s)*(a-s)+d,b=a*c;for(let e=t;e<E-1;e++){let s=$(y,b);0===s&&(s=Number.MIN_VALUE);let o=y/s,i=b/s;if(e!==t&&(w[e-1]=s),y=o*g[e]+i*w[e],w[e]=o*w[e]-i*g[e],b=i*g[e+1],g[e+1]=o*g[e+1],h)for(let t=0;t<n;t++)s=o*p.get(t,e)+i*p.get(t,e+1),p.set(t,e+1,-i*p.get(t,e)+o*p.get(t,e+1)),p.set(t,e,s);if(s=$(y,b),0===s&&(s=Number.MIN_VALUE),o=y/s,i=b/s,g[e]=s,y=o*w[e]+i*g[e+1],g[e+1]=-i*w[e]+o*g[e+1],b=i*w[e+1],w[e+1]=o*w[e+1],u&&e<r-1)for(let t=0;t<r;t++)s=o*m.get(t,e)+i*m.get(t,e+1),m.set(t,e+1,-i*m.get(t,e)+o*m.get(t,e+1)),m.set(t,e,s)}w[E-2]=y;break}case 4:if(g[t]<=0&&(g[t]=g[t]<0?-g[t]:0,h))for(let e=0;e<=S;e++)p.set(e,t,-p.get(e,t));for(;t<S&&!(g[t]>=g[t+1]);){let e=g[t];if(g[t]=g[t+1],g[t+1]=e,h&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=m.get(n,t+1),m.set(n,t+1,m.get(n,t)),m.set(n,t,e);t++}E--}}if(c){let t=p;p=m,m=t}this.m=r,this.n=n,this.s=g,this.U=m,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,s=b.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?s.set(t,t,0):s.set(t,t,1/this.s[t]);let o=this.U,i=this.rightSingularVectors,a=i.mmul(s),u=i.rows,h=o.rows,c=b.zeros(u,h);for(let t=0;t<u;t++)for(let e=0;e<h;e++){let r=0;for(let s=0;s<n;s++)r+=a.get(t,s)*o.get(e,s);c.set(t,e,r)}return c.mmul(e)}solveForDiagonal(t){return this.solve(b.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,s=new b(r,this.s.length);for(let o=0;o<r;o++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&s.set(o,r,t.get(o,r)/this.s[r]);let o=this.U,i=o.rows,a=o.columns,u=new b(r,i);for(let t=0;t<r;t++)for(let e=0;e<i;e++){let r=0;for(let n=0;n<a;n++)r+=s.get(t,n)*o.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,s=r.length;n<s;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return b.diag(this.s)}}function A(t,e,r=!1){return t=N.checkMatrix(t),e=N.checkMatrix(e),r?new R(t).solve(e):t.isSquare()?new T(t).solve(e):new D(t).solve(e)}function k(t,e){let r=[];for(let n=0;n<t;n++)n!==e&&r.push(n);return r}function I(t,e,r,n=1e-9,s=1e-9){if(t>s)return new Array(e.rows+1).fill(0);{let t=e.addRow(r,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<n&&t.set(e,0,0);return t.to1DArray()}}class F{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(!(t=N.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let n,s,o=t.columns,i=new b(o,o),a=new Float64Array(o),u=new Float64Array(o),h=t,c=!1;if(c=!!r||t.isSymmetric(),c){for(n=0;n<o;n++)for(s=0;s<o;s++)i.set(n,s,h.get(n,s));!function(t,e,r,n){let s,o,i,a,u,h,c,l;for(u=0;u<t;u++)r[u]=n.get(t-1,u);for(a=t-1;a>0;a--){for(l=0,i=0,h=0;h<a;h++)l+=Math.abs(r[h]);if(0===l)for(e[a]=r[a-1],u=0;u<a;u++)r[u]=n.get(a-1,u),n.set(a,u,0),n.set(u,a,0);else{for(h=0;h<a;h++)r[h]/=l,i+=r[h]*r[h];for(s=r[a-1],o=Math.sqrt(i),s>0&&(o=-o),e[a]=l*o,i-=s*o,r[a-1]=s-o,u=0;u<a;u++)e[u]=0;for(u=0;u<a;u++){for(s=r[u],n.set(u,a,s),o=e[u]+n.get(u,u)*s,h=u+1;h<=a-1;h++)o+=n.get(h,u)*r[h],e[h]+=n.get(h,u)*s;e[u]=o}for(s=0,u=0;u<a;u++)e[u]/=i,s+=e[u]*r[u];for(c=s/(i+i),u=0;u<a;u++)e[u]-=c*r[u];for(u=0;u<a;u++){for(s=r[u],o=e[u],h=u;h<=a-1;h++)n.set(h,u,n.get(h,u)-(s*e[h]+o*r[h]));r[u]=n.get(a-1,u),n.set(a,u,0)}}r[a]=i}for(a=0;a<t-1;a++){if(n.set(t-1,a,n.get(a,a)),n.set(a,a,1),i=r[a+1],0!==i){for(h=0;h<=a;h++)r[h]=n.get(h,a+1)/i;for(u=0;u<=a;u++){for(o=0,h=0;h<=a;h++)o+=n.get(h,a+1)*n.get(h,u);for(h=0;h<=a;h++)n.set(h,u,n.get(h,u)-o*r[h])}}for(h=0;h<=a;h++)n.set(h,a+1,0)}for(u=0;u<t;u++)r[u]=n.get(t-1,u),n.set(t-1,u,0);n.set(t-1,t-1,1),e[0]=0}(o,u,a,i),function(t,e,r,n){let s,o,i,a,u,h,c,l,f,g,m,p,w,d,y,b;for(i=1;i<t;i++)e[i-1]=e[i];e[t-1]=0;let x=0,M=0,v=Number.EPSILON;for(h=0;h<t;h++){for(M=Math.max(M,Math.abs(r[h])+Math.abs(e[h])),c=h;c<t&&!(Math.abs(e[c])<=v*M);)c++;if(c>h)do{for(s=r[h],l=(r[h+1]-s)/(2*e[h]),f=$(l,1),l<0&&(f=-f),r[h]=e[h]/(l+f),r[h+1]=e[h]*(l+f),g=r[h+1],o=s-r[h],i=h+2;i<t;i++)r[i]-=o;for(x+=o,l=r[c],m=1,p=m,w=m,d=e[h+1],y=0,b=0,i=c-1;i>=h;i--)for(w=p,p=m,b=y,s=m*e[i],o=m*l,f=$(l,e[i]),e[i+1]=y*f,y=e[i]/f,m=l/f,l=m*r[i]-y*s,r[i+1]=o+y*(m*s+y*r[i]),u=0;u<t;u++)o=n.get(u,i+1),n.set(u,i+1,y*n.get(u,i)+m*o),n.set(u,i,m*n.get(u,i)-y*o);l=-y*b*w*d*e[h]/g,e[h]=y*l,r[h]=m*l}while(Math.abs(e[h])>v*M);r[h]=r[h]+x,e[h]=0}for(i=0;i<t-1;i++){for(u=i,l=r[i],a=i+1;a<t;a++)r[a]<l&&(u=a,l=r[a]);if(u!==i)for(r[u]=r[i],r[i]=l,a=0;a<t;a++)l=n.get(a,i),n.set(a,i,n.get(a,u)),n.set(a,u,l)}}(o,u,a,i)}else{let t=new b(o,o),e=new Float64Array(o);for(s=0;s<o;s++)for(n=0;n<o;n++)t.set(n,s,h.get(n,s));!function(t,e,r,n){let s,o,i,a,u,h,c,l=0,f=t-1;for(h=l+1;h<=f-1;h++){for(c=0,a=h;a<=f;a++)c+=Math.abs(e.get(a,h-1));if(0!==c){for(i=0,a=f;a>=h;a--)r[a]=e.get(a,h-1)/c,i+=r[a]*r[a];for(o=Math.sqrt(i),r[h]>0&&(o=-o),i-=r[h]*o,r[h]=r[h]-o,u=h;u<t;u++){for(s=0,a=f;a>=h;a--)s+=r[a]*e.get(a,u);for(s/=i,a=h;a<=f;a++)e.set(a,u,e.get(a,u)-s*r[a])}for(a=0;a<=f;a++){for(s=0,u=f;u>=h;u--)s+=r[u]*e.get(a,u);for(s/=i,u=h;u<=f;u++)e.set(a,u,e.get(a,u)-s*r[u])}r[h]=c*r[h],e.set(h,h-1,c*o)}}for(a=0;a<t;a++)for(u=0;u<t;u++)n.set(a,u,a===u?1:0);for(h=f-1;h>=l+1;h--)if(0!==e.get(h,h-1)){for(a=h+1;a<=f;a++)r[a]=e.get(a,h-1);for(u=h;u<=f;u++){for(o=0,a=h;a<=f;a++)o+=r[a]*n.get(a,u);for(o=o/r[h]/e.get(h,h-1),a=h;a<=f;a++)n.set(a,u,n.get(a,u)+o*r[a])}}}(o,t,e,i),function(t,e,r,n,s){let o,i,a,u,h,c,l,f,g,m,p,w,d,y,b,x=t-1,M=0,v=t-1,E=Number.EPSILON,S=0,N=0,T=0,$=0,D=0,R=0,A=0,k=0;for(o=0;o<t;o++)for((o<M||o>v)&&(r[o]=s.get(o,o),e[o]=0),i=Math.max(o-1,0);i<t;i++)N+=Math.abs(s.get(o,i));for(;x>=M;){for(u=x;u>M&&(R=Math.abs(s.get(u-1,u-1))+Math.abs(s.get(u,u)),0===R&&(R=N),!(Math.abs(s.get(u,u-1))<E*R));)u--;if(u===x)s.set(x,x,s.get(x,x)+S),r[x]=s.get(x,x),e[x]=0,x--,k=0;else if(u===x-1){if(l=s.get(x,x-1)*s.get(x-1,x),T=(s.get(x-1,x-1)-s.get(x,x))/2,$=T*T+l,A=Math.sqrt(Math.abs($)),s.set(x,x,s.get(x,x)+S),s.set(x-1,x-1,s.get(x-1,x-1)+S),f=s.get(x,x),$>=0){for(A=T>=0?T+A:T-A,r[x-1]=f+A,r[x]=r[x-1],0!==A&&(r[x]=f-l/A),e[x-1]=0,e[x]=0,f=s.get(x,x-1),R=Math.abs(f)+Math.abs(A),T=f/R,$=A/R,D=Math.sqrt(T*T+$*$),T/=D,$/=D,i=x-1;i<t;i++)A=s.get(x-1,i),s.set(x-1,i,$*A+T*s.get(x,i)),s.set(x,i,$*s.get(x,i)-T*A);for(o=0;o<=x;o++)A=s.get(o,x-1),s.set(o,x-1,$*A+T*s.get(o,x)),s.set(o,x,$*s.get(o,x)-T*A);for(o=M;o<=v;o++)A=n.get(o,x-1),n.set(o,x-1,$*A+T*n.get(o,x)),n.set(o,x,$*n.get(o,x)-T*A)}else r[x-1]=f+T,r[x]=f+T,e[x-1]=A,e[x]=-A;x-=2,k=0}else{if(f=s.get(x,x),g=0,l=0,u<x&&(g=s.get(x-1,x-1),l=s.get(x,x-1)*s.get(x-1,x)),10===k){for(S+=f,o=M;o<=x;o++)s.set(o,o,s.get(o,o)-f);R=Math.abs(s.get(x,x-1))+Math.abs(s.get(x-1,x-2)),f=g=.75*R,l=-.4375*R*R}if(30===k&&(R=(g-f)/2,R=R*R+l,R>0)){for(R=Math.sqrt(R),g<f&&(R=-R),R=f-l/((g-f)/2+R),o=M;o<=x;o++)s.set(o,o,s.get(o,o)-R);S+=R,f=g=l=.964}for(k+=1,h=x-2;h>=u&&(A=s.get(h,h),D=f-A,R=g-A,T=(D*R-l)/s.get(h+1,h)+s.get(h,h+1),$=s.get(h+1,h+1)-A-D-R,D=s.get(h+2,h+1),R=Math.abs(T)+Math.abs($)+Math.abs(D),T/=R,$/=R,D/=R,h!==u)&&!(Math.abs(s.get(h,h-1))*(Math.abs($)+Math.abs(D))<E*(Math.abs(T)*(Math.abs(s.get(h-1,h-1))+Math.abs(A)+Math.abs(s.get(h+1,h+1)))));)h--;for(o=h+2;o<=x;o++)s.set(o,o-2,0),o>h+2&&s.set(o,o-3,0);for(a=h;a<=x-1&&(y=a!==x-1,a!==h&&(T=s.get(a,a-1),$=s.get(a+1,a-1),D=y?s.get(a+2,a-1):0,f=Math.abs(T)+Math.abs($)+Math.abs(D),0!==f&&(T/=f,$/=f,D/=f)),0!==f);a++)if(R=Math.sqrt(T*T+$*$+D*D),T<0&&(R=-R),0!==R){for(a!==h?s.set(a,a-1,-R*f):u!==h&&s.set(a,a-1,-s.get(a,a-1)),T+=R,f=T/R,g=$/R,A=D/R,$/=T,D/=T,i=a;i<t;i++)T=s.get(a,i)+$*s.get(a+1,i),y&&(T+=D*s.get(a+2,i),s.set(a+2,i,s.get(a+2,i)-T*A)),s.set(a,i,s.get(a,i)-T*f),s.set(a+1,i,s.get(a+1,i)-T*g);for(o=0;o<=Math.min(x,a+3);o++)T=f*s.get(o,a)+g*s.get(o,a+1),y&&(T+=A*s.get(o,a+2),s.set(o,a+2,s.get(o,a+2)-T*D)),s.set(o,a,s.get(o,a)-T),s.set(o,a+1,s.get(o,a+1)-T*$);for(o=M;o<=v;o++)T=f*n.get(o,a)+g*n.get(o,a+1),y&&(T+=A*n.get(o,a+2),n.set(o,a+2,n.get(o,a+2)-T*D)),n.set(o,a,n.get(o,a)-T),n.set(o,a+1,n.get(o,a+1)-T*$)}}}if(0===N)return;for(x=t-1;x>=0;x--)if(T=r[x],$=e[x],0===$)for(u=x,s.set(x,x,1),o=x-1;o>=0;o--){for(l=s.get(o,o)-T,D=0,i=u;i<=x;i++)D+=s.get(o,i)*s.get(i,x);if(e[o]<0)A=l,R=D;else if(u=o,0===e[o]?s.set(o,x,0!==l?-D/l:-D/(E*N)):(f=s.get(o,o+1),g=s.get(o+1,o),$=(r[o]-T)*(r[o]-T)+e[o]*e[o],c=(f*R-A*D)/$,s.set(o,x,c),s.set(o+1,x,Math.abs(f)>Math.abs(A)?(-D-l*c)/f:(-R-g*c)/A)),c=Math.abs(s.get(o,x)),E*c*c>1)for(i=o;i<=x;i++)s.set(i,x,s.get(i,x)/c)}else if($<0)for(u=x-1,Math.abs(s.get(x,x-1))>Math.abs(s.get(x-1,x))?(s.set(x-1,x-1,$/s.get(x,x-1)),s.set(x-1,x,-(s.get(x,x)-T)/s.get(x,x-1))):(b=C(0,-s.get(x-1,x),s.get(x-1,x-1)-T,$),s.set(x-1,x-1,b[0]),s.set(x-1,x,b[1])),s.set(x,x-1,0),s.set(x,x,1),o=x-2;o>=0;o--){for(m=0,p=0,i=u;i<=x;i++)m+=s.get(o,i)*s.get(i,x-1),p+=s.get(o,i)*s.get(i,x);if(l=s.get(o,o)-T,e[o]<0)A=l,D=m,R=p;else if(u=o,0===e[o]?(b=C(-m,-p,l,$),s.set(o,x-1,b[0]),s.set(o,x,b[1])):(f=s.get(o,o+1),g=s.get(o+1,o),w=(r[o]-T)*(r[o]-T)+e[o]*e[o]-$*$,d=2*(r[o]-T)*$,0===w&&0===d&&(w=E*N*(Math.abs(l)+Math.abs($)+Math.abs(f)+Math.abs(g)+Math.abs(A))),b=C(f*D-A*m+$*p,f*R-A*p-$*m,w,d),s.set(o,x-1,b[0]),s.set(o,x,b[1]),Math.abs(f)>Math.abs(A)+Math.abs($)?(s.set(o+1,x-1,(-m-l*s.get(o,x-1)+$*s.get(o,x))/f),s.set(o+1,x,(-p-l*s.get(o,x)-$*s.get(o,x-1))/f)):(b=C(-D-g*s.get(o,x-1),-R-g*s.get(o,x),A,$),s.set(o+1,x-1,b[0]),s.set(o+1,x,b[1]))),c=Math.max(Math.abs(s.get(o,x-1)),Math.abs(s.get(o,x))),E*c*c>1)for(i=o;i<=x;i++)s.set(i,x-1,s.get(i,x-1)/c),s.set(i,x,s.get(i,x)/c)}for(o=0;o<t;o++)if(o<M||o>v)for(i=o;i<t;i++)n.set(o,i,s.get(o,i));for(i=t-1;i>=M;i--)for(o=M;o<=v;o++){for(A=0,a=M;a<=Math.min(i,v);a++)A+=n.get(o,a)*s.get(a,i);n.set(o,i,A)}}(o,u,a,i,t)}this.n=o,this.e=u,this.d=a,this.V=i}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,n=this.e,s=this.d,o=new b(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)o.set(t,e,0);o.set(t,t,s[t]),n[t]>0?o.set(t,t+1,n[t]):n[t]<0&&o.set(t,t-1,n[t])}return o}}function C(t,e,r,n){let s,o;return Math.abs(r)>Math.abs(n)?(s=n/r,o=r+s*n,[(t+s*e)/o,(e-s*t)/o]):(s=r/n,o=n+s*r,[(s*t+e)/o,(s*e-t)/o])}class q{constructor(t){if(!(t=N.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,r,n,s=t,o=s.rows,i=new b(o,o),a=!0;for(r=0;r<o;r++){let t=0;for(n=0;n<r;n++){let o=0;for(e=0;e<n;e++)o+=i.get(n,e)*i.get(r,e);o=(s.get(r,n)-o)/i.get(n,n),i.set(r,n,o),t+=o*o}for(t=s.get(r,r)-t,a&&=t>0,i.set(r,r,Math.sqrt(Math.max(t,0))),n=r+1;n<o;n++)i.set(r,n,0)}this.L=i,this.positiveDefinite=a}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=N.checkMatrix(t);let e=this.L,r=e.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let n,s,o,i=t.columns,a=t.clone();for(o=0;o<r;o++)for(s=0;s<i;s++){for(n=0;n<o;n++)a.set(o,s,a.get(o,s)-a.get(n,s)*e.get(o,n));a.set(o,s,a.get(o,s)/e.get(o,o))}for(o=r-1;o>=0;o--)for(s=0;s<i;s++){for(n=o+1;n<r;n++)a.set(o,s,a.get(o,s)-a.get(n,s)*e.get(n,o));a.set(o,s,a.get(o,s)/e.get(o,o))}return a}get lowerTriangularMatrix(){return this.L}}class P{constructor(e,r={}){e=N.checkMatrix(e);let{Y:n}=r;const{scaleScores:s=!1,maxIterations:o=1e3,terminationCriteria:i=1e-10}=r;let a;if(n){if(n=t.isAnyArray(n)&&"number"==typeof n[0]?b.columnVector(n):N.checkMatrix(n),n.rows!==e.rows)throw new Error("Y should have the same number of rows as X");a=n.getColumnVector(0)}else a=e.getColumnVector(0);let u,h,c,l,f=1;for(let t=0;t<o&&f>i;t++)c=e.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),c=c.div(c.norm()),u=e.mmul(c).div(c.transpose().mmul(c).get(0,0)),t>0&&(f=u.clone().sub(l).pow(2).sum()),l=u.clone(),n?(h=n.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0)),h=h.div(h.norm()),a=n.mmul(h).div(h.transpose().mmul(h).get(0,0))):a=u;if(n){let t=e.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0));t=t.div(t.norm());let r=e.clone().sub(u.clone().mmul(t.transpose())),s=a.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0)),o=n.clone().sub(u.clone().mulS(s.get(0,0)).mmul(h.transpose()));this.t=u,this.p=t.transpose(),this.w=c.transpose(),this.q=h,this.u=a,this.s=u.transpose().mmul(u),this.xResidual=r,this.yResidual=o,this.betas=s}else this.w=c.transpose(),this.s=u.transpose().mmul(u).sqrt(),this.t=s?u.clone().div(this.s.get(0,0)):u,this.xResidual=e.sub(u.mmul(c.transpose()))}}return _t.AbstractMatrix=d,_t.CHO=q,_t.CholeskyDecomposition=q,_t.DistanceMatrix=M,_t.EVD=F,_t.EigenvalueDecomposition=F,_t.LU=T,_t.LuDecomposition=T,_t.Matrix=b,_t.MatrixColumnSelectionView=class extends v{constructor(t,e){f(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},_t.MatrixColumnView=class extends v{constructor(t,e){u(t,e),super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}},_t.MatrixFlipColumnView=class extends v{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},_t.MatrixFlipRowView=class extends v{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},_t.MatrixRowSelectionView=class extends v{constructor(t,e){l(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},_t.MatrixRowView=class extends v{constructor(t,e){a(t,e),super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}},_t.MatrixSelectionView=E,_t.MatrixSubView=class extends v{constructor(t,e,r,n,s){g(t,e,r,n,s),super(t,r-e+1,s-n+1),this.startRow=e,this.startColumn=n}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},_t.MatrixTransposeView=class extends v{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}},_t.NIPALS=P,_t.Nipals=P,_t.QR=D,_t.QrDecomposition=D,_t.SVD=R,_t.SingularValueDecomposition=R,_t.SymmetricMatrix=x,_t.WrapperMatrix1D=S,_t.WrapperMatrix2D=N,_t.correlation=function(e,r=e,n={}){e=new b(e);let s=!1;if("object"!=typeof r||b.isMatrix(r)||t.isAnyArray(r)?r=new b(r):(n=r,r=e,s=!0),e.rows!==r.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:o=!0,scale:i=!0}=n;o&&(e.center("column"),s||r.center("column")),i&&(e.scale("column"),s||r.scale("column"));const a=e.standardDeviation("column",{unbiased:!0}),u=s?a:r.standardDeviation("column",{unbiased:!0}),h=e.transpose().mmul(r);for(let t=0;t<h.rows;t++)for(let r=0;r<h.columns;r++)h.set(t,r,h.get(t,r)*(1/(a[t]*u[r]))*(1/(e.rows-1)));return h},_t.covariance=function(e,r=e,n={}){e=new b(e);let s=!1;if("object"!=typeof r||b.isMatrix(r)||t.isAnyArray(r)?r=new b(r):(n=r,r=e,s=!0),e.rows!==r.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:o=!0}=n;o&&(e=e.center("column"),s||(r=r.center("column")));const i=e.transpose().mmul(r);for(let t=0;t<i.rows;t++)for(let r=0;r<i.columns;r++)i.set(t,r,i.get(t,r)*(1/(e.rows-1)));return i},_t.default=b,_t.determinant=function t(e){if((e=b.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let r,n,s,o;if(2===e.columns)return r=e.get(0,0),n=e.get(0,1),s=e.get(1,0),o=e.get(1,1),r*o-n*s;if(3===e.columns){let o,i,a;return o=new E(e,[1,2],[1,2]),i=new E(e,[1,2],[0,2]),a=new E(e,[1,2],[0,1]),r=e.get(0,0),n=e.get(0,1),s=e.get(0,2),r*t(o)-n*t(i)+s*t(a)}return new T(e).determinant}throw Error("determinant can only be calculated for a square matrix")},_t.inverse=function(t,e=!1){return t=N.checkMatrix(t),e?new R(t).inverse():A(t,b.eye(t.rows))},_t.linearDependencies=function(t,e={}){const{thresholdValue:r=1e-9,thresholdError:n=1e-9}=e;let s=(t=b.checkMatrix(t)).rows,o=new b(s,s);for(let e=0;e<s;e++){let i=b.columnVector(t.getRow(e)),a=t.subMatrixRow(k(s,e)).transpose(),u=new R(a).solve(i),h=b.sub(i,a.mmul(u)).abs().max();o.setRow(e,I(h,u,e,r,n))}return o},_t.pseudoInverse=function(t,e=Number.EPSILON){if((t=b.checkMatrix(t)).isEmpty())return t.transpose();let r=new R(t,{autoTranspose:!0}),n=r.leftSingularVectors,s=r.rightSingularVectors,o=r.diagonal;for(let t=0;t<o.length;t++)Math.abs(o[t])>e?o[t]=1/o[t]:o[t]=0;return s.mmul(b.diag(o).mmul(n.transpose()))},_t.solve=A,_t.wrap=function(e,r){if(t.isAnyArray(e))return e[0]&&t.isAnyArray(e[0])?new N(e):new S(e,r);throw new Error("the argument is not an array")},_t}var Ut=Lt(),Zt=Pt(Ut);const Bt=Ut.EigenvalueDecomposition,Wt=Ut.Matrix;Zt.Matrix?Zt.Matrix:Ut.Matrix;const Qt=Ut.determinant,Kt=Ut.inverse,Jt=Ut.solve;class Xt{constructor(t,e,r,n){this.data_r=t.map((t=>new qt(t).toFixed(6).replace(/\.?0+$/,""))),this.data_i=e.map((t=>new qt(t).toFixed(6).replace(/\.?0+$/,""))),this.rows=r,this.cols=n}toString(){let t=this.data_r.map(((t,e)=>{if("0"===this.data_i[e])return t;return`${t} ${this.data_i[e]>0?"+":""} ${this.data_i[e]}i`.replace(/-/g," ")}));if(1===this.cols)return`[${t.join(",")}]`;let e=[];for(let r=0;r<this.rows;r++){let n=[];for(let e=0;e<this.cols;e++)n.push(t[r*this.cols+e]);e.push(n.join(","))}return`{${e.join(";")}}`}}class Gt{constructor(t,e,r){if(!Array.isArray(t))throw new Error("DMatrix: data ");if(Array.isArray(t[0])&&(t=t.flat()),t.length!==e*r)throw new Error(`DMatrix: data  ${t.length}  rows * cols ${e} * ${r}`);if(!t.every((t=>t instanceof qt)))throw new Error("data Decimal");this.data=t,this.rows=e,this.cols=r}apply(t,e){if(e instanceof Gt){if(this.rows!==e.rows||this.cols!==e.cols)throw new Error("");return new Gt(this.data.map(((r,n)=>t(r,e.data[n]))),this.rows,this.cols)}if("number"==typeof(r=e)||"bigint"==typeof r||r instanceof qt){let r=new Gt(this.data.map((r=>t(r,e))),this.rows,this.cols);return r}var r;throw new Error("")}map(t){return new Gt(this.data.map(t),this.rows,this.cols)}toString(){let t=this.data.map((t=>t.toFixed(6).replace(/\.?0+$/,"")));if(1===this.cols)return`[${t.join(",")}]`;let e=[];for(let r=0;r<this.rows;r++){let n=[];for(let e=0;e<this.cols;e++)n.push(t[r*this.cols+e]);e.push(n.join(","))}return`{${e.join(";")}}`}toMatrix(){let t=[];for(let e=0;e<this.rows;e++){let r=[];for(let t=0;t<this.cols;t++){let n=Number(this.data[e*this.cols+t]);r.push(n)}t.push(r)}return new Wt(t)}static fromMatrix(t){return new Gt(t.to1DArray().map((t=>new qt(t))),t.rows,t.columns)}matmul(t){const e=this.toMatrix(),r=t.toMatrix();if(e.columns!==r.rows)throw new Error("m1  m2 ");const n=e.mmul(r);return Gt.fromMatrix(n)}transpose(){let t=new Array(this.data.length);for(let e=0;e<this.rows;e++)for(let r=0;r<this.cols;r++)t[r*this.rows+e]=this.data[e*this.cols+r];return new Gt(t,this.cols,this.rows)}determinant(){const t=this.toMatrix();return Qt(t)}inverse(){const t=this.toMatrix();let e;if(t.rows!==t.columns)console.log(""),e=t.pseudoInverse();else{let r=Qt(t);Math.abs(r)<1e-6?(console.log("SVD"),e=Kt(t,!0)):e=Kt(t)}return Gt.fromMatrix(e)}eigenvalues(){const t=this.toMatrix(),e=new Bt(t),r=e.realEigenvalues,n=e.imaginaryEigenvalues,s=Gt.fromMatrix(e.eigenvectorMatrix),o=new Xt(r,n,r.length,1);return console.log("",o.toString()),{eigs:o,vecs:s}}solve(t){if(1!=t.cols)throw new Error("");if(this.rows!=t.rows)throw new Error("");const e=this.toMatrix(),r=t.toMatrix();let n,s=Qt(e);return Math.abs(s)<1e-6?(console.log("SVD"),n=Jt(e,r,!0)):n=Jt(e,r),Gt.fromMatrix(n)}}qt.set({precision:21});class te{constructor(t,e,r){this.year=t,this.month=e,this.timestamp=r}getYMString(){let t="";return 0!==this.year&&(t+=this.year+""),0!==this.month&&(t+=this.month+""),""!=t&&(t+="+"),t}toString(){return this.getYMString()+this.timestamp+"ms"}}const ee={pi:qt.acos(-1),e:qt.exp(1)};function re(t){return t instanceof qt}function ne(t){return function(t){return"number"==typeof t}(t)||function(t){return"bigint"==typeof t}(t)||re(t)}function se(t){return t instanceof Date&&!isNaN(t)}function oe(t){return t instanceof te}function ie(t){return t instanceof Gt}function ae(t,e,r,n,s){if(re(e)&&re(r))return n(e,r);if(i=r,ie(o=e)&&ie(i)||ie(o)&&ne(i)||ne(o)&&ie(i))return ie(e)?e.apply(n,r):r.apply(s,e);var o,i;if(typeof e!=typeof r)throw new Error(`${t} : ${typeof e}  ${typeof r}`);throw new Error(`: ${t}`)}const ue={convertTypes(t,e="decimal"){if("decimal"===e)return ie(t)?t:new qt(t.toString());if("number"===e)return Number(t.toString());if("bigint"===e)return BigInt(t.toString());if("string"===e)return t.toString();if("any"===e)return t;throw new Error(` ${t}  ${e} `)},formatToDisplayString(t){if(oe(t))return{value:t.toString(),info:""+ue.formatDateStamp(t)};if(se(t))return{value:t.getTime(),info:""+ue.formatDate(t)};if(re(t)){if(t.toString().includes("e+")||t.toString().includes("e-")){let e=t.toExponential(16),[r,n]=e.split("e");return r=r.replace(/\.?0+$/,""),r+"e"+n}return t.isInteger()?t.toString():t.toFixed(16).replace(/\.?0+$/,"")}return ie(t)?{value:t.toString(),info:"isMatrix"}:t instanceof Xt?{value:t.toString(),info:"isMatrix"}:t.toString()},add(t,e){if("string"==typeof t||"string"==typeof e)return t.toString()+e.toString();if(oe(t)&&oe(e))return new te(t.year+e.year,t.month+e.month,t.timestamp+e.timestamp);if(se(t)&&oe(e)){const r=new Date(t);return r.setFullYear(r.getFullYear()+e.year),r.setMonth(r.getMonth()+e.month),r.setMilliseconds(r.getMilliseconds()+e.timestamp),r}if(se(e)&&oe(t)){const r=new Date(e);return r.setFullYear(r.getFullYear()+t.year),r.setMonth(r.getMonth()+t.month),r.setMilliseconds(r.getMilliseconds()+t.timestamp),r}if(se(t)&&se(e))throw new Error("");let r=(t,e)=>qt(t).plus(qt(e));return ae("",t,e,r,r)},subtract(t,e){if(oe(t)){if(oe(e))return new te(t.year-e.year,t.month-e.month,t.timestamp-e.timestamp);throw se(e)?new Error(" "):new Error("")}if(se(t)){if(oe(e)){const r=new Date(t);return r.setFullYear(r.getFullYear()-e.year),r.setMonth(r.getMonth()-e.month),r.setMilliseconds(r.getMilliseconds()-e.timestamp),r}if(se(e)){const r=t.getTime()-e.getTime();return new te(0,0,r)}throw new Error("")}return ae("",t,e,((t,e)=>qt(t).minus(qt(e))),((t,e)=>qt(e).minus(qt(t))))},multiply(t,e){let r=(t,e)=>t.times(e);return ae("",t,e,r,r)},divide:(t,e)=>ae("",t,e,((t,e)=>t.div(e)),((t,e)=>e.div(t))),floorDivide:(t,e)=>ae("",t,e,((t,e)=>t.div(e).floor()),((t,e)=>e.div(t).floor())),mod:(t,e)=>ae("",t,e,((t,e)=>t.mod(e)),((t,e)=>e.mod(t))),pow:(t,e)=>ae("",t,e,((t,e)=>t.pow(e)),((t,e)=>e.pow(t))),toFixed(t,e){const r=re(t)?t:new qt(t);return r.isInteger()?r.toString():r.toFixed(e).replace(/\.?0+$/,"")},random(...t){if(0===t.length)return qt.random().toFixed(8);if(1===t.length){const e=t[0].toNumber(),r=Array.from({length:e},(()=>qt.random()));return new Gt(r,e,1)}if(2===t.length){const e=t[0].toNumber(),r=t[1].toNumber(),n=Array.from({length:e*r},(()=>qt.random()));return new Gt(n,e,r)}throw new Error(`random(${t.length})0, 1, 2`)},radianToPi(t){const e=(re(t)?t:new qt(t)).div(ee.pi);if(e.isInteger())return e.equals(1)?"":e.equals(-1)?"-":`${e}*`;const r=[2,3,4,6,8,12];for(const t of r){const r=e.toNumber()*t;if(Math.abs(Math.round(r)-r)<1e-8){const e=Math.round(r);return 1===Math.abs(e)?e>0?`/${t}`:`-/${t}`:`${e}*/${t}`}}return`${e.toFixed(6)}*`},radianToDeg(t){let e=(re(t)?t:new qt(t)).times(180).div(ee.pi);return e=e.mod(360),e.lt(0)&&(e=e.plus(360)),e},dateToTimestamp(t){const e=new Date(t);if(isNaN(e.getTime()))throw new Error(`${t}`);return e.getTime()},formatDate(t){if(oe(t))throw new Error(', "> #"');const e=new Date(t);if(isNaN(e.getTime()))throw new Error(`${t}`);const r=e.getFullYear(),n=e.getMonth()+1,s=e.getDate(),o=e.getHours(),i=e.getMinutes(),a=e.getSeconds();return 0===o&&0===i&&0===a?`${r}-${n.toString().padStart(2,"0")}-${s.toString().padStart(2,"0")}`:`${r}-${n.toString().padStart(2,"0")}-${s.toString().padStart(2,"0")} ${o.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},formatDateStamp(t){if(!oe(t))throw new Error('"> #"');const e=t.timestamp,r=Math.abs(e),n=Math.floor(r/1e3%60),s=Math.floor(r/6e4%60),o=Math.floor(r/36e5%24),i=`${e<0?"-":""}${Math.floor(r/864e5)} ${o} ${s} ${n}`;return t.getYMString()+i},formatDateStamp2Week(t){if(!oe(t))throw new Error('"> #w"');const e=(t.timestamp/6048e5).toFixed(2)+"";return t.getYMString()+e},formatDateStamp2Day(t){if(!oe(t))throw new Error('"> #d"');const e=(t.timestamp/864e5).toFixed(2)+"";return t.getYMString()+e},formatDateStamp2Hour(t){if(!oe(t))throw new Error('"> #h"');const e=(t.timestamp/36e5).toFixed(2)+"";return t.getYMString()+e},formatDateStamp2Minute(t){if(!oe(t))throw new Error('"> #m"');const e=(t.timestamp/6e4).toFixed(2)+"";return t.getYMString()+e},formatDateStamp2Second(t){if(!oe(t))throw new Error('"> #s"');const e=(t.timestamp/1e3).toFixed(2)+"";return t.getYMString()+e},str2vec(t){if("["!==(t=t.trim())[0]||"]"!==t[t.length-1])throw new Error("vector[]");let e=(t=(t=t.replace(/\s*\[\s*/g,"")).replace(/\s*\]\s*/g,"")).split(/\s+/).map((t=>qt(t.trim())));if(0===e.length)throw new Error("vector 0");for(let t=0;t<e.length;t++)if(isNaN(e[t]))throw new Error(`vector${t+1}: ${e[t]} `);return new Gt(e,e.length,1)},str2Matrix(t){if("{"!==(t=t.trim())[0]||"}"!==t[t.length-1])throw new Error("matrix{}");let e=(t=(t=(t=t.replace(/\s*\{\s*/g,"")).replace(/\s*\}\s*/g,"")).replace(/\s*;\s*/g,";")).split(";").map((t=>t.trim().split(/\s+/).map(qt)));if(0===e.length)throw new Error("matrix 0");let r=e[0].length;for(let t=0;t<e.length;t++)if(e[t].length!==r)throw new Error("matrix ");let n=e.flat();return new Gt(n,e.length,r)},matmul(t,e){if(ie(t)&&ie(e))return t.matmul(e);throw new Error("")},ones(...t){if(1===t.length){const e=t[0].toNumber(),r=Array.from({length:e},(()=>qt(1)));return new Gt(r,e,1)}if(2===t.length){const e=t[0].toNumber(),r=t[1].toNumber(),n=Array.from({length:e*r},(()=>qt(1)));return new Gt(n,e,r)}throw new Error(`ones(${t.length})1, 2`)},zeros(...t){if(1===t.length){const e=t[0].toNumber(),r=Array.from({length:e},(()=>qt(0)));return new Gt(r,e,1)}if(2===t.length){const e=t[0].toNumber(),r=t[1].toNumber(),n=Array.from({length:e*r},(()=>qt(0)));return new Gt(n,e,r)}throw new Error(`zeros(${t.length})1, 2`)},eye(t){if((t=t.toNumber())<1)throw new Error("eye");const e=Array.from({length:t},(()=>qt(1))),r=new Gt(e,t,1);return ue.diag(r)},diag(t){if(!ie(t))throw new Error("diag");if(1!==t.rows&&1!==t.cols)throw new Error("diag");const e=t.data,r=Math.max(t.rows,t.cols),n=Array.from({length:r},((t,n)=>Array.from({length:r},((t,r)=>qt(n===r?e[n]:0)))));return new Gt(n,r,r)},range(...t){let e,r,n;if(1===t.length)e=0,r=t[0].toNumber(),n=1;else if(2===t.length)e=t[0].toNumber(),r=t[1].toNumber(),n=1;else{if(3!==t.length)throw new Error(`range(${t.length})1, 2, 3`);e=t[0].toNumber(),r=t[1].toNumber(),n=t[2].toNumber()}if(0===n)throw new Error("rangestep0");const s=Math.floor((r-e)/n),o=Array.from({length:s},((t,r)=>qt(e+r*n)));return new Gt(o,s,1)},solve(t,e){if(ie(t)&&ie(e)){if(1!==e.cols)throw new Error("solve");return t.solve(e)}throw new Error("solve")},transpose(t){if(ie(t))return t.transpose();throw new Error("transpose")},inverse(t){if(ie(t))return t.inverse();throw new Error("inverse")},eigenvalues(t){if(ie(t)){const{eigs:e,vecs:r}=t.eigenvalues();return e}throw new Error("eigenvalues")},determinant(t){if(ie(t))return t.determinant();throw new Error("determinant")}},he={"":ee.pi,PI:ee.pi,pi:ee.pi,e:ee.e,E:ee.e},ce={"(":{description:""},")":{description:""}},le={",":{description:""}},fe={"+":{precedence:2,args:2,func:ue.add,argTypes:"any",position:"infix",description:""},"-":{precedence:2,args:2,func:ue.subtract,argTypes:"any",position:"infix",description:""},"*":{precedence:4,args:2,func:ue.multiply,position:"infix",description:""},"/":{precedence:4,args:2,func:ue.divide,position:"infix",description:""},"//":{precedence:4,args:2,func:ue.floorDivide,position:"infix",description:""},"%":{precedence:4,args:2,func:ue.mod,position:"infix",description:""},"**":{precedence:7,args:2,func:ue.pow,position:"infix",description:""},"":{alias:".rad",description:""},"unary-":{precedence:5,args:1,func:t=>t.neg(),position:"prefix",description:""},"unary+":{precedence:5,args:1,func:t=>t,position:"prefix",description:""},"unary%":{precedence:5,args:1,func:t=>t.times(.01),position:"postfix",preventSelfReference:!0,description:""},"":{precedence:5,args:1,func:t=>t.times(.001),position:"postfix",preventSelfReference:!0,description:""},"&":{precedence:1,args:2,func:(t,e)=>(console.log(typeof t,typeof e),t&e),position:"infix",argTypes:"bigint",description:""},and:{alias:"&",description:""},"|":{precedence:1,args:2,func:(t,e)=>t|e,position:"infix",argTypes:"bigint",description:""},or:{alias:"|",description:""},"^":{precedence:1,args:2,func:(t,e)=>t^e,position:"infix",argTypes:"bigint",description:""},"~":{precedence:6,args:1,func:t=>~t,position:"prefix",argTypes:"bigint",description:""},not:{alias:"~",description:""},"<<":{precedence:3,args:2,func:(t,e)=>t<<e,position:"infix",argTypes:"bigint",description:""},">>":{precedence:3,args:2,func:(t,e)=>t>>e,position:"infix",argTypes:"bigint",description:""},">>>":{precedence:3,args:2,func:(t,e)=>t>>>e,position:"infix",argTypes:"number",description:""},"=":{precedence:0,args:2,func:(t,e)=>e,position:"infix",argTypes:"any",isCompoundAssignment:!0,description:""},"+=":{precedence:0,args:2,func:(t,e)=>t.add(e),position:"infix",description:"",isCompoundAssignment:!0},"-=":{precedence:0,args:2,func:(t,e)=>t.sub(e),position:"infix",description:"",isCompoundAssignment:!0},"*=":{precedence:0,args:2,func:(t,e)=>t.mul(e),position:"infix",description:"",isCompoundAssignment:!0},"/=":{precedence:0,args:2,func:(t,e)=>t.div(e),position:"infix",description:"",isCompoundAssignment:!0},"&=":{precedence:0,args:2,func:(t,e)=>t&e,position:"infix",argTypes:"bigint",description:"",isCompoundAssignment:!0},"|=":{precedence:0,args:2,func:(t,e)=>(console.log("|=",t,e),console.log("oldValue:",typeof t),console.log("rightValue:",typeof e),t|e),position:"infix",argTypes:"bigint",description:"",isCompoundAssignment:!0},"^=":{precedence:0,args:2,func:(t,e)=>t^e,position:"infix",argTypes:"bigint",description:"",isCompoundAssignment:!0},"<<=":{precedence:0,args:2,func:(t,e)=>t<<e,position:"infix",argTypes:"bigint",description:"",isCompoundAssignment:!0},">>=":{precedence:0,args:2,func:(t,e)=>t>>e,position:"infix",argTypes:"bigint",description:"",isCompoundAssignment:!0},">>>=":{precedence:0,args:2,func:(t,e)=>t>>>e,position:"infix",argTypes:"number",description:"",isCompoundAssignment:!0},"matmul@":{precedence:4,args:2,func:ue.matmul,position:"infix",description:""},"@":{precedence:1,args:1,func:ue.dateToTimestamp,position:"prefix",argTypes:"any",description:""},">@":{precedence:0,args:1,func:ue.formatDate,position:"postfix",argTypes:"any",description:""},">#":{precedence:0,args:1,func:ue.formatDateStamp,position:"postfix",argTypes:"any",description:""},">#w":{precedence:0,args:1,func:ue.formatDateStamp2Week,position:"postfix",argTypes:"any",description:""},">#W":{alias:">#w",description:""},">#d":{precedence:0,args:1,func:ue.formatDateStamp2Day,position:"postfix",argTypes:"any",description:""},">#D":{alias:">#d",description:""},">#h":{precedence:0,args:1,func:ue.formatDateStamp2Hour,position:"postfix",argTypes:"any",description:""},">#H":{alias:">#h",description:""},">#m":{precedence:0,args:1,func:ue.formatDateStamp2Minute,position:"postfix",argTypes:"any",description:""},">#M":{alias:">#m",description:""},">#s":{precedence:0,args:1,func:ue.formatDateStamp2Second,position:"postfix",argTypes:"any",description:""},">#S":{alias:">#s",description:""}},ge={str:{func:t=>t.toString(),args:1,argTypes:"any",description:""},num:{func:t=>t,args:1,description:""},max:{func:(...t)=>qt.max(...t),args:-1,description:""},min:{func:(...t)=>qt.min(...t),args:-1,description:""},lg:{func:t=>qt.log10(t),args:1,description:"10"},lb:{func:t=>qt.log2(t),args:1,description:"2"},log:{func:(t,e)=>qt.log(e,t),args:2,description:"xy"},ln:{func:t=>qt.ln(t),args:1,description:""},exp:{func:t=>qt.exp(t),args:1,description:"e"},round:{func:t=>qt.round(t),args:1,description:""},roundfix:{func:(t,e)=>((e=e.toNumber())<0&&(e=t.decimalPlaces()+e),e=Math.max(0,e),t.toDecimalPlaces(e)),args:2,description:", "},floor:{func:t=>qt.floor(t),args:1,description:""},ceil:{func:t=>qt.ceil(t),args:1,description:""},clamp:{func:(t,e,r)=>qt.clamp(t,e,r),args:3,description:""},random:{func:(...t)=>ue.random(...t),args:-2,description:"0~1"},sin:{func:t=>qt.sin(t),args:1,description:""},cos:{func:t=>qt.cos(t),args:1,description:""},tan:{func:t=>qt.tan(t),args:1,description:""},asin:{func:t=>qt.asin(t),args:1,repr:t=>": "+ue.radianToPi(t)+" | : "+ue.toFixed(ue.radianToDeg(t),3)+"",description:""},acos:{func:t=>qt.acos(t),args:1,repr:t=>": "+ue.radianToPi(t)+" | : "+ue.toFixed(ue.radianToDeg(t),3)+"",description:""},atan:{func:t=>qt.atan(t),args:1,repr:t=>": "+ue.radianToPi(t)+" | : "+ue.toFixed(ue.radianToDeg(t),3)+"",description:""},sinh:{func:t=>qt.sinh(t),args:1,description:""},cosh:{func:t=>qt.cosh(t),args:1,description:""},tanh:{func:t=>qt.tanh(t),args:1,description:""},sqrt:{func:t=>t.sqrt(),args:1,description:""},pow:{func:ue.pow,args:2,description:""},abs:{args:1,func:t=>t.abs(),asProperty:!0,description:""},rad:{args:1,func:t=>t.times(ee.pi).div(180),asProperty:!0,preventSelfReference:!0,repr:t=>": "+ue.radianToPi(t)+" | : "+ue.toFixed(ue.radianToDeg(t),3)+"",description:""},deg:{args:1,func:ue.radianToDeg,asProperty:!0,preventSelfReference:!0,repr:t=>": "+ue.toFixed(t,3)+"",description:""},upper:{args:1,func:t=>t.toUpperCase(),argTypes:"any",asProperty:!0,description:""},lower:{args:1,func:t=>t.toLowerCase(),argTypes:"any",asProperty:!0,description:""},length:{args:1,func:t=>t.length,argTypes:"any",asProperty:!0,description:""},bin:{args:1,func:t=>"0b"+t.toString(2),asProperty:!0,argTypes:"bigint",description:""},oct:{args:1,func:t=>"0o"+t.toString(8),asProperty:!0,argTypes:"bigint",description:""},hex:{args:1,func:t=>"0x"+t.toString(16),asProperty:!0,argTypes:"bigint",description:""},base64:{args:1,func:t=>{try{return"string"!=typeof t&&(t=String(t)),btoa(t)}catch(t){throw new Error("Base64: "+t.message)}},description:"Base64",argTypes:"any",asProperty:!0},unbase64:{args:1,func:t=>{try{return"string"!=typeof t&&(t=String(t)),atob(t)}catch(t){throw new Error("Base64: "+t.message)}},description:"Base64",argTypes:"any",asProperty:!0},timestamp:{args:8,func:(t=0,e=0,r=0,n=0,s=0,o=0,i=0,a=0)=>{const u=Number(t),h=Number(e);if(!Number.isInteger(u)||!Number.isInteger(h))throw new Error(`:${u} :${h} `);return new te(u,h,1e3*(60*(60*(24*(7*r+n)+s)+o)+i)+a)},argTypes:"number",description:"",hidden:!0},eye:{func:ue.eye,args:1,description:""},diag:{func:ue.diag,args:1,description:""},ones:{func:(...t)=>ue.ones(...t),args:-1,description:"1"},zeros:{func:(...t)=>ue.zeros(...t),args:-1,description:"0"},range:{func:(...t)=>ue.range(...t),args:-1,description:""},solve:{func:ue.solve,args:2,description:""},T:{func:ue.transpose,args:1,description:"",asProperty:!0,hidden:!0},transpose:{alias:"T",description:""},inv:{func:ue.inverse,args:1,description:"",asProperty:!0},det:{func:ue.determinant,args:1,description:"",asProperty:!0},eigenvalues:{func:ue.eigenvalues,args:1,description:""}},me=new Map;function pe(t,e){const r=new Date;let n;switch(e){case"now":n=r;break;case"today":n=new Date(r.getFullYear(),r.getMonth(),r.getDate());break;case"YYYY-MM-DD HH:mm:ss":n=new Date(t);break;case"YYYY-MM-DD HH:mm":n=new Date(t+":00");break;case"YYYY-MM-DD":n=new Date(t+"T00:00:00");break;case"MM-DD HH:mm:ss":t=t.replace(/^(\d{1,2})-(\d{1,2})/,((t,e,r)=>`${e.padStart(2,"0")}-${r.padStart(2,"0")}`)),n=new Date(r.getFullYear()+"-"+t);break;case"MM-DD HH:mm":t=t.replace(/^(\d{1,2})-(\d{1,2})/,((t,e,r)=>`${e.padStart(2,"0")}-${r.padStart(2,"0")}`)),n=new Date(r.getFullYear()+"-"+t+":00");break;case"YYYY-MM":n=new Date(t+"-01T00:00:00");break;case"MM-DD":t=t.replace(/(\d{1,2})-(\d{1,2})/,((t,e,r)=>`${e.padStart(2,"0")}-${r.padStart(2,"0")}`)),n=new Date(r.getFullYear()+"-"+t+"T00:00:00");break;case"YYYY":n=new Date(t+"-01-01T00:00:00");break;case"HH:mm:ss":{const[e,r,s]=t.split(":").map(Number);return n=new Date(0),n.setUTCHours(e,r,s),new te(0,0,n.getTime())}case"HH:mm":{const[e,r]=t.split(":").map(Number);return n=new Date(0),n.setUTCHours(e,r,0),new te(0,0,n.getTime())}default:return null}return isNaN(n.getTime())?null:n}const we=function(){const t=100,e=new Map,r=[],n=[];function s(t){r.includes(t)||r.push(t)}function o(t){n.includes(t)||n.push(t)}function i(){r.length=0,n.length=0}function a(r,n,o,i){const a=function(t){const e={"":"(","":")","":",","":'"',"":";","":"'","":"[","":"]","":"{","":"}","":"<","":">","":"+","":"-","":"=","":"/","":".","":"[","":"]","":"{","":"}","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},r=new RegExp(Object.keys(e).join("|"),"g");return t.replace(r,(t=>e[t]||t))}(r);a!==r&&s(`: "${a}"`),r=a,me.clear(),r=function(t){let e=0;return t=(t=t.replace(/\[([\d\s]+)\]/g,((t,r)=>{const n="_cc_mat_i"+e++,s=ue.str2vec(t);return me.set(n,s),n}))).replace(/\{([^{}]+)\}/g,((t,r)=>{const n="_cc_mat_i"+e++,s=ue.str2Matrix(t);return me.set(n,s),n})),t}(r=function(t){let e=0,r=t.replace(/str\s*\(((?:[^)(]|\([^)(]*\))*)\)/g,((t,r)=>{const n="_cc_str_i"+e++;return me.set(n,r.trim()),n}));if(r=r.replace(/(['"`])((?:\\.|[^\\])*?)\1/g,((t,r,n)=>{const s="_cc_str_i"+e++,o=n.replace(/\\(['"\\`])/g,"$1");return me.set(s,o),s})),/['"`][^'"`]*$/.test(r))throw new Error("");return r}(r=function(t){function e(t){const e=["years?","y","months?","m","weeks?","w","days?","d","hours?","h","minutes?","mm","seconds?","s","milliseconds?","ms"].join("|"),r=new RegExp(`([+-]?\\d+\\.?\\d*)(${e})`,"gi");return t.replace(r,"($1)$2")}function r(t){if(""===t.trim())return t;const e={years:["y","year","years"],months:["m","month","months"],weeks:["w","week","weeks"],days:["d","day","days"],hours:["h","hour","hours"],minutes:["mm","minute","minutes"],seconds:["s","second","seconds"],milliseconds:["ms","millisecond","milliseconds"]},r="START",n="EXPECT_OPEN",s="IN_BRACKETS",o="EXPECT_UNIT",i="END";let a=r,u=0,h="",c=0,l={years:"0",months:"0",weeks:"0",days:"0",hours:"0",minutes:"0",seconds:"0",milliseconds:"0"},f=Object.keys(e),g=0;const m={y:["years","year","y"],m:["milliseconds","millisecond","minutes","months","minute","month","mins","min","mm","ms","m"],w:["weeks","week","w"],d:["days","day","d"],h:["hours","hour","h"],s:["seconds","second","s"]};for(;u<t.length&&a!==i;){const p=t[u];switch(a){case r:if("("===p)a=s,c=1,h="";else if(p.trim())throw m[p]?new Error(`:${t.slice(u,u+5)+"..."} `):new Error("");break;case n:"("===p?(a=s,c=1,h=""):p.trim()&&"+"!==p&&"-"!==p&&(0===g&&(g=u),a=i);break;case s:if("("===p)c++,h+=p;else if(")"===p)if(c--,0===c){if(!h.trim())throw new Error("");a=o}else h+=p;else h+=p;break;case o:let w=u,d={length:0,unitKey:"",value:h,endPos:u};const y=t[u].toLowerCase();if(m[y]){const r=m[y];for(const n of r)if(t.slice(u,u+n.length).toLowerCase()===n){let t;for(const[r,s]of Object.entries(e))if(s.includes(n)){if("0"!==l[r])throw new Error(`:${r} `);t=r;break}if(t){d={length:n.length,unitKey:t,value:h,endPos:u+n.length-1},u+=n.length-1;break}}}d.length>0?(l[d.unitKey]=d.value,u=d.endPos,g=u+1,f.indexOf(d.unitKey),a=n):(u=w,a=n)}u++}let p=`timestamp(${[l.years||"0",l.months||"0",l.weeks||"0",l.days||"0",l.hours||"0",l.minutes||"0",l.seconds||"0",l.milliseconds||"0"].join(", ")})`;if(g<t.length){const e=t.substring(g).trim();e&&(p+=" "+e)}return p}const n=(t=t.replace(/>\s*#/g,">timestamp")).split("#");let s=n[0];for(let t=1;t<n.length;t++)s+=r(e(n[t]));return s=s.replace(/>timestamp/g,">#"),s}(r=function(t){let e=0;const r=[{regex:/(@)\s*(\d{4})-(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2}):(\d{1,2})/,format:"YYYY-MM-DD HH:mm:ss",extract:t=>`${t[2]}-${t[3].padStart(2,"0")}-${t[4].padStart(2,"0")} ${t[5]}:${t[6]}:${t[7]}`},{regex:/(@)\s*(\d{4})-(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2})/,format:"YYYY-MM-DD HH:mm",extract:t=>`${t[2]}-${t[3].padStart(2,"0")}-${t[4].padStart(2,"0")} ${t[5]}:${t[6]}`},{regex:/(@)\s*(\d{4})-(\d{1,2})-(\d{1,2})/,format:"YYYY-MM-DD",extract:t=>`${t[2]}-${t[3].padStart(2,"0")}-${t[4].padStart(2,"0")}`},{regex:/(@)\s*(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2}):(\d{1,2})/,format:"MM-DD HH:mm:ss",extract:t=>`${t[2].padStart(2,"0")}-${t[3].padStart(2,"0")} ${t[4]}:${t[5]}:${t[6]}`},{regex:/(@)\s*(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2})/,format:"MM-DD HH:mm",extract:t=>`${t[2].padStart(2,"0")}-${t[3].padStart(2,"0")} ${t[4]}:${t[5]}`},{regex:/(@)\s*(\d{4})-(\d{1,2})/,format:"YYYY-MM",extract:t=>`${t[2]}-${t[3].padStart(2,"0")}`},{regex:/(#)\s*(\d{1,2}):(\d{1,2}):(\d{1,2})/,format:"HH:mm:ss",extract:t=>`${t[2].padStart(2,"0")}:${t[3].padStart(2,"0")}:${t[4].padStart(2,"0")}`},{regex:/(#)\s*(\d{1,2}):(\d{1,2})/,format:"HH:mm",extract:t=>`${t[2].padStart(2,"0")}:${t[3].padStart(2,"0")}`},{regex:/(@)\s*(\d{1,2})-(\d{1,2})/,format:"MM-DD",extract:t=>`${t[2].padStart(2,"0")}-${t[3].padStart(2,"0")}`},{regex:/(@)\s*(\d{4})/,format:"YYYY",extract:t=>t[2]},{regex:/(@)\s*(now)/,format:"now",extract:t=>t[2]},{regex:/(@)\s*(today)/,format:"today",extract:t=>t[2]}];let n;do{n=t;for(const{regex:n,format:s,extract:o}of r){const r=n.exec(t);if(r){const n=pe(o(r),s);if(n){const s="_cc_date_i"+e++;me.set(s,n),t=t.substring(0,r.index)+s+t.substring(r.index+r[0].length);break}}}}while(t!==n);return t}(r)))),r=r.replace(/\s/g,"");for(const[t,r]of me)e.set(t,r);!function(t,e=1e3){const r=t.replace(/'[^']*'|"[^"]*"/g,""),n=[];let s=0;for(let t=0;t<r.length;t++)if("("===r[t]){if(n.push(t),s=Math.max(s,n.length),s>e)throw new Error("")}else if(")"===r[t]){if(0===n.length)throw new Error(`: ${t}`);const e=n.pop();if(t-e>1e3)throw new Error(`: ${e}`)}if(n.length>0){const t=n.join(", ");throw new Error(`: ${t}`)}const o=[{pattern:/\)[\w\d]/,message:""},{pattern:/\)\(/,message:""},{pattern:/,\s*\)/,message:""},{pattern:/\(\s*,/,message:""}];for(const{pattern:t,message:e}of o)if(t.test(r))throw new Error(`: ${e}`)}(r,t);for(const[t,e]of Object.entries(ge))e.asProperty&&(n.add("."+t),fe["."+t]={precedence:8,args:1,func:e.func,position:"postfix",...e.argTypes&&{argTypes:e.argTypes},...e.repr&&{repr:e.repr},...e.preventSelfReference&&{preventSelfReference:e.preventSelfReference}});return{expr:r,operators:new Set([...n].sort(((t,e)=>e.length-t.length)))}}function u(t,r,n,o){function i(){if(0===u.length)return!0;const[t,e]=u[u.length-1];return"%"!==e&&""!==e&&!("string"===t||"constant"===t||"delimiter"===t&&")"===e||"function"===t||"identifier"===t||"operator"===t&&e.startsWith("."))}function a(){let e="";for(;h<t.length;){const r=t[h],s=e+r;if("0"===e&&("x"===r||"b"===r||"o"===r)){e+=r,h++;continue}if(/^\d+\.?\d*$/.test(e)&&("e"===r||"E"===r)){for(e+=r,h++,h<t.length&&("+"===t[h]||"-"===t[h])&&(e+=t[h],h++);h<t.length&&/\d/.test(t[h]);)e+=t[h],h++;continue}if(c.has(r)||l.has(r))break;const i=f.some((e=>t.startsWith(e,h))),a=[...n,...o].some((t=>t.startsWith(s)));if(i&&!a)break;e+=r,h++}return e}const u=[];let h=0;const c=new Set(Object.keys(ce)),l=new Set(Object.keys(le)),f=[...r].sort(((t,e)=>e.length-t.length));for(;h<t.length;){const e=t[h],r=t.slice(h);let s=!1;for(const t of f)if(r.startsWith(t)){("="===t||fe[t].isCompoundAssignment)&&u.length>0&&"string"===u[u.length-1][0]&&(u[u.length-1][0]="identifier"),"+"===t?i()?u.push(["operator","unary+"]):u.push(["operator","+"]):"-"===t?i()?u.push(["operator","unary-"]):u.push(["operator","-"]):l.has(t)?u.push(["separator",t]):c.has(t)?u.push(["delimiter",t]):fe[t]&&fe[t].alias?u.push(["operator",fe[t].alias]):u.push(["operator",t]),h+=t.length,s=!0;break}if(!s)if(l.has(e))u.push(["separator",e]),h++;else if(c.has(e))u.push(["delimiter",e]),h++;else{const t=a();t&&(n.has(t)?ge[t]&&ge[t].alias?u.push(["function",ge[t].alias]):u.push(["function",t]):o.has(t)?u.push(["constant",t]):u.push(["string",t]))}}const g=function(t){if(!t.some((t=>("identifier"===t[0]||"string"===t[0])&&"x"===t[1]))&&!e.has("x"))for(let r=0;r<t.length;r++)if("string"===t[r][0]){if(t[r][1].startsWith("0x"))continue;if(e.has(t[r][1]))continue;const n=t[r][1].split("x");if(n.length>1){const e=[];for(let t=0;t<n.length;t++)n[t]&&(o.has(n[t])?e.push(["constant",n[t]]):e.push(["string",n[t]])),t<n.length-1&&(e.push(["operator","*"]),s("x"));t.splice(r,1,...e),r+=e.length-1}}return t}(u);return g}function h(e,r,n){let s=0,o=0;const i=e.filter((t=>{const[e]=t;return"delimiter"!==e&&"separator"!==e})).length;let a=0;function u(){if(o>t)throw new Error("")}function h(t,e,r){return a++,{value:t,args:e,type:r}}function c(){if(s>=e.length)throw new Error("");const[t,r]=e[s];switch(s++,t){case"function":return function(t){l("(");const r=[];for(;s<e.length&&("delimiter"!==e[s][0]||")"!==e[s][1]);)r.push(f(0)),"separator"===e[s][0]&&s++;return l(")"),h(t,r,"function")}(r);case"constant":case"identifier":case"string":return h(r,[],t);case"delimiter":if("("===r){const t=f(0);return l(")"),t}throw new Error(`: ${r}`);default:throw new Error(`token: ${t}`)}}function l(t){if(s>=e.length||"delimiter"!==e[s][0]||e[s][1]!==t)throw new Error(` "${t}"`);s++}function f(t=0){o++,u();let r=function(){if(o++,u(),s>=e.length)throw new Error("");const[t,r]=e[s];if("operator"===t&&fe[r]&&"prefix"===fe[r].position){s++;const t=f(fe[r].precedence);return o--,h(r,[t],"operator")}return o--,c()}(t);for(;s<e.length;){const[n,o]=e[s];if("operator"===n&&"%"===o){const n=e[s+1];if(n&&("string"===n[0]||"constant"===n[0]||"function"===n[0]||"delimiter"===n[0]&&"("===n[1])){if(fe["%"].precedence<t)break;s++;r=h("%",[r,f(fe["%"].precedence+1)],"operator")}else s++,r=h("unary%",[r],"operator");continue}if("operator"===n&&"@"===o){const n=e[s-1];if(n&&("string"===n[0]||"constant"===n[0]||"function"===n[0]||"delimiter"===n[0]&&")"===n[1])){if(fe["matmul@"].precedence<t)break;s++;r=h("matmul@",[r,f(fe["matmul@"].precedence+1)],"operator")}else{s++;r=h("@",[f(fe["@"].precedence+1)],"operator")}continue}if("operator"===n&&fe[o]&&"postfix"===fe[o].position){if(fe[o].precedence<t)break;s++,r=h(o,[r],"operator");continue}if("operator"!==n||!fe[o]||fe[o].precedence<t||"infix"!==fe[o].position)break;s++;const i=fe[o];r=h(o,[r,f(i.isCompoundAssignment?i.precedence:i.precedence+1)],"operator")}return o--,r}const g=f();if(a<i)throw new Error(`AST(${a} < ${i})`);return function e(r,n=0){if(n>t)throw new Error("");if("function"===r.type){const t=r.value;if(ge[t]&&ge[t].preventSelfReference&&r.args.some((e=>"function"===e.type&&e.value===t)))throw new Error(` ${t} `)}else if("operator"===r.type){const t=r.value;if(fe[t]&&fe[t].preventSelfReference&&r.args.some((e=>"operator"===e.type&&e.value===t)))throw new Error(` ${t} `)}r.args?.forEach((t=>e(t,n+1)))}(g),g}function c(t,e){return e?t.map((t=>ue.convertTypes(t,e))):t.map((t=>ue.convertTypes(t)))}function l(r,n,i,a,u=0){if(u>t)throw new Error("");if(!r)return 0;if("string"===r.type)return e.has(r.value)?e.get(r.value):ue.convertTypes(r.value);if("identifier"===r.type)return e.has(r.value)?e.get(r.value):r.value;if("constant"===r.type)return he[r.value];const h=r.args.map((t=>l(t,n,i,a,u+1)));if("operator"===r.type){const t=fe[r.value];if(void 0!==t.args&&h.length!==t.args)throw new Error(` "${r.value}"  ${t.args}  ${h.length} `);if(t.isCompoundAssignment){const[h,f]=r.args;if("identifier"!==h.type&&"string"!==h.type)throw new Error("");!function(t,e,r,n){if(!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(t)){if(/\s/.test(t))throw new Error(` "${t}" `);throw new Error(` "${t}" `)}if(t.startsWith("_cc_"))throw new Error(' "_cc_" ');if(e.hasOwnProperty(t))throw new Error(` "${t}" `);if(r.hasOwnProperty(t))throw new Error(` "${t}" `);if(n.hasOwnProperty(t))throw new Error(` "${t}" `);if(["if","else","true","false","null","undefined"].includes(t))throw new Error(` "${t}" `)}(h.value,n,i,a);const g=l(f,n,i,a,u+1);if("="===r.value)return e.set(h.value,g),o(` ${h.value}: ${g}`),"x"===h.value&&s("x"),g;{if(!e.has(h.value))throw new Error(` "${h.value}" `);const r=c([e.get(h.value),g],t.argTypes),n=t.func(...r);return e.set(h.value,n),n}}const f=c(h,t.argTypes);return t.func(...f)}if("function"===r.type){const t=ge[r.value];if(void 0!==t.args)if(-1===t.args){if(0===h.length)throw new Error(` "${r.value}" 1`)}else if(-2===t.args);else if(h.length!==t.args)throw new Error(` "${r.value}"  ${t.args}  ${h.length} `);const e=c(h,t.argTypes);return t.func(...e)}throw new Error(`: ${r.type}`)}return{calculate(t){i();const e=new Set(Object.keys(fe)),c=new Set(Object.keys(ge)),f=new Set(Object.keys(he)),{expr:g,operators:m}=a(t,e),p=h(u(g,m,c,f)),w=function(t,e){if("object"==typeof(t=ue.formatToDisplayString(t))&&null!==t&&(t.info&&o(t.info),t.warning&&s(t.warning),t=t.value),!e)return{value:t,info:n.length>0?n:null,warning:r.length>0?r:null};try{let s,i=e;if("operator"===i.type&&"="===i.value&&(i=i.args[1]),"function"===i.type&&ge[i.value]?s=ge[i.value].repr:"operator"===i.type&&fe[i.value]&&(s=fe[i.value].repr),"function"==typeof s)try{const e=s(t);void 0!==e&&o(e)}catch(t){throw new Error(`${t.message}`)}return{value:t,info:n.length>0?n:null,warning:r.length>0?r:null}}catch(e){return s(`: ${e.message}`),{value:t,info:n.length>0?n:null,warning:r.length>0?r:null}}}(l(p,e,c,f),p);return w},getASTNode(t){const e=new Set(Object.keys(fe)),r=new Set(Object.keys(ge)),n=new Set(Object.keys(he)),{expr:s,operators:o}=a(t,e);return h(u(s,o,r,n))},getCfg:()=>({operators:new Set(Object.keys(fe)),functions:new Set(Object.keys(ge)),constants:new Set(Object.keys(he))}),tokenize:(t,e,r,n)=>u(t,e,r,n),preprocess:(t,e,r,n)=>a(t,e),getAllVariables:()=>Object.fromEntries(e),clearAllCache(){e.clear(),i()}}}();export{he as CONSTANTS,we as Calculator,ge as FUNCTIONS,fe as OPERATORS};
