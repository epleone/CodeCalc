/*!
 *  decimal.js v10.5.0
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */
var e,t,n=9e15,r=1e9,i="0123456789abcdef",s="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",o="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",a={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-9e15,maxE:n,crypto:!1},c=!0,u="[DecimalError] ",f=u+"Invalid argument: ",p=u+"Precision limit exceeded",l=u+"crypto unavailable",d="[object Decimal]",g=Math.floor,h=Math.pow,m=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,w=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,y=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,v=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,x=1e7,b=s.length-1,E=o.length-1,N={toStringTag:d};function S(e){var t,n,r,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)(n=7-(r=e[t]+"").length)&&(s+=H(n)),s+=r;(n=7-(r=(o=e[t])+"").length)&&(s+=H(n))}else if(0===o)return"0";for(;o%10==0;)o/=10;return s+o}function $(e,t,n){if(e!==~~e||e<t||e>n)throw Error(f+e)}function M(e,t,n,r){var i,s,o,a;for(s=e[0];s>=10;s/=10)--t;return--t<0?(t+=7,i=0):(i=Math.ceil((t+1)/7),t%=7),s=h(10,7-t),a=e[i]%s|0,null==r?t<3?(0==t?a=a/100|0:1==t&&(a=a/10|0),o=n<4&&99999==a||n>3&&49999==a||5e4==a||0==a):o=(n<4&&a+1==s||n>3&&a+1==s/2)&&(e[i+1]/s/100|0)==h(10,t-2)-1||(a==s/2||0==a)&&!(e[i+1]/s/100|0):t<4?(0==t?a=a/1e3|0:1==t?a=a/100|0:2==t&&(a=a/10|0),o=(r||n<4)&&9999==a||!r&&n>3&&4999==a):o=((r||n<4)&&a+1==s||!r&&n>3&&a+1==s/2)&&(e[i+1]/s/1e3|0)==h(10,t-3)-1,o}function T(e,t,n){for(var r,s,o=[0],a=0,c=e.length;a<c;){for(s=o.length;s--;)o[s]*=t;for(o[0]+=i.indexOf(e.charAt(a++)),r=0;r<o.length;r++)o[r]>n-1&&(void 0===o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}N.absoluteValue=N.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),k(e)},N.ceil=function(){return k(new this.constructor(this),this.e+1,2)},N.clampedTo=N.clamp=function(e,t){var n=this,r=n.constructor;if(e=new r(e),t=new r(t),!e.s||!t.s)return new r(NaN);if(e.gt(t))throw Error(f+t);return n.cmp(e)<0?e:n.cmp(t)>0?t:new r(n)},N.comparedTo=N.cmp=function(e){var t,n,r,i,s=this,o=s.d,a=(e=new s.constructor(e)).d,c=s.s,u=e.s;if(!o||!a)return c&&u?c!==u?c:o===a?0:!o^c<0?1:-1:NaN;if(!o[0]||!a[0])return o[0]?c:a[0]?-u:0;if(c!==u)return c;if(s.e!==e.e)return s.e>e.e^c<0?1:-1;for(t=0,n=(r=o.length)<(i=a.length)?r:i;t<n;++t)if(o[t]!==a[t])return o[t]>a[t]^c<0?1:-1;return r===i?0:r>i^c<0?1:-1},N.cosine=N.cos=function(){var e,n,r=this,i=r.constructor;return r.d?r.d[0]?(e=i.precision,n=i.rounding,i.precision=e+Math.max(r.e,r.sd())+7,i.rounding=1,r=function(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?i=(1/B(4,n=Math.ceil(r/3))).toString():(n=16,i="2.3283064365386962890625e-10");e.precision+=n,t=L(e,1,t.times(i),new e(1));for(var s=n;s--;){var o=t.times(t);t=o.times(o).minus(o).times(8).plus(1)}return e.precision-=n,t}(i,W(i,r)),i.precision=e,i.rounding=n,k(2==t||3==t?r.neg():r,e,n,!0)):new i(1):new i(NaN)},N.cubeRoot=N.cbrt=function(){var e,t,n,r,i,s,o,a,u,f,p=this,l=p.constructor;if(!p.isFinite()||p.isZero())return new l(p);for(c=!1,(s=p.s*h(p.s*p,1/3))&&Math.abs(s)!=1/0?r=new l(s.toString()):(n=S(p.d),(s=((e=p.e)-n.length+1)%3)&&(n+=1==s||-2==s?"0":"00"),s=h(n,1/3),e=g((e+1)/3)-(e%3==(e<0?-1:2)),(r=new l(n=s==1/0?"5e"+e:(n=s.toExponential()).slice(0,n.indexOf("e")+1)+e)).s=p.s),o=(e=l.precision)+3;;)if(f=(u=(a=r).times(a).times(a)).plus(p),r=D(f.plus(p).times(a),f.plus(u),o+2,1),S(a.d).slice(0,o)===(n=S(r.d)).slice(0,o)){if("9999"!=(n=n.slice(o-3,o+1))&&(i||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(k(r,e+1,1),t=!r.times(r).times(r).eq(p));break}if(!i&&(k(a,e+1,0),a.times(a).times(a).eq(p))){r=a;break}o+=4,i=1}return c=!0,k(r,e,l.rounding,t)},N.decimalPlaces=N.dp=function(){var e,t=this.d,n=NaN;if(t){if(n=7*((e=t.length-1)-g(this.e/7)),e=t[e])for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n},N.dividedBy=N.div=function(e){return D(this,new this.constructor(e))},N.dividedToIntegerBy=N.divToInt=function(e){var t=this.constructor;return k(D(this,new t(e),0,1,1),t.precision,t.rounding)},N.equals=N.eq=function(e){return 0===this.cmp(e)},N.floor=function(){return k(new this.constructor(this),this.e+1,3)},N.greaterThan=N.gt=function(e){return this.cmp(e)>0},N.greaterThanOrEqualTo=N.gte=function(e){var t=this.cmp(e);return 1==t||0===t},N.hyperbolicCosine=N.cosh=function(){var e,t,n,r,i,s=this,o=s.constructor,a=new o(1);if(!s.isFinite())return new o(s.s?1/0:NaN);if(s.isZero())return a;n=o.precision,r=o.rounding,o.precision=n+Math.max(s.e,s.sd())+4,o.rounding=1,(i=s.d.length)<32?t=(1/B(4,e=Math.ceil(i/3))).toString():(e=16,t="2.3283064365386962890625e-10"),s=L(o,1,s.times(t),new o(1),!0);for(var c,u=e,f=new o(8);u--;)c=s.times(s),s=a.minus(c.times(f.minus(c.times(f))));return k(s,o.precision=n,o.rounding=r,!0)},N.hyperbolicSine=N.sinh=function(){var e,t,n,r,i=this,s=i.constructor;if(!i.isFinite()||i.isZero())return new s(i);if(t=s.precision,n=s.rounding,s.precision=t+Math.max(i.e,i.sd())+4,s.rounding=1,(r=i.d.length)<3)i=L(s,2,i,i,!0);else{e=(e=1.4*Math.sqrt(r))>16?16:0|e,i=L(s,2,i=i.times(1/B(5,e)),i,!0);for(var o,a=new s(5),c=new s(16),u=new s(20);e--;)o=i.times(i),i=i.times(a.plus(o.times(c.times(o).plus(u))))}return s.precision=t,s.rounding=n,k(i,t,n,!0)},N.hyperbolicTangent=N.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,D(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)},N.inverseCosine=N.acos=function(){var e=this,t=e.constructor,n=e.abs().cmp(1),r=t.precision,i=t.rounding;return-1!==n?0===n?e.isNeg()?P(t,r,i):new t(0):new t(NaN):e.isZero()?P(t,r+4,i).times(.5):(t.precision=r+6,t.rounding=1,e=new t(1).minus(e).div(e.plus(1)).sqrt().atan(),t.precision=r,t.rounding=i,e.times(2))},N.inverseHyperbolicCosine=N.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,c=!1,n=n.times(n).minus(1).sqrt().plus(n),c=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)},N.inverseHyperbolicSine=N.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,c=!1,n=n.times(n).plus(1).sqrt().plus(n),c=!0,r.precision=e,r.rounding=t,n.ln())},N.inverseHyperbolicTangent=N.atanh=function(){var e,t,n,r,i=this,s=i.constructor;return i.isFinite()?i.e>=0?new s(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=s.precision,t=s.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?k(new s(i),e,t,!0):(s.precision=n=r-i.e,i=D(i.plus(1),new s(1).minus(i),n+e,1),s.precision=e+4,s.rounding=1,i=i.ln(),s.precision=e,s.rounding=t,i.times(.5))):new s(NaN)},N.inverseSine=N.asin=function(){var e,t,n,r,i=this,s=i.constructor;return i.isZero()?new s(i):(t=i.abs().cmp(1),n=s.precision,r=s.rounding,-1!==t?0===t?((e=P(s,n+4,r).times(.5)).s=i.s,e):new s(NaN):(s.precision=n+6,s.rounding=1,i=i.div(new s(1).minus(i.times(i)).sqrt().plus(1)).atan(),s.precision=n,s.rounding=r,i.times(2)))},N.inverseTangent=N.atan=function(){var e,t,n,r,i,s,o,a,u,f=this,p=f.constructor,l=p.precision,d=p.rounding;if(f.isFinite()){if(f.isZero())return new p(f);if(f.abs().eq(1)&&l+4<=E)return(o=P(p,l+4,d).times(.25)).s=f.s,o}else{if(!f.s)return new p(NaN);if(l+4<=E)return(o=P(p,l+4,d).times(.5)).s=f.s,o}for(p.precision=a=l+10,p.rounding=1,e=n=Math.min(28,a/7+2|0);e;--e)f=f.div(f.times(f).plus(1).sqrt().plus(1));for(c=!1,t=Math.ceil(a/7),r=1,u=f.times(f),o=new p(f),i=f;-1!==e;)if(i=i.times(u),s=o.minus(i.div(r+=2)),i=i.times(u),void 0!==(o=s.plus(i.div(r+=2))).d[t])for(e=t;o.d[e]===s.d[e]&&e--;);return n&&(o=o.times(2<<n-1)),c=!0,k(o,p.precision=l,p.rounding=d,!0)},N.isFinite=function(){return!!this.d},N.isInteger=N.isInt=function(){return!!this.d&&g(this.e/7)>this.d.length-2},N.isNaN=function(){return!this.s},N.isNegative=N.isNeg=function(){return this.s<0},N.isPositive=N.isPos=function(){return this.s>0},N.isZero=function(){return!!this.d&&0===this.d[0]},N.lessThan=N.lt=function(e){return this.cmp(e)<0},N.lessThanOrEqualTo=N.lte=function(e){return this.cmp(e)<1},N.logarithm=N.log=function(e){var t,n,r,i,s,o,a,u,f=this,p=f.constructor,l=p.precision,d=p.rounding;if(null==e)e=new p(10),t=!0;else{if(n=(e=new p(e)).d,e.s<0||!n||!n[0]||e.eq(1))return new p(NaN);t=e.eq(10)}if(n=f.d,f.s<0||!n||!n[0]||f.eq(1))return new p(n&&!n[0]?-1/0:1!=f.s?NaN:n?0:1/0);if(t)if(n.length>1)s=!0;else{for(i=n[0];i%10==0;)i/=10;s=1!==i}if(c=!1,o=j(f,a=l+5),r=t?F(p,a+10):j(e,a),M((u=D(o,r,a,1)).d,i=l,d))do{if(o=j(f,a+=10),r=t?F(p,a+10):j(e,a),u=D(o,r,a,1),!s){+S(u.d).slice(i+1,i+15)+1==1e14&&(u=k(u,l+1,0));break}}while(M(u.d,i+=10,d));return c=!0,k(u,l,d)},N.minus=N.sub=function(e){var t,n,r,i,s,o,a,u,f,p,l,d,h=this,m=h.constructor;if(e=new m(e),!h.d||!e.d)return h.s&&e.s?h.d?e.s=-e.s:e=new m(e.d||h.s!==e.s?h:NaN):e=new m(NaN),e;if(h.s!=e.s)return e.s=-e.s,h.plus(e);if(f=h.d,d=e.d,a=m.precision,u=m.rounding,!f[0]||!d[0]){if(d[0])e.s=-e.s;else{if(!f[0])return new m(3===u?-0:0);e=new m(h)}return c?k(e,a,u):e}if(n=g(e.e/7),p=g(h.e/7),f=f.slice(),s=p-n){for((l=s<0)?(t=f,s=-s,o=d.length):(t=d,n=p,o=f.length),s>(r=Math.max(Math.ceil(a/7),o)+2)&&(s=r,t.length=1),t.reverse(),r=s;r--;)t.push(0);t.reverse()}else{for((l=(r=f.length)<(o=d.length))&&(o=r),r=0;r<o;r++)if(f[r]!=d[r]){l=f[r]<d[r];break}s=0}for(l&&(t=f,f=d,d=t,e.s=-e.s),o=f.length,r=d.length-o;r>0;--r)f[o++]=0;for(r=d.length;r>s;){if(f[--r]<d[r]){for(i=r;i&&0===f[--i];)f[i]=x-1;--f[i],f[r]+=x}f[r]-=d[r]}for(;0===f[--o];)f.pop();for(;0===f[0];f.shift())--n;return f[0]?(e.d=f,e.e=O(f,n),c?k(e,a,u):e):new m(3===u?-0:0)},N.modulo=N.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?k(new r(n),r.precision,r.rounding):(c=!1,9==r.modulo?(t=D(n,e.abs(),0,3,1)).s*=e.s:t=D(n,e,0,r.modulo,1),t=t.times(e),c=!0,n.minus(t))},N.naturalExponential=N.exp=function(){return R(this)},N.naturalLogarithm=N.ln=function(){return j(this)},N.negated=N.neg=function(){var e=new this.constructor(this);return e.s=-e.s,k(e)},N.plus=N.add=function(e){var t,n,r,i,s,o,a,u,f,p,l=this,d=l.constructor;if(e=new d(e),!l.d||!e.d)return l.s&&e.s?l.d||(e=new d(e.d||l.s===e.s?l:NaN)):e=new d(NaN),e;if(l.s!=e.s)return e.s=-e.s,l.minus(e);if(f=l.d,p=e.d,a=d.precision,u=d.rounding,!f[0]||!p[0])return p[0]||(e=new d(l)),c?k(e,a,u):e;if(s=g(l.e/7),r=g(e.e/7),f=f.slice(),i=s-r){for(i<0?(n=f,i=-i,o=p.length):(n=p,r=s,o=f.length),i>(o=(s=Math.ceil(a/7))>o?s+1:o+1)&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for((o=f.length)-(i=p.length)<0&&(i=o,n=p,p=f,f=n),t=0;i;)t=(f[--i]=f[i]+p[i]+t)/x|0,f[i]%=x;for(t&&(f.unshift(t),++r),o=f.length;0==f[--o];)f.pop();return e.d=f,e.e=O(f,r),c?k(e,a,u):e},N.precision=N.sd=function(e){var t,n=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(f+e);return n.d?(t=A(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t},N.round=function(){var e=this,t=e.constructor;return k(new t(e),e.e+1,t.rounding)},N.sine=N.sin=function(){var e,n,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(e=i.precision,n=i.rounding,i.precision=e+Math.max(r.e,r.sd())+7,i.rounding=1,r=function(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:L(e,2,t,t);n=(n=1.4*Math.sqrt(r))>16?16:0|n,t=t.times(1/B(5,n)),t=L(e,2,t,t);for(var i,s=new e(5),o=new e(16),a=new e(20);n--;)i=t.times(t),t=t.times(s.plus(i.times(o.times(i).minus(a))));return t}(i,W(i,r)),i.precision=e,i.rounding=n,k(t>2?r.neg():r,e,n,!0)):new i(NaN)},N.squareRoot=N.sqrt=function(){var e,t,n,r,i,s,o=this,a=o.d,u=o.e,f=o.s,p=o.constructor;if(1!==f||!a||!a[0])return new p(!f||f<0&&(!a||a[0])?NaN:a?o:1/0);for(c=!1,0==(f=Math.sqrt(+o))||f==1/0?(((t=S(a)).length+u)%2==0&&(t+="0"),f=Math.sqrt(t),u=g((u+1)/2)-(u<0||u%2),r=new p(t=f==1/0?"5e"+u:(t=f.toExponential()).slice(0,t.indexOf("e")+1)+u)):r=new p(f.toString()),n=(u=p.precision)+3;;)if(r=(s=r).plus(D(o,s,n+2,1)).times(.5),S(s.d).slice(0,n)===(t=S(r.d)).slice(0,n)){if("9999"!=(t=t.slice(n-3,n+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(k(r,u+1,1),e=!r.times(r).eq(o));break}if(!i&&(k(s,u+1,0),s.times(s).eq(o))){r=s;break}n+=4,i=1}return c=!0,k(r,u,p.rounding,e)},N.tangent=N.tan=function(){var e,n,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(e=i.precision,n=i.rounding,i.precision=e+10,i.rounding=1,(r=r.sin()).s=1,r=D(r,new i(1).minus(r.times(r)).sqrt(),e+10,0),i.precision=e,i.rounding=n,k(2==t||4==t?r.neg():r,e,n,!0)):new i(NaN)},N.times=N.mul=function(e){var t,n,r,i,s,o,a,u,f,p=this,l=p.constructor,d=p.d,h=(e=new l(e)).d;if(e.s*=p.s,!(d&&d[0]&&h&&h[0]))return new l(!e.s||d&&!d[0]&&!h||h&&!h[0]&&!d?NaN:d&&h?0*e.s:e.s/0);for(n=g(p.e/7)+g(e.e/7),(u=d.length)<(f=h.length)&&(s=d,d=h,h=s,o=u,u=f,f=o),s=[],r=o=u+f;r--;)s.push(0);for(r=f;--r>=0;){for(t=0,i=u+r;i>r;)a=s[i]+h[r]*d[i-r-1]+t,s[i--]=a%x|0,t=a/x|0;s[i]=(s[i]+t)%x|0}for(;!s[--o];)s.pop();return t?++n:s.shift(),e.d=s,e.e=O(s,n),c?k(e,l.precision,l.rounding):e},N.toBinary=function(e,t){return V(this,2,e,t)},N.toDecimalPlaces=N.toDP=function(e,t){var n=this,i=n.constructor;return n=new i(n),void 0===e?n:($(e,0,r),void 0===t?t=i.rounding:$(t,0,8),k(n,e+n.e+1,t))},N.toExponential=function(e,t){var n,i=this,s=i.constructor;return void 0===e?n=Y(i,!0):($(e,0,r),void 0===t?t=s.rounding:$(t,0,8),n=Y(i=k(new s(i),e+1,t),!0,e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},N.toFixed=function(e,t){var n,i,s=this,o=s.constructor;return void 0===e?n=Y(s):($(e,0,r),void 0===t?t=o.rounding:$(t,0,8),n=Y(i=k(new o(s),e+s.e+1,t),!1,e+i.e+1)),s.isNeg()&&!s.isZero()?"-"+n:n},N.toFraction=function(e){var t,n,r,i,s,o,a,u,p,l,d,g,m=this,w=m.d,y=m.constructor;if(!w)return new y(m);if(p=n=new y(1),r=u=new y(0),o=(s=(t=new y(r)).e=A(w)-m.e-1)%7,t.d[0]=h(10,o<0?7+o:o),null==e)e=s>0?t:p;else{if(!(a=new y(e)).isInt()||a.lt(p))throw Error(f+a);e=a.gt(t)?s>0?t:p:a}for(c=!1,a=new y(S(w)),l=y.precision,y.precision=s=7*w.length*2;d=D(a,t,0,1,1),1!=(i=n.plus(d.times(r))).cmp(e);)n=r,r=i,i=p,p=u.plus(d.times(i)),u=i,i=t,t=a.minus(d.times(i)),a=i;return i=D(e.minus(n),r,0,1,1),u=u.plus(i.times(p)),n=n.plus(i.times(r)),u.s=p.s=m.s,g=D(p,r,s,1).minus(m).abs().cmp(D(u,n,s,1).minus(m).abs())<1?[p,r]:[u,n],y.precision=l,c=!0,g},N.toHexadecimal=N.toHex=function(e,t){return V(this,16,e,t)},N.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),null==e){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),void 0===t?t=r.rounding:$(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(c=!1,n=D(n,e,0,t,1).times(e),c=!0,k(n)):(e.s=n.s,n=e),n},N.toNumber=function(){return+this},N.toOctal=function(e,t){return V(this,8,e,t)},N.toPower=N.pow=function(e){var t,n,r,i,s,o,a=this,u=a.constructor,f=+(e=new u(e));if(!(a.d&&e.d&&a.d[0]&&e.d[0]))return new u(h(+a,f));if((a=new u(a)).eq(1))return a;if(r=u.precision,s=u.rounding,e.eq(1))return k(a,r,s);if((t=g(e.e/7))>=e.d.length-1&&(n=f<0?-f:f)<=9007199254740991)return i=_(u,a,n,r),e.s<0?new u(1).div(i):k(i,r,s);if((o=a.s)<0){if(t<e.d.length-1)return new u(NaN);if(1&e.d[t]||(o=1),0==a.e&&1==a.d[0]&&1==a.d.length)return a.s=o,a}return(t=0!=(n=h(+a,f))&&isFinite(n)?new u(n+"").e:g(f*(Math.log("0."+S(a.d))/Math.LN10+a.e+1)))>u.maxE+1||t<u.minE-1?new u(t>0?o/0:0):(c=!1,u.rounding=a.s=1,n=Math.min(12,(t+"").length),(i=R(e.times(j(a,r+n)),r)).d&&M((i=k(i,r+5,1)).d,r,s)&&(t=r+10,+S((i=k(R(e.times(j(a,t+n)),t),t+5,1)).d).slice(r+1,r+15)+1==1e14&&(i=k(i,r+1,0))),i.s=o,c=!0,u.rounding=s,k(i,r,s))},N.toPrecision=function(e,t){var n,i=this,s=i.constructor;return void 0===e?n=Y(i,i.e<=s.toExpNeg||i.e>=s.toExpPos):($(e,1,r),void 0===t?t=s.rounding:$(t,0,8),n=Y(i=k(new s(i),e,t),e<=i.e||i.e<=s.toExpNeg,e)),i.isNeg()&&!i.isZero()?"-"+n:n},N.toSignificantDigits=N.toSD=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):($(e,1,r),void 0===t?t=n.rounding:$(t,0,8)),k(new n(this),e,t)},N.toString=function(){var e=this,t=e.constructor,n=Y(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n},N.truncated=N.trunc=function(){return k(new this.constructor(this),this.e+1,1)},N.valueOf=N.toJSON=function(){var e=this,t=e.constructor,n=Y(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};var D=function(){function t(e,t,n){var r,i=0,s=e.length;for(e=e.slice();s--;)r=e[s]*t+i,e[s]=r%n|0,i=r/n|0;return i&&e.unshift(i),e}function n(e,t,n,r){var i,s;if(n!=r)s=n>r?1:-1;else for(i=s=0;i<n;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(i,s,o,a,c,u){var f,p,l,d,h,m,w,y,v,b,E,N,S,$,M,T,D,Y,O,F,P=i.constructor,A=i.s==s.s?1:-1,H=i.d,_=s.d;if(!(H&&H[0]&&_&&_[0]))return new P(i.s&&s.s&&(H?!_||H[0]!=_[0]:_)?H&&0==H[0]||!_?0*A:A/0:NaN);for(u?(h=1,p=i.e-s.e):(u=x,h=7,p=g(i.e/h)-g(s.e/h)),O=_.length,D=H.length,b=(v=new P(A)).d=[],l=0;_[l]==(H[l]||0);l++);if(_[l]>(H[l]||0)&&p--,null==o?($=o=P.precision,a=P.rounding):$=c?o+(i.e-s.e)+1:o,$<0)b.push(1),m=!0;else{if($=$/h+2|0,l=0,1==O){for(d=0,_=_[0],$++;(l<D||d)&&$--;l++)M=d*u+(H[l]||0),b[l]=M/_|0,d=M%_|0;m=d||l<D}else{for((d=u/(_[0]+1)|0)>1&&(_=t(_,d,u),H=t(H,d,u),O=_.length,D=H.length),T=O,N=(E=H.slice(0,O)).length;N<O;)E[N++]=0;(F=_.slice()).unshift(0),Y=_[0],_[1]>=u/2&&++Y;do{d=0,(f=n(_,E,O,N))<0?(S=E[0],O!=N&&(S=S*u+(E[1]||0)),(d=S/Y|0)>1?(d>=u&&(d=u-1),1==(f=n(w=t(_,d,u),E,y=w.length,N=E.length))&&(d--,r(w,O<y?F:_,y,u))):(0==d&&(f=d=1),w=_.slice()),(y=w.length)<N&&w.unshift(0),r(E,w,N,u),-1==f&&(f=n(_,E,O,N=E.length))<1&&(d++,r(E,O<N?F:_,N,u)),N=E.length):0===f&&(d++,E=[0]),b[l++]=d,f&&E[0]?E[N++]=H[T]||0:(E=[H[T]],N=1)}while((T++<D||void 0!==E[0])&&$--);m=void 0!==E[0]}b[0]||b.shift()}if(1==h)v.e=p,e=m;else{for(l=1,d=b[0];d>=10;d/=10)l++;v.e=l+p*h-1,k(v,c?o+v.e+1:o,a,m)}return v}}();function k(e,t,n,r){var i,s,o,a,u,f,p,l,d,g=e.constructor;e:if(null!=t){if(!(l=e.d))return e;for(i=1,a=l[0];a>=10;a/=10)i++;if((s=t-i)<0)s+=7,o=t,u=(p=l[d=0])/h(10,i-o-1)%10|0;else if((d=Math.ceil((s+1)/7))>=(a=l.length)){if(!r)break e;for(;a++<=d;)l.push(0);p=u=0,i=1,o=(s%=7)-7+1}else{for(p=a=l[d],i=1;a>=10;a/=10)i++;u=(o=(s%=7)-7+i)<0?0:p/h(10,i-o-1)%10|0}if(r=r||t<0||void 0!==l[d+1]||(o<0?p:p%h(10,i-o-1)),f=n<4?(u||r)&&(0==n||n==(e.s<0?3:2)):u>5||5==u&&(4==n||r||6==n&&(s>0?o>0?p/h(10,i-o):0:l[d-1])%10&1||n==(e.s<0?8:7)),t<1||!l[0])return l.length=0,f?(t-=e.e+1,l[0]=h(10,(7-t%7)%7),e.e=-t||0):l[0]=e.e=0,e;if(0==s?(l.length=d,a=1,d--):(l.length=d+1,a=h(10,7-s),l[d]=o>0?(p/h(10,i-o)%h(10,o)|0)*a:0),f)for(;;){if(0==d){for(s=1,o=l[0];o>=10;o/=10)s++;for(o=l[0]+=a,a=1;o>=10;o/=10)a++;s!=a&&(e.e++,l[0]==x&&(l[0]=1));break}if(l[d]+=a,l[d]!=x)break;l[d--]=0,a=1}for(s=l.length;0===l[--s];)l.pop()}return c&&(e.e>g.maxE?(e.d=null,e.e=NaN):e.e<g.minE&&(e.e=0,e.d=[0])),e}function Y(e,t,n){if(!e.isFinite())return Z(e);var r,i=e.e,s=S(e.d),o=s.length;return t?(n&&(r=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+H(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(e.e<0?"e":"e+")+e.e):i<0?(s="0."+H(-i-1)+s,n&&(r=n-o)>0&&(s+=H(r))):i>=o?(s+=H(i+1-o),n&&(r=n-i-1)>0&&(s=s+"."+H(r))):((r=i+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(s+="."),s+=H(r))),s}function O(e,t){var n=e[0];for(t*=7;n>=10;n/=10)t++;return t}function F(e,t,n){if(t>b)throw c=!0,n&&(e.precision=n),Error(p);return k(new e(s),t,1,!0)}function P(e,t,n){if(t>E)throw Error(p);return k(new e(o),t,n,!0)}function A(e){var t=e.length-1,n=7*t+1;if(t=e[t]){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function H(e){for(var t="";e--;)t+="0";return t}function _(e,t,n,r){var i,s=new e(1),o=Math.ceil(r/7+4);for(c=!1;;){if(n%2&&K((s=s.times(t)).d,o)&&(i=!0),0===(n=g(n/2))){n=s.d.length-1,i&&0===s.d[n]&&++s.d[n];break}K((t=t.times(t)).d,o)}return c=!0,s}function q(e){return 1&e.d[e.d.length-1]}function C(e,t,n){for(var r,i,s=new e(t[0]),o=0;++o<t.length;){if(!(i=new e(t[o])).s){s=i;break}((r=s.cmp(i))===n||0===r&&s.s===n)&&(s=i)}return s}function R(e,t){var n,r,i,s,o,a,u,f=0,p=0,l=0,d=e.constructor,g=d.rounding,m=d.precision;if(!e.d||!e.d[0]||e.e>17)return new d(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(c=!1,u=m):u=t,a=new d(.03125);e.e>-2;)e=e.times(a),l+=5;for(u+=r=Math.log(h(2,l))/Math.LN10*2+5|0,n=s=o=new d(1),d.precision=u;;){if(s=k(s.times(e),u,1),n=n.times(++p),S((a=o.plus(D(s,n,u,1))).d).slice(0,u)===S(o.d).slice(0,u)){for(i=l;i--;)o=k(o.times(o),u,1);if(null!=t)return d.precision=m,o;if(!(f<3&&M(o.d,u-r,g,f)))return k(o,d.precision=m,g,c=!0);d.precision=u+=10,n=s=a=new d(1),p=0,f++}o=a}}function j(e,t){var n,r,i,s,o,a,u,f,p,l,d,g=1,h=e,m=h.d,w=h.constructor,y=w.rounding,v=w.precision;if(h.s<0||!m||!m[0]||!h.e&&1==m[0]&&1==m.length)return new w(m&&!m[0]?-1/0:1!=h.s?NaN:m?0:h);if(null==t?(c=!1,p=v):p=t,w.precision=p+=10,r=(n=S(m)).charAt(0),!(Math.abs(s=h.e)<15e14))return f=F(w,p+2,v).times(s+""),h=j(new w(r+"."+n.slice(1)),p-10).plus(f),w.precision=v,null==t?k(h,v,y,c=!0):h;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=S((h=h.times(e)).d)).charAt(0),g++;for(s=h.e,r>1?(h=new w("0."+n),s++):h=new w(r+"."+n.slice(1)),l=h,u=o=h=D(h.minus(1),h.plus(1),p,1),d=k(h.times(h),p,1),i=3;;){if(o=k(o.times(d),p,1),S((f=u.plus(D(o,new w(i),p,1))).d).slice(0,p)===S(u.d).slice(0,p)){if(u=u.times(2),0!==s&&(u=u.plus(F(w,p+2,v).times(s+""))),u=D(u,new w(g),p,1),null!=t)return w.precision=v,u;if(!M(u.d,p-10,y,a))return k(u,w.precision=v,y,c=!0);w.precision=p+=10,f=o=h=D(l.minus(1),l.plus(1),p,1),d=k(h.times(h),p,1),i=a=1}u=f,i+=2}}function Z(e){return String(e.s*e.s/0)}function I(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);r++);for(i=t.length;48===t.charCodeAt(i-1);--i);if(t=t.slice(r,i)){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%7,n<0&&(r+=7),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=7;r<i;)e.d.push(+t.slice(r,r+=7));r=7-(t=t.slice(r)).length}else r-=i;for(;r--;)t+="0";e.d.push(+t),c&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function U(e,t){var n,r,i,s,o,a,u,p,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),v.test(t))return I(e,t)}else if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(w.test(t))n=16,t=t.toLowerCase();else if(m.test(t))n=2;else{if(!y.test(t))throw Error(f+t);n=8}for((s=t.search(/p/i))>0?(u=+t.slice(s+1),t=t.substring(2,s)):t=t.slice(2),o=(s=t.indexOf("."))>=0,r=e.constructor,o&&(s=(a=(t=t.replace(".","")).length)-s,i=_(r,new r(n),s,2*s)),s=l=(p=T(t,n,x)).length-1;0===p[s];--s)p.pop();return s<0?new r(0*e.s):(e.e=O(p,l),e.d=p,c=!1,o&&(e=D(e,i,4*a)),u&&(e=e.times(Math.abs(u)<54?h(2,u):He.pow(2,u))),c=!0,e)}function L(e,t,n,r,i){var s,o,a,u,f=e.precision,p=Math.ceil(f/7);for(c=!1,u=n.times(n),a=new e(r);;){if(o=D(a.times(u),new e(t++*t++),f,1),a=i?r.plus(o):r.minus(o),r=D(o.times(u),new e(t++*t++),f,1),void 0!==(o=a.plus(r)).d[p]){for(s=p;o.d[s]===a.d[s]&&s--;);if(-1==s)break}s=a,a=r,r=o,o=s}return c=!0,o.d.length=p+1,o}function B(e,t){for(var n=e;--t;)n*=e;return n}function W(e,n){var r,i=n.s<0,s=P(e,e.precision,1),o=s.times(.5);if((n=n.abs()).lte(o))return t=i?4:1,n;if((r=n.divToInt(s)).isZero())t=i?3:2;else{if((n=n.minus(r.times(s))).lte(o))return t=q(r)?i?2:3:i?4:1,n;t=q(r)?i?1:4:i?3:2}return n.minus(s).abs()}function V(t,n,s,o){var a,c,u,f,p,l,d,g,h,m=t.constructor,w=void 0!==s;if(w?($(s,1,r),void 0===o?o=m.rounding:$(o,0,8)):(s=m.precision,o=m.rounding),t.isFinite()){for(w?(a=2,16==n?s=4*s-3:8==n&&(s=3*s-2)):a=n,(u=(d=Y(t)).indexOf("."))>=0&&(d=d.replace(".",""),(h=new m(1)).e=d.length-u,h.d=T(Y(h),10,a),h.e=h.d.length),c=p=(g=T(d,10,a)).length;0==g[--p];)g.pop();if(g[0]){if(u<0?c--:((t=new m(t)).d=g,t.e=c,g=(t=D(t,h,s,o,0,a)).d,c=t.e,l=e),u=g[s],f=a/2,l=l||void 0!==g[s+1],l=o<4?(void 0!==u||l)&&(0===o||o===(t.s<0?3:2)):u>f||u===f&&(4===o||l||6===o&&1&g[s-1]||o===(t.s<0?8:7)),g.length=s,l)for(;++g[--s]>a-1;)g[s]=0,s||(++c,g.unshift(1));for(p=g.length;!g[p-1];--p);for(u=0,d="";u<p;u++)d+=i.charAt(g[u]);if(w){if(p>1)if(16==n||8==n){for(u=16==n?4:3,--p;p%u;p++)d+="0";for(p=(g=T(d,a,n)).length;!g[p-1];--p);for(u=1,d="1.";u<p;u++)d+=i.charAt(g[u])}else d=d.charAt(0)+"."+d.slice(1);d=d+(c<0?"p":"p+")+c}else if(c<0){for(;++c;)d="0"+d;d="0."+d}else if(++c>p)for(c-=p;c--;)d+="0";else c<p&&(d=d.slice(0,c)+"."+d.slice(c))}else d=w?"0p+0":"0";d=(16==n?"0x":2==n?"0b":8==n?"0o":"")+d}else d=Z(t);return t.s<0?"-"+d:d}function K(e,t){if(e.length>t)return e.length=t,!0}function z(e){return new this(e).abs()}function X(e){return new this(e).acos()}function J(e){return new this(e).acosh()}function G(e,t){return new this(e).plus(t)}function Q(e){return new this(e).asin()}function ee(e){return new this(e).asinh()}function te(e){return new this(e).atan()}function ne(e){return new this(e).atanh()}function re(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,s=r+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(n=t.s<0?P(this,r,i):new this(0)).s=e.s:!e.d||t.isZero()?(n=P(this,s,1).times(.5)).s=e.s:t.s<0?(this.precision=s,this.rounding=1,n=this.atan(D(e,t,s,1)),t=P(this,s,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(D(e,t,s,1)):(n=P(this,s,1).times(t.s>0?.25:.75)).s=e.s:n=new this(NaN),n}function ie(e){return new this(e).cbrt()}function se(e){return k(e=new this(e),e.e+1,2)}function oe(e,t,n){return new this(e).clamp(t,n)}function ae(e){if(!e||"object"!=typeof e)throw Error(u+"Object expected");var t,i,s,o=!0===e.defaults,c=["precision",1,r,"rounding",0,8,"toExpNeg",-9e15,0,"toExpPos",0,n,"maxE",0,n,"minE",-9e15,0,"modulo",0,9];for(t=0;t<c.length;t+=3)if(i=c[t],o&&(this[i]=a[i]),void 0!==(s=e[i])){if(!(g(s)===s&&s>=c[t+1]&&s<=c[t+2]))throw Error(f+i+": "+s);this[i]=s}if(i="crypto",o&&(this[i]=a[i]),void 0!==(s=e[i])){if(!0!==s&&!1!==s&&0!==s&&1!==s)throw Error(f+i+": "+s);if(s){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(l);this[i]=!0}else this[i]=!1}return this}function ce(e){return new this(e).cos()}function ue(e){return new this(e).cosh()}function fe(e,t){return new this(e).div(t)}function pe(e){return new this(e).exp()}function le(e){return k(e=new this(e),e.e+1,3)}function de(){var e,t,n=new this(0);for(c=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return c=!0,new this(1/0);n=t}return c=!0,n.sqrt()}function ge(e){return e instanceof He||e&&e.toStringTag===d||!1}function he(e){return new this(e).ln()}function me(e,t){return new this(e).log(t)}function we(e){return new this(e).log(2)}function ye(e){return new this(e).log(10)}function ve(){return C(this,arguments,-1)}function xe(){return C(this,arguments,1)}function be(e,t){return new this(e).mod(t)}function Ee(e,t){return new this(e).mul(t)}function Ne(e,t){return new this(e).pow(t)}function Se(e){var t,n,i,s,o=0,a=new this(1),c=[];if(void 0===e?e=this.precision:$(e,1,r),i=Math.ceil(e/7),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(i));o<i;)(s=t[o])>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:c[o++]=s%1e7;else{if(!crypto.randomBytes)throw Error(l);for(t=crypto.randomBytes(i*=4);o<i;)(s=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((127&t[o+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,o):(c.push(s%1e7),o+=4);o=i/4}else for(;o<i;)c[o++]=1e7*Math.random()|0;for(e%=7,(i=c[--o])&&e&&(s=h(10,7-e),c[o]=(i/s|0)*s);0===c[o];o--)c.pop();if(o<0)n=0,c=[0];else{for(n=-1;0===c[0];n-=7)c.shift();for(i=1,s=c[0];s>=10;s/=10)i++;i<7&&(n-=7-i)}return a.e=n,a.d=c,a}function $e(e){return k(e=new this(e),e.e+1,this.rounding)}function Me(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function Te(e){return new this(e).sin()}function De(e){return new this(e).sinh()}function ke(e){return new this(e).sqrt()}function Ye(e,t){return new this(e).sub(t)}function Oe(){var e=0,t=arguments,n=new this(t[e]);for(c=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return c=!0,k(n,this.precision,this.rounding)}function Fe(e){return new this(e).tan()}function Pe(e){return new this(e).tanh()}function Ae(e){return k(e=new this(e),e.e+1,1)}N[Symbol.for("nodejs.util.inspect.custom")]=N.toString,N[Symbol.toStringTag]="Decimal";var He=N.constructor=function e(t){var n,r,i;function s(e){var t,n,r,i=this;if(!(i instanceof s))return new s(e);if(i.constructor=s,ge(e))return i.s=e.s,void(c?!e.d||e.e>s.maxE?(i.e=NaN,i.d=null):e.e<s.minE?(i.e=0,i.d=[0]):(i.e=e.e,i.d=e.d.slice()):(i.e=e.e,i.d=e.d?e.d.slice():e.d));if("number"===(r=typeof e)){if(0===e)return i.s=1/e<0?-1:1,i.e=0,void(i.d=[0]);if(e<0?(e=-e,i.s=-1):i.s=1,e===~~e&&e<1e7){for(t=0,n=e;n>=10;n/=10)t++;return void(c?t>s.maxE?(i.e=NaN,i.d=null):t<s.minE?(i.e=0,i.d=[0]):(i.e=t,i.d=[e]):(i.e=t,i.d=[e]))}return 0*e!=0?(e||(i.s=NaN),i.e=NaN,void(i.d=null)):I(i,e.toString())}if("string"===r)return 45===(n=e.charCodeAt(0))?(e=e.slice(1),i.s=-1):(43===n&&(e=e.slice(1)),i.s=1),v.test(e)?I(i,e):U(i,e);if("bigint"===r)return e<0?(e=-e,i.s=-1):i.s=1,I(i,e.toString());throw Error(f+e)}if(s.prototype=N,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.EUCLID=9,s.config=s.set=ae,s.clone=e,s.isDecimal=ge,s.abs=z,s.acos=X,s.acosh=J,s.add=G,s.asin=Q,s.asinh=ee,s.atan=te,s.atanh=ne,s.atan2=re,s.cbrt=ie,s.ceil=se,s.clamp=oe,s.cos=ce,s.cosh=ue,s.div=fe,s.exp=pe,s.floor=le,s.hypot=de,s.ln=he,s.log=me,s.log10=ye,s.log2=we,s.max=ve,s.min=xe,s.mod=be,s.mul=Ee,s.pow=Ne,s.random=Se,s.round=$e,s.sign=Me,s.sin=Te,s.sinh=De,s.sqrt=ke,s.sub=Ye,s.sum=Oe,s.tan=Fe,s.tanh=Pe,s.trunc=Ae,void 0===t&&(t={}),t&&!0!==t.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<i.length;)t.hasOwnProperty(r=i[n++])||(t[r]=this[r]);return s.config(t),s}(a);s=new He(s),o=new He(o);class _e{constructor(e,t,n){if(!Array.isArray(e))throw new Error("DMatrix: data 必须是数组");console.log("data:",e),console.log("rows:",t),console.log("cols:",n),this.data=e,this.rows=t,this.cols=n}toString(){if(1===this.cols)return`[${this.data.join(",")}]`;let e=[];for(let t=0;t<this.rows;t++){let n=[];for(let e=0;e<this.cols;e++)n.push(this.data[t*this.cols+e]);e.push(n.join(","))}return`{${e.join(";")}}`}}He.set({precision:21});class qe{constructor(e,t,n){this.year=e,this.month=t,this.timestamp=n}getYMString(){let e="";return 0!==this.year&&(e+=this.year+"年"),0!==this.month&&(e+=this.month+"月"),""!=e&&(e+="+"),e}toString(){return this.getYMString()+this.timestamp+"ms"}}const Ce={pi:He.acos(-1),e:He.exp(1)};function Re(e){return e instanceof He}function je(e){return function(e){return"number"==typeof e}(e)||function(e){return"bigint"==typeof e}(e)||Re(e)}function Ze(e){return e instanceof Date&&!isNaN(e)}function Ie(e){return e instanceof qe}const Ue={convertTypes(e,t="decimal"){if("decimal"===t)return new He(e.toString());if("number"===t)return Number(e.toString());if("bigint"===t)return BigInt(e.toString());if("string"===t)return e.toString();if("any"===t)return e;throw new Error(`无法将 ${e} 转换为 ${t} 类型`)},formatToDisplayString(e){if(Ie(e))return{value:e.toString(),info:"时间间隔："+Ue.formatDateStamp(e)};if(Ze(e))return{value:e.getTime(),info:"时间戳对应日期："+Ue.formatDate(e)};if(Re(e)){if(e.toString().includes("e+")||e.toString().includes("e-")){let t=e.toExponential(16),[n,r]=t.split("e");return n=n.replace(/\.?0+$/,""),n+"e"+r}return e.isInteger()?e.toString():e.toFixed(16).replace(/\.?0+$/,"")}return e.toString()},add(e,t){if(Re(e)&&Re(t))return e.plus(t);if("string"==typeof e||"string"==typeof t)return e.toString()+t.toString();if(Ie(e)&&Ie(t))return new qe(e.year+t.year,e.month+t.month,e.timestamp+t.timestamp);if(Ze(e)&&Ie(t)){const n=new Date(e);return n.setFullYear(n.getFullYear()+t.year),n.setMonth(n.getMonth()+t.month),n.setMilliseconds(n.getMilliseconds()+t.timestamp),n}if(Ze(t)&&Ie(e)){const n=new Date(t);return n.setFullYear(n.getFullYear()+e.year),n.setMonth(n.getMonth()+e.month),n.setMilliseconds(n.getMilliseconds()+e.timestamp),n}if(Ze(e)&&Ze(t))throw new Error("两个日期类型不能相加");if(je(e)&&je(t))return He(e.toString()).plus(He(t.toString()));if(typeof e!=typeof t)throw new Error(`参数类型不一致: ${typeof e} 和 ${typeof t}`);throw new Error("不支持的加法")},subtract(e,t){if(Re(e)&&Re(t))return e.minus(t);if(Ie(e)){if(Ie(t))return new qe(e.year-t.year,e.month-t.month,e.timestamp-t.timestamp);throw Ze(t)?new Error("时间戳不能减去日期 "):new Error("不支持的时间戳减法")}if(Ze(e)){if(Ie(t)){const n=new Date(e);return n.setFullYear(n.getFullYear()-t.year),n.setMonth(n.getMonth()-t.month),n.setMilliseconds(n.getMilliseconds()-t.timestamp),n}if(Ze(t)){const n=e.getTime()-t.getTime();return new qe(0,0,n)}throw new Error("不支持的日期减法")}if(je(e)&&je(t))return He(e.toString()).minus(He(t.toString()));if(typeof e!=typeof t)throw new Error(`参数类型不一致: ${typeof e} 和 ${typeof t}`);throw new Error("不支持的减法")},multiply(e,t){if(Re(e)&&Re(t))return e.times(t);throw new Error("不支持的乘法")},divide(e,t){if(Re(e)&&Re(t))return e.div(t);throw new Error("不支持的除法")},floorDivide(e,t){if(Re(e)&&Re(t))return e.div(t).floor();throw new Error("不支持的整除")},mod(e,t){if(Re(e)&&Re(t))return e.mod(t);throw new Error("不支持的模运算")},pow(e,t){if(Re(e)&&Re(t))return e.pow(t);throw new Error("不支持的幂运算")},toFixed(e,t){const n=Re(e)?e:new He(e);return n.isInteger()?n.toString():n.toFixed(t).replace(/\.?0+$/,"")},radianToPi(e){const t=(Re(e)?e:new He(e)).div(Ce.pi);if(t.isInteger())return t.equals(1)?"π":t.equals(-1)?"-π":`${t}*π`;const n=[2,3,4,6,8,12];for(const e of n){const n=t.toNumber()*e;if(Math.abs(Math.round(n)-n)<1e-8){const t=Math.round(n);return 1===Math.abs(t)?t>0?`π/${e}`:`-π/${e}`:`${t}*π/${e}`}}return`${t.toFixed(6)}*π`},radianToDeg(e){let t=(Re(e)?e:new He(e)).times(180).div(Ce.pi);return t=t.mod(360),t.lt(0)&&(t=t.plus(360)),t},dateToTimestamp(e){const t=new Date(e);if(isNaN(t.getTime()))throw new Error(`无法将${e}转成日期`);return t.getTime()},formatDate(e){if(Ie(e))throw new Error('无法将时间间隔转成日期, 请使用"> #"');const t=new Date(e);if(isNaN(t.getTime()))throw new Error(`无法将${e}转成日期`);const n=t.getFullYear(),r=t.getMonth()+1,i=t.getDate(),s=t.getHours(),o=t.getMinutes(),a=t.getSeconds();return 0===s&&0===o&&0===a?`${n}-${r.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")}`:`${n}-${r.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")} ${s.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},formatDateStamp(e){if(!Ie(e))throw new Error('"> #"只能可视化时间间隔类型');const t=e.timestamp,n=Math.abs(t),r=Math.floor(n/1e3%60),i=Math.floor(n/6e4%60),s=Math.floor(n/36e5%24),o=`${t<0?"-":""}${Math.floor(n/864e5)}天 ${s}小时 ${i}分钟 ${r}秒`;return e.getYMString()+o},formatDateStamp2Week(e){if(!Ie(e))throw new Error('"> #w"只能可视化时间间隔类型');const t=(e.timestamp/6048e5).toFixed(2)+"周";return e.getYMString()+t},formatDateStamp2Day(e){if(!Ie(e))throw new Error('"> #d"只能可视化时间间隔类型');const t=(e.timestamp/864e5).toFixed(2)+"天";return e.getYMString()+t},formatDateStamp2Hour(e){if(!Ie(e))throw new Error('"> #h"只能可视化时间间隔类型');const t=(e.timestamp/36e5).toFixed(2)+"小时";return e.getYMString()+t},formatDateStamp2Minute(e){if(!Ie(e))throw new Error('"> #m"只能可视化时间间隔类型');const t=(e.timestamp/6e4).toFixed(2)+"分钟";return e.getYMString()+t},formatDateStamp2Second(e){if(!Ie(e))throw new Error('"> #s"只能可视化时间间隔类型');const t=(e.timestamp/1e3).toFixed(2)+"秒";return e.getYMString()+t},str2vec(e){if("["!==(e=e.trim())[0]||"]"!==e[e.length-1])throw new Error("vector格式错误，请使用方括号[]");if((e=(e=e.substring(1,e.length-1)).replace(/\s*,\s*/g,",")).includes(",")&&e.includes(" "))throw new Error("vector格式错误, 不要混用逗号和空格");let t;if(t=e.includes(",")?e.split(",").map((e=>He(e.trim()))):e.split(/\s+/).map((e=>He(e.trim()))),0===t.length)throw new Error("vector 长度为0");for(let e=0;e<t.length;e++)if(isNaN(t[e]))throw new Error(`vector${e+1}: ${t[e]} 不是数字`);return new _e(t,t.length,1)},str2Matrix(e){if("{"!==(e=e.trim())[0]||"}"!==e[e.length-1])throw new Error("matrix格式错误，请使用大括号{}");if((e=(e=(e=e.substring(1,e.length-1)).replace(/\s*,\s*/g,",")).replace(/\s*;\s*/g,";")).includes(",")&&e.includes(" "))throw new Error("matrix格式错误, 不要混用逗号和空格");let t=(e=e.replace(/,/g," ")).split(";").map((e=>e.trim().split(/\s+/).map(He)));if(0===t.length)throw new Error("matrix 长度为0");let n=t[0].length;for(let e=0;e<t.length;e++)if(t[e].length!==n)throw new Error("matrix 每行长度不一致");let r=t.flat();return new _e(r,t.length,n)}},Le={"π":Ce.pi,PI:Ce.pi,pi:Ce.pi,e:Ce.e,E:Ce.e},Be={"(":{description:"左括号"},")":{description:"右括号"}},We={",":{description:"参数分隔符"}},Ve={"+":{precedence:2,args:2,func:Ue.add,argTypes:"any",position:"infix",description:"加法"},"-":{precedence:2,args:2,func:Ue.subtract,argTypes:"any",position:"infix",description:"减法"},"*":{precedence:4,args:2,func:Ue.multiply,position:"infix",description:"乘法"},"/":{precedence:4,args:2,func:Ue.divide,position:"infix",description:"除法"},"//":{precedence:4,args:2,func:Ue.floorDivide,position:"infix",description:"整除"},"%":{precedence:4,args:2,func:Ue.mod,position:"infix",description:"取模"},"**":{precedence:7,args:2,func:Ue.pow,position:"infix",description:"幂运算"},"°":{alias:".rad",description:"角度转弧度"},"unary-":{precedence:5,args:1,func:e=>e.neg(),position:"prefix",description:"负号"},"unary+":{precedence:5,args:1,func:e=>e,position:"prefix",description:"正号"},"unary%":{precedence:5,args:1,func:e=>e.times(.01),position:"postfix",preventSelfReference:!0,description:"百分号"},"‰":{precedence:5,args:1,func:e=>e.times(.001),position:"postfix",preventSelfReference:!0,description:"千分号"},"&":{precedence:1,args:2,func:(e,t)=>(console.log(typeof e,typeof t),e&t),position:"infix",argTypes:"bigint",description:"按位与"},and:{alias:"&",description:"按位与"},"|":{precedence:1,args:2,func:(e,t)=>e|t,position:"infix",argTypes:"bigint",description:"按位或"},or:{alias:"|",description:"按位或"},"^":{precedence:1,args:2,func:(e,t)=>e^t,position:"infix",argTypes:"bigint",description:"按位异或"},"~":{precedence:6,args:1,func:e=>~e,position:"prefix",argTypes:"bigint",description:"按位取反"},not:{alias:"~",description:"按位取反"},"<<":{precedence:3,args:2,func:(e,t)=>e<<t,position:"infix",argTypes:"bigint",description:"左移"},">>":{precedence:3,args:2,func:(e,t)=>e>>t,position:"infix",argTypes:"bigint",description:"右移"},">>>":{precedence:3,args:2,func:(e,t)=>e>>>t,position:"infix",argTypes:"number",description:"无符号右移"},"=":{precedence:0,args:2,func:(e,t)=>t,position:"infix",argTypes:"any",isCompoundAssignment:!0,description:"赋值"},"+=":{precedence:0,args:2,func:(e,t)=>e.add(t),position:"infix",description:"加法赋值",isCompoundAssignment:!0},"-=":{precedence:0,args:2,func:(e,t)=>e.sub(t),position:"infix",description:"减法赋值",isCompoundAssignment:!0},"*=":{precedence:0,args:2,func:(e,t)=>e.mul(t),position:"infix",description:"乘法赋值",isCompoundAssignment:!0},"/=":{precedence:0,args:2,func:(e,t)=>e.div(t),position:"infix",description:"除法赋值",isCompoundAssignment:!0},"&=":{precedence:0,args:2,func:(e,t)=>e&t,position:"infix",argTypes:"bigint",description:"按位与赋值",isCompoundAssignment:!0},"|=":{precedence:0,args:2,func:(e,t)=>(console.log("|=",e,t),console.log("oldValue的类型:",typeof e),console.log("rightValue的类型:",typeof t),e|t),position:"infix",argTypes:"bigint",description:"按位或赋值",isCompoundAssignment:!0},"^=":{precedence:0,args:2,func:(e,t)=>e^t,position:"infix",argTypes:"bigint",description:"按位异或赋值",isCompoundAssignment:!0},"<<=":{precedence:0,args:2,func:(e,t)=>e<<t,position:"infix",argTypes:"bigint",description:"左移赋值",isCompoundAssignment:!0},">>=":{precedence:0,args:2,func:(e,t)=>e>>t,position:"infix",argTypes:"bigint",description:"右移赋值",isCompoundAssignment:!0},">>>=":{precedence:0,args:2,func:(e,t)=>e>>>t,position:"infix",argTypes:"number",description:"无符号右移赋值",isCompoundAssignment:!0},"@":{precedence:1,args:1,func:Ue.dateToTimestamp,position:"prefix",argTypes:"any",description:"日期转时间戳"},">@":{precedence:0,args:1,func:Ue.formatDate,position:"postfix",argTypes:"any",description:"时间戳可视化成日期"},">#":{precedence:0,args:1,func:Ue.formatDateStamp,position:"postfix",argTypes:"any",description:"时间差可视化"},">#w":{precedence:0,args:1,func:Ue.formatDateStamp2Week,position:"postfix",argTypes:"any",description:"时间差转成周数"},">#W":{alias:">#w",description:"时间差转成周数"},">#d":{precedence:0,args:1,func:Ue.formatDateStamp2Day,position:"postfix",argTypes:"any",description:"时间差转成天数"},">#D":{alias:">#d",description:"时间差转成天数"},">#h":{precedence:0,args:1,func:Ue.formatDateStamp2Hour,position:"postfix",argTypes:"any",description:"时间差转成小时数"},">#H":{alias:">#h",description:"时间差转成小时数"},">#m":{precedence:0,args:1,func:Ue.formatDateStamp2Minute,position:"postfix",argTypes:"any",description:"时间差转成分钟数"},">#M":{alias:">#m",description:"时间差转成分钟数"},">#s":{precedence:0,args:1,func:Ue.formatDateStamp2Second,position:"postfix",argTypes:"any",description:"时间差转成秒数"},">#S":{alias:">#s",description:"时间差转成秒数"}},Ke={str:{func:e=>e.toString(),args:1,argTypes:"any",description:"转换为字符串"},num:{func:e=>e,args:1,description:"转换为数字"},max:{func:(...e)=>He.max(...e),args:-1,description:"求最大值"},min:{func:(...e)=>He.min(...e),args:-1,description:"求最小值"},lg:{func:e=>He.log10(e),args:1,description:"以10为底的对数"},lb:{func:e=>He.log2(e),args:1,description:"以2为底的对数"},log:{func:(e,t)=>He.log(t,e),args:2,description:"以x为底的y对数"},ln:{func:e=>He.ln(e),args:1,description:"自然对数"},exp:{func:e=>He.exp(e),args:1,description:"e的指数"},round:{func:e=>He.round(e),args:1,description:"四舍五入取整"},roundfix:{func:(e,t)=>((t=t.toNumber())<0&&(t=e.decimalPlaces()+t),t=Math.max(0,t),e.toDecimalPlaces(t)),args:2,description:"指定小数位数, 四舍五入取整"},floor:{func:e=>He.floor(e),args:1,description:"向下取整"},ceil:{func:e=>He.ceil(e),args:1,description:"向上取整"},clamp:{func:(e,t,n)=>He.clamp(e,t,n),args:3,description:"设置数值范围"},random:{func:()=>He.random(),args:0,description:"随机数生成0~1"},sin:{func:e=>He.sin(e),args:1,description:"正弦函数"},cos:{func:e=>He.cos(e),args:1,description:"余弦函数"},tan:{func:e=>He.tan(e),args:1,description:"正切函数"},asin:{func:e=>He.asin(e),args:1,repr:e=>"弧度: "+Ue.radianToPi(e)+" | 角度: "+Ue.toFixed(Ue.radianToDeg(e),3)+"°",description:"反正弦函数"},acos:{func:e=>He.acos(e),args:1,repr:e=>"弧度: "+Ue.radianToPi(e)+" | 角度: "+Ue.toFixed(Ue.radianToDeg(e),3)+"°",description:"反余弦函数"},atan:{func:e=>He.atan(e),args:1,repr:e=>"弧度: "+Ue.radianToPi(e)+" | 角度: "+Ue.toFixed(Ue.radianToDeg(e),3)+"°",description:"反正切函数"},sinh:{func:e=>He.sinh(e),args:1,description:"双曲正弦"},cosh:{func:e=>He.cosh(e),args:1,description:"双曲余弦"},tanh:{func:e=>He.tanh(e),args:1,description:"双曲正切"},sqrt:{func:e=>e.sqrt(),args:1,description:"平方根"},pow:{func:Ue.pow,args:2,description:"幂函数"},abs:{args:1,func:e=>e.abs(),asProperty:!0,description:"绝对值"},rad:{args:1,func:e=>e.times(Ce.pi).div(180),asProperty:!0,preventSelfReference:!0,repr:e=>"弧度: "+Ue.radianToPi(e)+" | 角度: "+Ue.toFixed(Ue.radianToDeg(e),3)+"°",description:"度数转换为弧度"},deg:{args:1,func:Ue.radianToDeg,asProperty:!0,preventSelfReference:!0,repr:e=>"角度: "+Ue.toFixed(e,3)+"°",description:"弧度转换为度数"},upper:{args:1,func:e=>e.toUpperCase(),argTypes:"any",asProperty:!0,description:"转换为大写"},lower:{args:1,func:e=>e.toLowerCase(),argTypes:"any",asProperty:!0,description:"转换为小写"},length:{args:1,func:e=>e.length,argTypes:"any",asProperty:!0,description:"字符串长度"},bin:{args:1,func:e=>"0b"+e.toString(2),asProperty:!0,argTypes:"bigint",description:"十进制转二进制"},oct:{args:1,func:e=>"0o"+e.toString(8),asProperty:!0,argTypes:"bigint",description:"十进制转八进制"},hex:{args:1,func:e=>"0x"+e.toString(16),asProperty:!0,argTypes:"bigint",description:"十进制转十六进制"},base64:{args:1,func:e=>{try{return"string"!=typeof e&&(e=String(e)),btoa(e)}catch(e){throw new Error("Base64编码失败: "+e.message)}},description:"Base64编码",argTypes:"any",asProperty:!0},unbase64:{args:1,func:e=>{try{return"string"!=typeof e&&(e=String(e)),atob(e)}catch(e){throw new Error("Base64解码失败: "+e.message)}},description:"Base64解码",argTypes:"any",asProperty:!0},timestamp:{args:8,func:(e=0,t=0,n=0,r=0,i=0,s=0,o=0,a=0)=>{const c=Number(e),u=Number(t);if(!Number.isInteger(c)||!Number.isInteger(u))throw new Error(`年:${c} 月:${u} 必须是整数`);return new qe(c,u,1e3*(60*(60*(24*(7*n+r)+i)+s)+o)+a)},argTypes:"number",description:"时间间隔转换为时间戳"}},ze=new Map;function Xe(e,t){const n=new Date;let r;switch(t){case"now":r=n;break;case"today":r=new Date(n.getFullYear(),n.getMonth(),n.getDate());break;case"YYYY-MM-DD HH:mm:ss":r=new Date(e);break;case"YYYY-MM-DD HH:mm":r=new Date(e+":00");break;case"YYYY-MM-DD":r=new Date(e+"T00:00:00");break;case"MM-DD HH:mm:ss":e=e.replace(/^(\d{1,2})-(\d{1,2})/,((e,t,n)=>`${t.padStart(2,"0")}-${n.padStart(2,"0")}`)),r=new Date(n.getFullYear()+"-"+e);break;case"MM-DD HH:mm":e=e.replace(/^(\d{1,2})-(\d{1,2})/,((e,t,n)=>`${t.padStart(2,"0")}-${n.padStart(2,"0")}`)),r=new Date(n.getFullYear()+"-"+e+":00");break;case"YYYY-MM":r=new Date(e+"-01T00:00:00");break;case"MM-DD":e=e.replace(/(\d{1,2})-(\d{1,2})/,((e,t,n)=>`${t.padStart(2,"0")}-${n.padStart(2,"0")}`)),r=new Date(n.getFullYear()+"-"+e+"T00:00:00");break;case"YYYY":r=new Date(e+"-01-01T00:00:00");break;case"HH:mm:ss":{const[t,n,i]=e.split(":").map(Number);return r=new Date(0),r.setUTCHours(t,n,i),new qe(0,0,r.getTime())}case"HH:mm":{const[t,n]=e.split(":").map(Number);return r=new Date(0),r.setUTCHours(t,n,0),new qe(0,0,r.getTime())}default:return null}return isNaN(r.getTime())?null:r}const Je=function(){const e=100,t=new Map,n=[],r=[];function i(e){n.includes(e)||n.push(e)}function s(e){r.includes(e)||r.push(e)}function o(){n.length=0,r.length=0}function a(n,r,s,o){const a=function(e){const t={"（":"(","）":")","，":",","”":'"',"’":"'","【":"[","】":"]","《":"<","》":">","＋":"+","－":"-","＝":"=","÷":"/","。":".","［":"[","］":"]","｛":"{","｝":"}","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9","０":"0"},n=new RegExp(Object.keys(t).join("|"),"g");return e.replace(n,(e=>t[e]||e))}(n);a!==n&&i(`格式化: "${a}"`),n=a,ze.clear(),n=(n=function(e){let t=0;return(e=e.replace(/\[([\d\s,]+)\]/g,((e,n)=>{const r="_cc_mat_i"+t++,i=Ue.str2vec(e);return ze.set(r,i),r}))).replace(/\{([^{}]+)\}/g,((e,n)=>{const r="_cc_mat_i"+t++,i=Ue.str2Matrix(e);return ze.set(r,i),r}))}(n=function(e){let t=0,n=e.replace(/str\s*\(((?:[^)(]|\([^)(]*\))*)\)/g,((e,n)=>{const r="_cc_str_i"+t++;return ze.set(r,n.trim()),r}));if(n=n.replace(/(['"`])((?:\\.|[^\\])*?)\1/g,((e,n,r)=>{const i="_cc_str_i"+t++,s=r.replace(/\\(['"\\`])/g,"$1");return ze.set(i,s),i})),/['"`][^'"`]*$/.test(n))throw new Error("未闭合的字符串字面量");return n}(n=function(e){function t(e){const t=["years?","y","months?","m","weeks?","w","days?","d","hours?","h","minutes?","mm","seconds?","s","milliseconds?","ms"].join("|"),n=new RegExp(`([+-]?\\d+\\.?\\d*)(${t})`,"gi");return e.replace(n,"($1)$2")}function n(e){if(""===e.trim())return e;const t={years:["y","year","years"],months:["m","month","months"],weeks:["w","week","weeks"],days:["d","day","days"],hours:["h","hour","hours"],minutes:["mm","minute","minutes"],seconds:["s","second","seconds"],milliseconds:["ms","millisecond","milliseconds"]},n="START",r="EXPECT_OPEN",i="IN_BRACKETS",s="EXPECT_UNIT",o="END";let a=n,c=0,u="",f=0,p={years:"0",months:"0",weeks:"0",days:"0",hours:"0",minutes:"0",seconds:"0",milliseconds:"0"},l=Object.keys(t),d=0;const g={y:["years","year","y"],m:["milliseconds","millisecond","minutes","months","minute","month","mins","min","mm","ms","m"],w:["weeks","week","w"],d:["days","day","d"],h:["hours","hour","h"],s:["seconds","second","s"]};for(;c<e.length&&a!==o;){const h=e[c];switch(a){case n:if("("===h)a=i,f=1,u="";else if(h.trim())throw g[h]?new Error(`时间单位:${e.slice(c,c+5)+"..."} 没有值`):new Error("时间值必须在括号内");break;case r:"("===h?(a=i,f=1,u=""):h.trim()&&"+"!==h&&"-"!==h&&(0===d&&(d=c),a=o);break;case i:if("("===h)f++,u+=h;else if(")"===h)if(f--,0===f){if(!u.trim())throw new Error("括号内不能为空");a=s}else u+=h;else u+=h;break;case s:let m=c,w={length:0,unitKey:"",value:u,endPos:c};const y=e[c].toLowerCase();if(g[y]){const n=g[y];for(const r of n)if(e.slice(c,c+r.length).toLowerCase()===r){let e;for(const[n,i]of Object.entries(t))if(i.includes(r)){if("0"!==p[n])throw new Error(`时间单位:${n} 重复赋值`);e=n;break}if(e){w={length:r.length,unitKey:e,value:u,endPos:c+r.length-1},c+=r.length-1;break}}}w.length>0?(p[w.unitKey]=w.value,c=w.endPos,d=c+1,l.indexOf(w.unitKey),a=r):(c=m,a=r)}c++}let h=`timestamp(${[p.years||"0",p.months||"0",p.weeks||"0",p.days||"0",p.hours||"0",p.minutes||"0",p.seconds||"0",p.milliseconds||"0"].join(", ")})`;if(d<e.length){const t=e.substring(d).trim();t&&(h+=" "+t)}return h}const r=(e=e.replace(/>\s*#/g,">timestamp")).split("#");let i=r[0];for(let e=1;e<r.length;e++)i+=n(t(r[e]));return i=i.replace(/>timestamp/g,">#"),i}(n=function(e){let t=0;const n=[{regex:/(@)\s*(\d{4})-(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2}):(\d{1,2})/,format:"YYYY-MM-DD HH:mm:ss",extract:e=>`${e[2]}-${e[3].padStart(2,"0")}-${e[4].padStart(2,"0")} ${e[5]}:${e[6]}:${e[7]}`},{regex:/(@)\s*(\d{4})-(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2})/,format:"YYYY-MM-DD HH:mm",extract:e=>`${e[2]}-${e[3].padStart(2,"0")}-${e[4].padStart(2,"0")} ${e[5]}:${e[6]}`},{regex:/(@)\s*(\d{4})-(\d{1,2})-(\d{1,2})/,format:"YYYY-MM-DD",extract:e=>`${e[2]}-${e[3].padStart(2,"0")}-${e[4].padStart(2,"0")}`},{regex:/(@)\s*(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2}):(\d{1,2})/,format:"MM-DD HH:mm:ss",extract:e=>`${e[2].padStart(2,"0")}-${e[3].padStart(2,"0")} ${e[4]}:${e[5]}:${e[6]}`},{regex:/(@)\s*(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2})/,format:"MM-DD HH:mm",extract:e=>`${e[2].padStart(2,"0")}-${e[3].padStart(2,"0")} ${e[4]}:${e[5]}`},{regex:/(@)\s*(\d{4})-(\d{1,2})/,format:"YYYY-MM",extract:e=>`${e[2]}-${e[3].padStart(2,"0")}`},{regex:/(#)\s*(\d{1,2}):(\d{1,2}):(\d{1,2})/,format:"HH:mm:ss",extract:e=>`${e[2].padStart(2,"0")}:${e[3].padStart(2,"0")}:${e[4].padStart(2,"0")}`},{regex:/(#)\s*(\d{1,2}):(\d{1,2})/,format:"HH:mm",extract:e=>`${e[2].padStart(2,"0")}:${e[3].padStart(2,"0")}`},{regex:/(@)\s*(\d{1,2})-(\d{1,2})/,format:"MM-DD",extract:e=>`${e[2].padStart(2,"0")}-${e[3].padStart(2,"0")}`},{regex:/(@)\s*(\d{4})/,format:"YYYY",extract:e=>e[2]},{regex:/(@)\s*(now)/,format:"now",extract:e=>e[2]},{regex:/(@)\s*(today)/,format:"today",extract:e=>e[2]}];let r;do{r=e;for(const{regex:r,format:i,extract:s}of n){const n=r.exec(e);if(n){const r=Xe(s(n),i);if(r){const i="_cc_date_i"+t++;ze.set(i,r),e=e.substring(0,n.index)+i+e.substring(n.index+n[0].length);break}}}}while(e!==r);return e}(n))))).replace(/\s/g,"");for(const[e,n]of ze)t.set(e,n);!function(e,t=1e3){const n=e.replace(/'[^']*'|"[^"]*"/g,""),r=[];let i=0;for(let e=0;e<n.length;e++)if("("===n[e]){if(r.push(e),i=Math.max(i,r.length),i>t)throw new Error("括号嵌套深度过大")}else if(")"===n[e]){if(0===r.length)throw new Error(`多余的右括号，位置: ${e}`);const t=r.pop();if(e-t>1e3)throw new Error(`括号内容过长，开始位置: ${t}`)}if(r.length>0){const e=r.join(", ");throw new Error(`缺少右括号，对应左括号位置: ${e}`)}const s=[{pattern:/\)[\w\d]/,message:"右括号后直接跟标识符"},{pattern:/\)\(/,message:"右括号后直接跟左括号"},{pattern:/,\s*\)/,message:"逗号后直接跟右括号"},{pattern:/\(\s*,/,message:"左括号后直接跟逗号"}];for(const{pattern:e,message:t}of s)if(e.test(n))throw new Error(`括号使用错误: ${t}`)}(n,e);for(const[e,t]of Object.entries(Ke))t.asProperty&&(r.add("."+e),Ve["."+e]={precedence:8,args:1,func:t.func,position:"postfix",...t.argTypes&&{argTypes:t.argTypes},...t.repr&&{repr:t.repr},...t.preventSelfReference&&{preventSelfReference:t.preventSelfReference}});return{expr:n,operators:new Set([...r].sort(((e,t)=>t.length-e.length)))}}function c(e,n,r,s){function o(){if(0===c.length)return!0;const[e,t]=c[c.length-1];return"%"!==t&&"‰"!==t&&!("string"===e||"constant"===e||"delimiter"===e&&")"===t||"function"===e||"identifier"===e||"operator"===e&&t.startsWith("."))}function a(){let t="";for(;u<e.length;){const n=e[u],i=t+n;if("0"===t&&("x"===n||"b"===n||"o"===n)){t+=n,u++;continue}if(/^\d+\.?\d*$/.test(t)&&("e"===n||"E"===n)){for(t+=n,u++,u<e.length&&("+"===e[u]||"-"===e[u])&&(t+=e[u],u++);u<e.length&&/\d/.test(e[u]);)t+=e[u],u++;continue}if(f.has(n)||p.has(n))break;const o=l.some((t=>e.startsWith(t,u))),a=[...r,...s].some((e=>e.startsWith(i)));if(o&&!a)break;t+=n,u++}return t}const c=[];let u=0;const f=new Set(Object.keys(Be)),p=new Set(Object.keys(We)),l=[...n].sort(((e,t)=>t.length-e.length));for(;u<e.length;){const t=e[u],n=e.slice(u);let i=!1;for(const e of l)if(n.startsWith(e)){("="===e||Ve[e].isCompoundAssignment)&&c.length>0&&"string"===c[c.length-1][0]&&(c[c.length-1][0]="identifier"),"+"===e?o()?c.push(["operator","unary+"]):c.push(["operator","+"]):"-"===e?o()?c.push(["operator","unary-"]):c.push(["operator","-"]):"%"===e?c.push(["operator","%"]):p.has(e)?c.push(["separator",e]):f.has(e)?c.push(["delimiter",e]):Ve[e]&&Ve[e].alias?c.push(["operator",Ve[e].alias]):c.push(["operator",e]),u+=e.length,i=!0;break}if(!i)if(p.has(t))c.push(["separator",t]),u++;else if(f.has(t))c.push(["delimiter",t]),u++;else{const e=a();e&&(r.has(e)?Ke[e]&&Ke[e].alias?c.push(["function",Ke[e].alias]):c.push(["function",e]):s.has(e)?c.push(["constant",e]):c.push(["string",e]))}}const d=function(e){if(!e.some((e=>("identifier"===e[0]||"string"===e[0])&&"x"===e[1]))&&!t.has("x"))for(let n=0;n<e.length;n++)if("string"===e[n][0]){if(e[n][1].startsWith("0x"))continue;if(t.has(e[n][1]))continue;const r=e[n][1].split("x");if(r.length>1){const t=[];for(let e=0;e<r.length;e++)r[e]&&(s.has(r[e])?t.push(["constant",r[e]]):t.push(["string",r[e]])),e<r.length-1&&(t.push(["operator","*"]),i("使用x作为乘法符号"));e.splice(n,1,...t),n+=t.length-1}}return e}(c);return d}function u(t,n,r){let i=0,s=0;const o=t.filter((e=>{const[t]=e;return"delimiter"!==t&&"separator"!==t})).length;let a=0;function c(){if(s>e)throw new Error("表达式嵌套深度过大，可能存在无限递归")}function u(e,t,n){return a++,{value:e,args:t,type:n}}function f(){if(i>=t.length)throw new Error("意外的表达式结束");const[e,n]=t[i];switch(i++,e){case"function":return function(e){p("(");const n=[];for(;i<t.length&&("delimiter"!==t[i][0]||")"!==t[i][1]);)n.push(l(0)),"separator"===t[i][0]&&i++;return p(")"),u(e,n,"function")}(n);case"constant":case"identifier":case"string":return u(n,[],e);case"delimiter":if("("===n){const e=l(0);return p(")"),e}throw new Error(`意外的定界符: ${n}`);default:throw new Error(`意外的token类型: ${e}`)}}function p(e){if(i>=t.length||"delimiter"!==t[i][0]||t[i][1]!==e)throw new Error(`期望定界符 "${e}"`);i++}function l(e=0){s++,c();let n=function(){if(s++,c(),i>=t.length)throw new Error("意外的表达式结束");const[e,n]=t[i];if("operator"===e&&Ve[n]&&"prefix"===Ve[n].position){i++;const e=l(Ve[n].precedence);return s--,u(n,[e],"operator")}return s--,f()}(e);for(;i<t.length;){const[r,s]=t[i];if("operator"===r&&"%"===s){const e=t[i+1],r=e&&("string"===e[0]||"constant"===e[0]||"function"===e[0]||"delimiter"===e[0]&&"("===e[1]);if(i++,r){n=u("%",[n,l(Ve["%"].precedence+1)],"operator")}else n=u("unary%",[n],"operator");continue}if("operator"===r&&Ve[s]&&"postfix"===Ve[s].position){if(Ve[s].precedence<e)break;i++,n=u(s,[n],"operator");continue}if("operator"!==r||!Ve[s]||Ve[s].precedence<e||"infix"!==Ve[s].position)break;i++;const o=Ve[s];n=u(s,[n,l(o.isCompoundAssignment?o.precedence:o.precedence+1)],"operator")}return s--,n}const d=l();if(a<o)throw new Error(`解析错误：AST节点不全(${a} < ${o})`);return function t(n,r=0){if(r>e)throw new Error("自引用检查嵌套深度过大，可能存在无限递归");if("function"===n.type){const e=n.value;if(Ke[e]&&Ke[e].preventSelfReference&&n.args.some((t=>"function"===t.type&&t.value===e)))throw new Error(`函数 ${e} 不能直接作用在自己身上`)}else if("operator"===n.type){const e=n.value;if(Ve[e]&&Ve[e].preventSelfReference&&n.args.some((t=>"operator"===t.type&&t.value===e)))throw new Error(`运算符 ${e} 不能直接作用在自己身上`)}n.args?.forEach((e=>t(e,r+1)))}(d),d}function f(e,t){return t?e.map((e=>Ue.convertTypes(e,t))):e.map((e=>Ue.convertTypes(e)))}function p(n,r,o,a,c=0){if(c>e)throw new Error("表达式求值嵌套深度过大，可能存在无限递归");if(!n)return 0;if("string"===n.type)return t.has(n.value)?t.get(n.value):Ue.convertTypes(n.value);if("identifier"===n.type)return t.has(n.value)?t.get(n.value):n.value;if("constant"===n.type)return Le[n.value];const u=n.args.map((e=>p(e,r,o,a,c+1)));if("operator"===n.type){const e=Ve[n.value];if(void 0!==e.args&&u.length!==e.args)throw new Error(`运算符 "${n.value}" 需要 ${e.args} 个参数，但得到了 ${u.length} 个`);if(e.isCompoundAssignment){const[u,l]=n.args;if("identifier"!==u.type&&"string"!==u.type)throw new Error("赋值运算符左侧必须是变量名");!function(e,t,n,r){if(!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(e)){if(/\s/.test(e))throw new Error(`变量名 "${e}" 不能包含空格`);throw new Error(`变量名 "${e}" 格式不正确，只能包含字母、数字和下划线，且不以数字开头`)}if(e.startsWith("_cc_"))throw new Error('变量名不能以 "_cc_" 开头，这是系统保留的前缀');if(t.hasOwnProperty(e))throw new Error(`变量名 "${e}" 与运算符冲突`);if(n.hasOwnProperty(e))throw new Error(`变量名 "${e}" 与函数名冲突`);if(r.hasOwnProperty(e))throw new Error(`变量名 "${e}" 与常量冲突`);if(["if","else","true","false","null","undefined"].includes(e))throw new Error(`变量名 "${e}" 是保留字`)}(u.value,r,o,a);const d=p(l,r,o,a,c+1);if("="===n.value)return t.set(u.value,d),s(`添加变量 ${u.value}: ${d}`),"x"===u.value&&i("将无法使用x做为乘法符号"),d;{if(!t.has(u.value))throw new Error(`变量 "${u.value}" 未定义`);const n=f([t.get(u.value),d],e.argTypes),r=e.func(...n);return t.set(u.value,r),r}}const l=f(u,e.argTypes);return e.func(...l)}if("function"===n.type){const e=Ke[n.value];if(void 0!==e.args)if(-1===e.args){if(0===u.length)throw new Error(`函数 "${n.value}" 至少需要1个参数`)}else if(u.length!==e.args)throw new Error(`函数 "${n.value}" 需要 ${e.args} 个参数，但得到了 ${u.length} 个`);const t=f(u,e.argTypes);return e.func(...t)}throw new Error(`未处理的节点类型: ${n.type}`)}return{calculate(e){o();const t=new Set(Object.keys(Ve)),f=new Set(Object.keys(Ke)),l=new Set(Object.keys(Le)),{expr:d,operators:g}=a(e,t),h=u(c(d,g,f,l)),m=function(e,t){if("object"==typeof(e=Ue.formatToDisplayString(e))&&null!==e&&(e.info&&s(e.info),e.warning&&i(e.warning),e=e.value),!t)return{value:e,info:r.length>0?r:null,warning:n.length>0?n:null};try{let i,o=t;if("operator"===o.type&&"="===o.value&&(o=o.args[1]),"function"===o.type&&Ke[o.value]?i=Ke[o.value].repr:"operator"===o.type&&Ve[o.value]&&(i=Ve[o.value].repr),"function"==typeof i)try{const t=i(e);void 0!==t&&s(t)}catch(e){throw new Error(`${e.message}`)}return{value:e,info:r.length>0?r:null,warning:n.length>0?n:null}}catch(t){return i(`格式化输出时发生错误: ${t.message}`),{value:e,info:r.length>0?r:null,warning:n.length>0?n:null}}}(p(h,t,f,l),h);return m},getASTNode(e){const t=new Set(Object.keys(Ve)),n=new Set(Object.keys(Ke)),r=new Set(Object.keys(Le)),{expr:i,operators:s}=a(e,t);return u(c(i,s,n,r))},getCfg:()=>({operators:new Set(Object.keys(Ve)),functions:new Set(Object.keys(Ke)),constants:new Set(Object.keys(Le))}),tokenize:(e,t,n,r)=>c(e,t,n,r),preprocess:(e,t,n,r)=>a(e,t),getAllVariables:()=>Object.fromEntries(t),clearAllCache(){t.clear(),o()}}}();console.log(Je.calculate("[1,2,3]")),console.log(Je.calculate("{1,2,3;4,5,6;7,8,9}"));export{Le as CONSTANTS,Je as Calculator,Ke as FUNCTIONS,Ve as OPERATORS};
